<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.7.1">
<meta name="description" content="Documentation of the open source project DSS (Digital Signature Service). This project allows to produce/validate advanced electronic signatures (AdES).">
<meta name="keywords" content="electronic signature, XAdES, CAdES, PAdES, ASiC, open source, validation">
<meta name="author" content="version : 5.4 - 2018-12-17">
<title>Digital Signature Service</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<link rel="stylesheet" href="./asciidoctor.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="./coderay-asciidoctor.css">
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Digital Signature Service</h1>
<div class="details">
<span id="author" class="author">version : 5.4 - 2018-12-17</span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_introduction">Introduction</a>
<ul class="sectlevel2">
<li><a href="#_purpose_of_the_document">Purpose of the document</a></li>
<li><a href="#_scope_of_the_document">Scope of the document</a></li>
<li><a href="#_abbreviations_and_acronyms">Abbreviations and Acronyms</a></li>
<li><a href="#_references">References</a></li>
<li><a href="#_useful_links">Useful links</a></li>
</ul>
</li>
<li><a href="#_general_framework_structure">General framework structure</a>
<ul class="sectlevel2">
<li><a href="#_dss_utils">DSS Utils</a></li>
<li><a href="#_dss_crl_parser">DSS CRL Parser</a></li>
<li><a href="#_dss_pades">DSS PAdES</a></li>
</ul>
</li>
<li><a href="#_available_demonstrations">Available demonstrations</a></li>
<li><a href="#_signatures_profile_simplification">Signature&#8217;s profile simplification</a></li>
<li><a href="#_the_xml_signature_xades">The XML Signature (XAdES)</a>
<ul class="sectlevel2">
<li><a href="#_xades_profiles">XAdES Profiles</a></li>
<li><a href="#_various_settings">Various settings</a></li>
<li><a href="#_multiple_signatures">Multiple signatures</a></li>
<li><a href="#_the_xml_signature_extension_xades">The XML Signature Extension (XAdES)</a></li>
<li><a href="#_xades_baseline_t_2">XAdES-BASELINE-T</a></li>
<li><a href="#_xades_baseline_lt_and_lta">XAdES-BASELINE-LT and -LTA</a></li>
<li><a href="#_xades_and_specific_schema_version">XAdES and specific schema version</a></li>
</ul>
</li>
<li><a href="#_the_signature_validation">The signature validation</a>
<ul class="sectlevel2">
<li><a href="#_validation_process">Validation Process</a></li>
<li><a href="#_eu_trusted_lists_of_certification_service_providers">EU Trusted Lists of Certification Service Providers</a></li>
<li><a href="#_validation_result_materials">Validation Result Materials</a></li>
<li><a href="#_customised_validation_policy">Customised Validation Policy</a></li>
</ul>
</li>
<li><a href="#_cades_signature_cms">CAdES signature (CMS)</a></li>
<li><a href="#_pades_signature_pdf">PAdES signature (PDF)</a>
<ul class="sectlevel2">
<li><a href="#_pades_visible_signature">PAdES Visible Signature</a></li>
</ul>
</li>
<li><a href="#_asic_signature_containers">ASiC signature (containers)</a></li>
<li><a href="#_available_implementations_of_dssdocument">Available implementations of DSSDocument</a></li>
<li><a href="#_management_of_signature_tokens">Management of signature tokens</a>
<ul class="sectlevel2">
<li><a href="#_pkcs11">PKCS#11</a></li>
<li><a href="#_pkcs12">PKCS#12</a></li>
<li><a href="#_ms_capi">MS CAPI</a></li>
<li><a href="#_other_implementations">Other Implementations</a></li>
</ul>
</li>
<li><a href="#_management_of_certificates_sources">Management of certificates sources</a></li>
<li><a href="#_management_of_crl_and_ocsp_sources">Management of CRL and OCSP sources</a>
<ul class="sectlevel2">
<li><a href="#_other_implementations_of_crl_and_ocsp_sources">Other implementations of CRL and OCSP Sources</a></li>
</ul>
</li>
<li><a href="#_certificateverifier_configuration">CertificateVerifier configuration</a></li>
<li><a href="#_tsp_sources">TSP Sources</a>
<ul class="sectlevel2">
<li><a href="#_time_stamp_policy">Time-stamp policy</a></li>
<li><a href="#_composite_tsp_source">Composite TSP Source</a></li>
</ul>
</li>
<li><a href="#_supported_algorithms">Supported algorithms</a></li>
<li><a href="#_multi_theading">Multi-theading</a>
<ul class="sectlevel2">
<li><a href="#_resource_sharing">Resource sharing</a></li>
<li><a href="#_caching">Caching</a></li>
</ul>
</li>
<li><a href="#_additional_features">Additional features</a>
<ul class="sectlevel2">
<li><a href="#_certificate_validation">Certificate validation</a></li>
<li><a href="#_extract_the_signed_data_from_a_signature">Extract the signed data from a signature</a></li>
</ul>
</li>
<li><a href="#_rest_services">REST Services</a>
<ul class="sectlevel2">
<li><a href="#_rest_signature_service">REST signature service</a></li>
<li><a href="#_rest_server_signature_service">REST server signature service</a></li>
<li><a href="#_rest_validation_service">REST validation service</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_introduction"><a class="anchor" href="#_introduction"></a>Introduction</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_purpose_of_the_document"><a class="anchor" href="#_purpose_of_the_document"></a>Purpose of the document</h3>
<div class="paragraph">
<p>This document describes some examples of how to develop in Java using the DSS framework. The aim is to show to the developers, in a progressive manner, the different uses of the framework. It will familiarise them with the code step by step.</p>
</div>
</div>
<div class="sect2">
<h3 id="_scope_of_the_document"><a class="anchor" href="#_scope_of_the_document"></a>Scope of the document</h3>
<div class="paragraph">
<p>This document provides examples of code which allow easy handling of digital signatures. The examples are consistent with the Release 5.4 of DSS framework which can be downloaded via <a href="https://ec.europa.eu/cefdigital/wiki/display/CEFDIGITAL/DSS+-+releases" class="bare">https://ec.europa.eu/cefdigital/wiki/display/CEFDIGITAL/DSS+-+releases</a></p>
</div>
<div class="paragraph">
<p>Three main features can be distinguished within the framework :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The digital signature;</p>
</li>
<li>
<p>The extension of a digital signature and;</p>
</li>
<li>
<p>The validation of a digital signature.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>On a more detailed manner the following concepts and features are addressed in this document:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Formats of the signed documents: XML, PDF, DOC, TXT, ZIP&#8230;&#8203;;</p>
</li>
<li>
<p>Packaging structures: enveloping, enveloped, detached and internally-detached;</p>
</li>
<li>
<p>Forms of digital signatures: XAdES, CAdES, PAdES and ASiC-S/ASiC-E;</p>
</li>
<li>
<p>Profiles associated to each form of the digital signature;</p>
</li>
<li>
<p>Trust management;</p>
</li>
<li>
<p>Revocation data handling (OCSP and CRL sources);</p>
</li>
<li>
<p>Certificate chain building;</p>
</li>
<li>
<p>Signature validation and validation policy;</p>
</li>
<li>
<p>Validation of the signing certificate.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This is not an exhaustive list of all the possibilities offered by the framework and the proposed examples cover only the most useful features. However, to discover every detail of the operational principles of the framework, the JavaDoc is available within the source code.</p>
</div>
<div class="paragraph">
<p>Please note that the DSS framework is still under maintenance and new features will be released in the future.</p>
</div>
</div>
<div class="sect2">
<h3 id="_abbreviations_and_acronyms"><a class="anchor" href="#_abbreviations_and_acronyms"></a>Abbreviations and Acronyms</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Code</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AdES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Advanced Electronic Signature</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">API</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Application Programming Interface</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ASiC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Associated Signature Containers</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Building Block (CEF)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Certificate authority</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CAdES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CMS Advanced Electronic Signatures</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Commission Decision</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CEF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Connecting Europe Facility</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CMS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cryptographic Message Syntax</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CRL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Certificate Revocation List</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CSP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Core Service Platform (CEF)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CSP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cryptographic Service Provider</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Distinguished Encoding Rules</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DSA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Digital Signature Algorithm - an algorithm for public-key cryptography</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DSI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Digital Service Infrastructure (CEF)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DSS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Digital Signature Service</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">European Commission</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">eID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Electronic Identity Card</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ESI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Electronic Signatures and Infrastructures</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ETSI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">European Telecommunications Standards Institute</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EUPL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">European Union Public License</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FSF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Free Software Foundation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generic Service (CEF)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GUI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphical User Interface</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HSM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hardware Security Modules</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hypertext Transfer Protocol</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">I18N</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Internationalisation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Java EE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Java Enterprise Edition</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JavaDoc</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JavaDoc is developed by Sun Microsystems to create API documentation in HTML format from the comments in the source code. JavaDoc is an industrial standard for documenting Java classes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JAXB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Java Architecture for XML Binding</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JCA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Java Cryptographic Architecture</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JCE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Java Cryptography Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JDBC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Java DataBase Connectivity</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LGPL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Lesser General Public License</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LOTL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of Trusted List or List of the Lists</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LSP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Large Scale Pilot</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MIT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Massachusetts Institute of Technology</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MOCCA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Austrian Modular Open Citizen Card Architecture; implemented in Java</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MS / EUMS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Member State</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MS CAPI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Microsoft Cryptographic Application Programming Interface</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OCF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OEBPS Container Format</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OCSP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Online Certificate Status Protocol</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ODF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Open Document Format</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ODT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Open Document Text</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OEBPS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Open eBook Publication Structure</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Object Identifier</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OOXML</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Office Open XML</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OSI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Open Source Initiative</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OSS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Open Source Software</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PAdES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PDF Advanced Electronic Signatures</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PC/SC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Personal computer/Smart Card</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PDF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Portable Document Format</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PDFBox</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Apache PDFBox - A Java PDF Library: <a href="http://pdfbox.apache.org/" class="bare">http://pdfbox.apache.org/</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKCS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Public Key Cryptographic Standards</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKCS#12</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">It defines a file format commonly used to store X.509 private key accompanying public key certificates, protected by symmetrical password</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKIX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Internet X.509 Public Key Infrastructure</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RSA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Rivest Shamir Adleman - an algorithm for public-key cryptography</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SCA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Signature Creation Application</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SCD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Signature Creation Device</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SME</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Subject Matter Expert</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SMO</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stakeholder Management Office (CEF)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SOAP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Simple Object Access Protocol</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SSCD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Secure Signature-Creation Device</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SVA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Signature Validation Application</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Trusted List</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TLManager</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Application for managing trusted lists.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TSA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time Stamping Authority</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TSL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Trust-service Status List</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TSP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time Stamp Protocol</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TSP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Trusted Service Provider</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time-Stamp Token</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UCF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Universal Container Format</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">URI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uniform Resource Identifier</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WSDL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Web Services Description Language</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WYSIWYS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">What you see is what you sign</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">XAdES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XML Advanced Electronic Signatures</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">XML</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extensible Markup Language</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ZIP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">File format used for data compression and archiving</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_references"><a class="anchor" href="#_references"></a>References</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ref.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Title</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reference</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Version</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="R01"></a>	R01</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ESI - XAdES digital signatures</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ETSI EN 319 132 part 1-2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="R02"></a>	R02</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ESI - CAdES digital signatures</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ETSI EN 319 122 part 1-2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.1.1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="R03"></a>	R03</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ESI - PAdES digital signatures</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ETSI EN 319 142 part 1-2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.1.1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="R04"></a>	R04</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ESI - Associated Signature Containers (ASiC)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ETSI EN 319 162 part 1-2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.1.1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="R05"></a>	R05</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Document management - Portable document format - Part 1: PDF 1.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ISO 32000-1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="R06"></a>	R06</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Directive 1999/93/EC of the European Parliament and of the Council of 13 December 1999 on a Community framework for electronic signatures.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DIRECTIVE 1999/93/EC</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="R07"></a>	R07</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Internet X.509 Public Key Infrastructure - Time-Stamp Protocol (TSP)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RFC 3161</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="R08"></a>	R08</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ESI - Procedures for Creation and Validation of AdES Digital Signatures</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ETSI EN 319 102-1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.1.1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="R09"></a>	R09</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ESI - Signature validation policy for European qualified electronic signatures/seals using trusted lists</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ETSI TS 119 172-4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">draft</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="R10"></a>	R10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ESI - Trusted Lists</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ETSI TS 119 612</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.1.1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="R11"></a>	R11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">eIDAS Regulation No 910/2014</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">910/2014/EU</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_useful_links"><a class="anchor" href="#_useful_links"></a>Useful links</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://ec.europa.eu/cefdigital/wiki/display/CEFDIGITAL/eSignature">CEF Digital</a></p>
</li>
<li>
<p><a href="https://webgate.ec.europa.eu/tl-browser/#/">TL Browser</a></p>
</li>
<li>
<p><a href="https://github.com/esig/dss">Source code (GitHub)</a></p>
</li>
<li>
<p><a href="https://ec.europa.eu/cefdigital/code/projects/ESIG/repos/dss/browse">Source code (EC Bitbucket)</a></p>
</li>
<li>
<p><a href="https://ec.europa.eu/cefdigital/code/projects/ESIG/repos/dss-demos/browse">Source code demonstrations (EC Bitbucket)</a></p>
</li>
<li>
<p><a href="https://ec.europa.eu/cefdigital/tracker/projects/DSS/issues">Report an issue (EC Jira)</a></p>
</li>
<li>
<p><a href="https://esig-dss.atlassian.net/projects/DSS">Old Jira</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_general_framework_structure"><a class="anchor" href="#_general_framework_structure"></a>General framework structure</h2>
<div class="sectionbody">
<div class="paragraph">
<p>DSS framework is a multi-modules project which can be builded with Maven.</p>
</div>
<div class="paragraph">
<p>You can easily download them with the following Maven repository :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;repository&gt;</span>
  <span class="tag">&lt;id&gt;</span>cefdigital<span class="tag">&lt;/id&gt;</span>
  <span class="tag">&lt;name&gt;</span>cefdigital<span class="tag">&lt;/name&gt;</span>
  <span class="tag">&lt;url&gt;</span>https://ec.europa.eu/cefdigital/artifact/content/repositories/esignaturedss/<span class="tag">&lt;/url&gt;</span>
<span class="tag">&lt;/repository&gt;</span></code></pre>
</div>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
dss-model
</td>
<td class="hdlist2">
<p>Data model used in almost every modules.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dss-token
</td>
<td class="hdlist2">
<p>Token definitions and implementations for MS CAPI, PKCS#11, PKCS#12.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dss-document
</td>
<td class="hdlist2">
<p>Common module to sign and validate document. This module doen&#8217;t contain any implementation.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dss-asic-common
</td>
<td class="hdlist2">
<p>Common code which is shared between dss-asic-xades and dss-asic-cades.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dss-asic-cades
</td>
<td class="hdlist2">
<p>Implementation of the ASiC-S and ASiC-E signature, extension and validation based on CAdES signatures.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dss-asic-xades
</td>
<td class="hdlist2">
<p>Implementation of the ASiC-S and ASiC-E signature, extension and validation based on XAdES signatures.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dss-cades
</td>
<td class="hdlist2">
<p>Implementation of the CAdES signature, extension and validation.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dss-pades
</td>
<td class="hdlist2">
<p>Common code which is shared between dss-pades-pdfbox and dss-pades-openpdf.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dss-pades-pdfbox
</td>
<td class="hdlist2">
<p>Implementation of the PAdES signature, extension and validation with <a href="https://pdfbox.apache.org/">PDFBox</a>.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dss-pades-openpdf
</td>
<td class="hdlist2">
<p>Implementation of the PAdES signature, extension and validation with <a href="https://github.com/LibrePDF/OpenPDF">OpenPDF (fork of iText)</a>.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dss-xades
</td>
<td class="hdlist2">
<p>Implementation of the XAdES signature, extension and validation.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dss-spi
</td>
<td class="hdlist2">
<p>Interfaces, util classes to manipulate ASN1, compute digests,&#8230;&#8203;</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dss-service
</td>
<td class="hdlist2">
<p>Implementations to communicate with online resources (TSP, CRL, OCSP).</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dss-crl-parser
</td>
<td class="hdlist2">
<p>API to validate CRLs and retrieve revocation data</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dss-crl-parser-stream
</td>
<td class="hdlist2">
<p>Implementation of dss-crl-parser which streams the CRL (experimental).</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dss-crl-parser-x509crl
</td>
<td class="hdlist2">
<p>Implementation of dss-crl-parser which uses the java object X509CRL.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dss-tsl-validation
</td>
<td class="hdlist2">
<p>Module which allows to load / parse / validate LOTL and TSLs.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
validation-policy
</td>
<td class="hdlist2">
<p>Business of the signature&#8217;s validation (ETSI EN 319 102).</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dss-rest
</td>
<td class="hdlist2">
<p>REST webservices to sign (getDataToSign, signDocument methods) and extend a signature.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dss-rest-client
</td>
<td class="hdlist2">
<p>Client for the REST webservices.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dss-soap
</td>
<td class="hdlist2">
<p>SOAP webservices to sign (getDataToSign, signDocument methods) and extend a signature.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dss-soap-client
</td>
<td class="hdlist2">
<p>Client for the SOAP webservices.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dss-validation-rest
</td>
<td class="hdlist2">
<p>REST webservices to validate a signature.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dss-validation-rest-client
</td>
<td class="hdlist2">
<p>Client for the REST webservices.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dss-validation-soap
</td>
<td class="hdlist2">
<p>SOAP webservices to validate a signature.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dss-validation-soap-client
</td>
<td class="hdlist2">
<p>Client for the SOAP webservices.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dss-remote-services
</td>
<td class="hdlist2">
<p>Common code between dss-rest and dss-soap.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dss-server-signing-common
</td>
<td class="hdlist2">
<p>Common code for server signing</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dss-server-signing-rest
</td>
<td class="hdlist2">
<p>REST webservice for server signing</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dss-server-signing-rest-client
</td>
<td class="hdlist2">
<p>REST client for server signing</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dss-server-signing-soap
</td>
<td class="hdlist2">
<p>SOAP webservice for server signing</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dss-server-signing-soap-client
</td>
<td class="hdlist2">
<p>SOAP client for server signing</p>
</td>
</tr>
<tr>
<td class="hdlist1">
sscd-mocca-adapter
</td>
<td class="hdlist2">
<p>Implementation for MOCCA token.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dss-policy-jaxb
</td>
<td class="hdlist2">
<p>JAXB model of the validation policy.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dss-diagnostic-jaxb
</td>
<td class="hdlist2">
<p>JAXB model of the diagnostic data.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dss-simple-report-jaxb
</td>
<td class="hdlist2">
<p>JAXB model of the simple report.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dss-detailed-report-jaxb
</td>
<td class="hdlist2">
<p>JAXB model of the detailed report.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dss-reports
</td>
<td class="hdlist2">
<p>Wrappers to easily manipulate the reports JAXB models (diagnostic-data, simple-report, detailed-report).</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dss-tsl-jaxb
</td>
<td class="hdlist2">
<p>JAXB model of the TSL.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dss-utils
</td>
<td class="hdlist2">
<p>API with utility methods for String, Collection, I/O,&#8230;&#8203;</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dss-utils-apache-commons
</td>
<td class="hdlist2">
<p>Implementation of dss-utils with Apache Commons libraries</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dss-utils-google-guava
</td>
<td class="hdlist2">
<p>Implementation of dss-utils with Google Guava</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dss-test
</td>
<td class="hdlist2">
<p>Mocks and util classes for unit tests.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dss-cookbook
</td>
<td class="hdlist2">
<p>Samples and documentation of DSS used to generate this documentation.</p>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_dss_utils"><a class="anchor" href="#_dss_utils"></a>DSS Utils</h3>
<div class="paragraph">
<p>The module dss-utils offers an interface with utility methods to operate on String, Collection, I/O,&#8230;&#8203; DSS framework provides two different implementations with the same behavior :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>dss-utils-apache-commons : this module uses Apache Commons libraries (commons-lang3, commons-collection4, commons-io and commons-codec);</p>
</li>
<li>
<p>dss-utils-google-guava : this module only requires Google Guava (recommended on Android).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If your integration include dss-utils, you will need to select an implementation.</p>
</div>
</div>
<div class="sect2">
<h3 id="_dss_crl_parser"><a class="anchor" href="#_dss_crl_parser"></a>DSS CRL Parser</h3>
<div class="paragraph">
<p>DSS contains two ways to parse/validate a CRL and to retrieve revocation data. An alternative to the X509CRL java object was developed to face memory issues in case of large CRLs. The X509CRL object fully loads the CRL in memory and can cause OutOfMemoryError.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>dss-crl-parser-x509crl : this module uses the X509CRL java object.</p>
</li>
<li>
<p>dss-crl-parser-streams : this module offers an alternative with a CRL streaming (experimental).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If your integration require dss-crl-parser, you will need to choose your implementation.</p>
</div>
</div>
<div class="sect2">
<h3 id="_dss_pades"><a class="anchor" href="#_dss_pades"></a>DSS PAdES</h3>
<div class="paragraph">
<p>Since the version 5.4, DSS allows to generate/extend/validate PAdES signatures with two different frameworks : PDFBox and OpenPDF (fork of iText). The dss-pades module only contains the common code and requires an underlying implementation :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>dss-pades-pdfbox</p>
</li>
<li>
<p>dss-pades-openpdf</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>DSS permits to override the visible signature generation with these interfaces :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>eu.europa.esig.dss.pdf.IPdfObjFactory</p>
</li>
<li>
<p>eu.europa.esig.dss.pdf.visible.SignatureDrawerFactory (selects the SignatureDrawer depending of the SignatureImageParameters content)</p>
</li>
<li>
<p>eu.europa.esig.dss.pdf.visible.SignatureDrawer</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A new instance of the IPdfObjFactory can be created with its own SignatureDrawerFactory and injected in the PdfObjFactory.setInstance(IPdfObjFactory).</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_available_demonstrations"><a class="anchor" href="#_available_demonstrations"></a>Available demonstrations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>With the framework, some demonstrations are provided.</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
dss-standalone-app
</td>
<td class="hdlist2">
<p>Standalone application which allows to sign a document with different formats and tokens (JavaFX).</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dss-standalone-app-package
</td>
<td class="hdlist2">
<p>Packaging module for dss-standalone-app.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dss-demo-webapp
</td>
<td class="hdlist2">
<p>Demonstration web application which presents a part of the DSS possibilities.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dss-demo-bundle
</td>
<td class="hdlist2">
<p>Packaging module for dss-demo-webapp.</p>
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
The demonstrations use a simulated timestamp service (Mock) so that is not recommended for a production usage.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_signatures_profile_simplification"><a class="anchor" href="#_signatures_profile_simplification"></a>Signature&#8217;s profile simplification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The different formats of the digital signature make possible to cover a wide range of real live cases of use of this technique. Thus we distinguish the following formats: XAdES, CAdES, PAdES and ASIC. To each one of them a specific standard is dedicated. The wide variety of options, settings and versions of the standards makes their interoperability very difficult. This is the main reason for which new standards commonly called "baseline profiles" were published. Their goal is to limit the number of options and variants thereby making possible a better interoperability between different actors.</p>
</div>
<div class="paragraph">
<p>In general can be said that for each format of the digital signature the number of security levels defined in the new standards has been reduced. Below is a comparative table of old and new levels for each format of the signature:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.667%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">XAdES</p></td>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">CAdES</p></td>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">PAdES</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">STANDARD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BASELINE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">STANDARD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BASELINE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">STANDARD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BASELINE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">XAdES-BES</p></td>
<td class="tableblock halign-center valign-middle" rowspan="2"><p class="tableblock">XAdES-B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CAdES-BES</p></td>
<td class="tableblock halign-center valign-middle" rowspan="2"><p class="tableblock">CAdES-B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PAdES-BES</p></td>
<td class="tableblock halign-center valign-middle" rowspan="2"><p class="tableblock">PAdES-B</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">XAdES-EPES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CAdES-EPES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PAdES-EPES</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">XAdES-T</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XAdES-T</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CAdES-T</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CAdES-T</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PAdES-T</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PAdES-T</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">XAdES-XL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XAdES-LT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CAdES-XL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CAdES-LT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PAdES-XL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PAdES-LT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">XAdES-A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XAdES-LTA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CAdES-A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CAdES-LTA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PAdES-LTV</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PAdES-LTA</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Note that the new version (v4) of the DSS framework is compatible with the baseline profiles, it is no longer possible to use the standard profiles for signing purpose. The validation of the signature still takes into account the old profiles.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_xml_signature_xades"><a class="anchor" href="#_the_xml_signature_xades"></a>The XML Signature (XAdES)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The simplest way to address the digital signature passes through the XAdES format. Indeed, it allows to visualize the content of the signature with a simple text editor. Thus it becomes much easier to make the connection between theoretical concepts and their implementation. Before embarking on the use of the DSS framework, it is advisable to read the following documents:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>XAdES Specifications (cf. <a href="#R01">[R01]</a>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>After reading these documents, it is clear that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>To electronically sign a document, a signing certificate (that proves the signer&#8217;s identity) and the access to its associated private key is needed.</p>
</li>
<li>
<p>To electronically validate a signed document the signer&#8217;s certificate containing the public key is needed. To give a more colourful example: when a digitally signed document is sent to a given person or organization in order to be validated, the certificate with the public key used to create the signature must also be provided.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_xades_profiles"><a class="anchor" href="#_xades_profiles"></a>XAdES Profiles</h3>
<div class="paragraph">
<p>The new ETSI standard defines four conformance levels to address the growing need to protect the validity of the signature in time. Henceforth to denote the level of the signature the word "level" will be used. Follows the list of levels defined in the standard:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>XAdES-BASELINE-<strong>B</strong>: <em>Basic Electronic Signature</em>
The lowest and simplest version just containing the SignedInfo, SignatureValue, KeyInfo and SignedProperties. This level combines the old -BES and -EPES levels.
This form extends the definition of an electronic signature to conform to the identified signature policy.</p>
</li>
<li>
<p>XAdES-BASELINE-<strong>T</strong>: <em>Signature with a timestamp</em>
A timestamp regarding the time of signing is added to protect against repudiation.</p>
</li>
<li>
<p>XAdES-BASELINE-<strong>LT</strong>: <em>Signature with Long Term Data</em>
Certificates and revocation data are embedded to allow verification in future even if their original source is not available. This level is equivalent to the old -XL level.</p>
</li>
<li>
<p>XAdES-BASELINE-<strong>LTA</strong>: <em>Signature with Long Term Data and Archive timestamp</em>
By using periodical timestamping (e.g. each year) compromising is prevented which could be caused by weakening previous signatures during a long-time storage period. This level is equivalent to the old -A level.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Old levels: -BES, -EPES, -C, -X, -XL, -A are not supported any more when signing.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_xades_baseline_b"><a class="anchor" href="#_xades_baseline_b"></a>XAdES-BASELINE-B</h4>
<div class="paragraph">
<p>To start, let&#8217;s take a simple XML document:</p>
</div>
<div id="xml_example.xml" class="listingblock">
<div class="title">xml_example.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="preprocessor">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="tag">&lt;test&gt;</span>Hello World !<span class="tag">&lt;/test&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Since this is an XML document, we will use the XAdES signature and more particularly XAdES-BASELINE-B level, which is the lowest level of protection: just satisfying Directive (cf. <a href="#R06">[R06]</a>) legal requirements for advanced signature. The normal process of signing wants to sign first with the level -B or level-T, and then later when it becomes necessary to complete the signature with superior levels. However, the framework allows signing directly with any level.
When signing data, the resulting signature needs to be linked with the data to which it applies. This can be done either by creating a data set which combines the signature and the data (e.g. by enveloping the data with the signature or including a signature element in the data set) or placing the signature in a separate resource and having some external means for associating the signature with the data. So, we need to define the packaging of the signature, namely ENVELOPED, ENVELOPING, DETACHED or INTERNALLY-DETACHED.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>ENVELOPED :</strong> when the signature applies to data that surround the rest of the document;</p>
</li>
<li>
<p><strong>ENVELOPING :</strong> when the signed data form a sub-element of the signature itself;</p>
<div class="ulist">
<ul>
<li>
<p>Base64 encoded binaries;</p>
</li>
<li>
<p>Embed XML object(s);</p>
</li>
<li>
<p>Embed <a href="https://www.w3.org/TR/xmldsig-core/#sec-o-Manifest">Manifest</a> object(s)</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>DETACHED :</strong> when the signature relates to the external resource(s) separated from it.</p>
</li>
<li>
<p><strong>INTERNALLY-DETACHED :</strong> when the signature and the related signed data are both included in a parent element (only XML).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For our example, we will use ENVELOPED packaging.</p>
</div>
<div class="paragraph">
<p>The DSS framework uses 3 atomic steps to sign a document :</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Compute the digest to be signed;</p>
</li>
<li>
<p>Sign the digest;</p>
</li>
<li>
<p>Sign the document (add the signed digest).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The DSS fully manages the steps 1 and 3. We need to specify how to do the signature operation. DSS offers some implementations in the dss-token module</p>
</div>
<div class="paragraph">
<p>To write our Java code, we still need to specify the type of KeyStore to use for signing our document, more simply, where the private key can be found. In the package "eu.europa.esig.dss.token", we can choose between different connection tokens :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Pkcs11SignatureToken :</strong> allows to communicate with SmartCards with the PKCS#11 interface. It requires some installed drivers (dll, sso,&#8230;&#8203;)</p>
</li>
<li>
<p><strong>Pkcs12SignatureToken :</strong> allows to sign with a PKC#12 keystore (.p12 file).</p>
</li>
<li>
<p><strong>MSCAPISignatureToken :</strong> handles the signature with MS CAPI (the Microsoft interface to communicate with SmartCards).</p>
</li>
<li>
<p><strong>JKSSignatureToken :</strong> allows to sign with a Java Key Store (.jks file).</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The DSS also provides the support for MOCCA framework to communicate with the Smartcard with PC/SC, but it involves the installation of the MOCCA and IAIK libraries.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To know more about the use of the different signature tokens, please consult "Management of Signature Tokens" chapter.</p>
</div>
<div class="paragraph">
<p>In our example the class: "Pkcs12SignatureToken" will be used. A file in PKCS#12 format must be provided to the constructor of the class. It contains an X.509 private key accompanying the public key certificate and protected by symmetrical password. The certification chain can also be included in this file. It is possible to generate dummy certificates and their chains with OpenSSL. Please visit <a href="http://www.openssl.org/" class="bare">http://www.openssl.org/</a> for more details.</p>
</div>
<div class="paragraph">
<p>This is the complete code that allows you to sign our XML document.</p>
</div>
<div class="listingblock">
<div class="title">Create a XAdES signature</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// Preparing parameters for the XAdES signature</span>
XAdESSignatureParameters parameters = <span class="keyword">new</span> XAdESSignatureParameters();
<span class="comment">// We choose the level of the signature (-B, -T, -LT, -LTA).</span>
parameters.setSignatureLevel(SignatureLevel.XAdES_BASELINE_B);
<span class="comment">// We choose the type of the signature packaging (ENVELOPED, ENVELOPING, DETACHED).</span>
parameters.setSignaturePackaging(SignaturePackaging.ENVELOPED);
<span class="comment">// We set the digest algorithm to use with the signature algorithm. You must use the</span>
<span class="comment">// same parameter when you invoke the method sign on the token. The default value is SHA256</span>
parameters.setDigestAlgorithm(DigestAlgorithm.SHA256);

<span class="comment">// We set the signing certificate</span>
parameters.setSigningCertificate(privateKey.getCertificate());
<span class="comment">// We set the certificate chain</span>
parameters.setCertificateChain(privateKey.getCertificateChain());

<span class="comment">// Create common certificate verifier</span>
CommonCertificateVerifier commonCertificateVerifier = <span class="keyword">new</span> CommonCertificateVerifier();

<span class="comment">// Create XAdES service for signature</span>
XAdESService service = <span class="keyword">new</span> XAdESService(commonCertificateVerifier);

<span class="comment">// Get the SignedInfo XML segment that need to be signed.</span>
ToBeSigned dataToSign = service.getDataToSign(toSignDocument, parameters);

<span class="comment">// This function obtains the signature value for signed information using the</span>
<span class="comment">// private key and specified algorithm</span>
SignatureValue signatureValue = signingToken.sign(dataToSign, parameters.getDigestAlgorithm(), privateKey);

<span class="comment">// We invoke the service to sign the document with the signature value obtained in</span>
<span class="comment">// the previous step.</span>
DSSDocument signedDocument = service.signDocument(toSignDocument, parameters, signatureValue);</code></pre>
</div>
</div>
<div class="paragraph">
<p>What you may notice is that to sign a document we need to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create an object based on SignatureParameters class. The number of specified parameters depends on the type of signature. Generally, the number of specified parameters depends on the profile of signature. This object also defines some default parameters.</p>
</li>
<li>
<p>Choose the profile, packaging, signature digest algorithm.</p>
</li>
<li>
<p>Indicate the private key entry to be used.</p>
</li>
<li>
<p>Instantiate the adequate signature service.</p>
</li>
<li>
<p>Carry out the signature process.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The encryption algorithm is determined by the private key and therefore cannot be compelled by the setter of the signature parameters object. It will cause an inconsistency in the signature making its validation impossible. This setter can be used in a particular context where the signing process is distributed on different machines and the private key is known only to the signature value creation process. See clause "Signing process" for more information.
In the case where the private key entry object is not available, it is possible to choose the signing certificate and its certificate chain as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// We set the signing certificate</span>
parameters.setSigningCertificate(certificateToken);
<span class="comment">// We set the certificate chain</span>
parameters.setCertificateChain(certificateChain);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Integrating the certificate chain in the signature simplifies the build of a prospective certificate chain during the validation process.</p>
</div>
<div class="paragraph">
<p>By default the framework uses the current date time to set the signing date, but in the case where it is necessary to indicate the different time it is possible to use the setter "setSigningDate(Date)" as in the example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// We set the date of the signature.</span>
parameters.bLevel().setSigningDate(<span class="keyword">new</span> <span class="predefined-type">Date</span>());</code></pre>
</div>
</div>
<div class="paragraph">
<p>When the specific service is instantiated a certificate verifier must be set. This object is used to provide four different sources of information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the source of trusted certificates (based on the trusted list(s) specific to the context);</p>
</li>
<li>
<p>the source of intermediate certificates used to build the certificate chain till the trust anchor. This source is only needed when these certificates are not included in the signature itself;</p>
</li>
<li>
<p>the source of OCSP;</p>
</li>
<li>
<p>the source of CRL.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the current implementation this object is only used when profile -LT or -LTA are created.</p>
</div>
<div class="sect4">
<h5 id="_signing_process"><a class="anchor" href="#_signing_process"></a>Signing process</h5>
<div class="paragraph">
<p>Once the parameters of the signature were identified the service object itself must be created. The service used will depend on the type of document to sign. In our case it is an XML file, so we will instantiate a XAdES service. The process of signing takes place in three stages. The first is the "getDataToSign ()" method call, passing as a parameter the document to be signed and the previously selected settings. This step returns the data which is going to be digested and encrypted. In our case it corresponds to the SignedInfo XMLDSig element.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// Create XAdES service for signature</span>
XAdESService service = <span class="keyword">new</span> XAdESService(commonCertificateVerifier);

<span class="comment">// Get the SignedInfo XML segment that need to be signed.</span>
ToBeSigned dataToSign = service.getDataToSign(toSignDocument, parameters);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The next step is a call to the function "sign()" which is invoked on the object token representing the KeyStore and not on the service. This method takes three parameters. The first is the array of bytes that must be signed. It is obtained by the previous method invocation. The second is the algorithm used to create the digest. You have the choice between SHA1, SHA256, and SHA512 (this list is not exhaustive). And the last one is the private key entry.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DigestAlgorithm digestAlgorithm = parameters.getDigestAlgorithm();
SignatureValue signatureValue = signingToken.sign(dataToSign, digestAlgorithm, privateKey);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The last step of this process is the integration of the signature value in the signature and linking of that one to the signed document based on the selected packaging method. This is the method "signDocument()" on the service. We must pass to it three parameters: again the document to sign, the signature parameters and the value of the signature obtained in the previous step.</p>
</div>
<div class="paragraph">
<p>This separation into three steps allows use cases where different environments have their precise responsibilities: specifically the distinction between communicating with the token and executing the business logic.</p>
</div>
<div class="paragraph">
<p>When the breakdown of this process is not necessary than a simple call to only one method can be done as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DSSDocument signedDocument = service.signDocument(toSignDocument, parameters, signatureValue);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_additional_attributes"><a class="anchor" href="#_additional_attributes"></a>Additional attributes</h5>
<div class="paragraph">
<p>For this type (XAdES-BASELINE-B) of signature it is possible to identify some additional attributes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>SignerRole - contains claimed roles assumed by the signer when creating the signature.</p>
</li>
<li>
<p>SignatureProductionPlace - contains the indication of the purported place where the signer claims to have produced the signature.</p>
</li>
<li>
<p>CommitmentTypeIndication - identifies the commitment undertaken by the signer in signing (a) signed data object(s) in the context of the selected signature policy.</p>
</li>
<li>
<p>AllDataObjectsTimeStamp - each time-stamp token within this property covers the full set of references defined in the Signature&#8217;s SignedInfo element, excluding references of type "SignedProperties".</p>
</li>
<li>
<p>IndividualDataObjectsTimeStamp - each time-stamp token within this property covers selected signed data objects.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The DSS framework allows to setup the following signed properties: SignerRole, SignatureProductionPlace, CommitmentTypeIndication, AllDataObjectsTimestamp and IndividualDataObjectsTimeStamp.</p>
</div>
<div id="SignXmlXadesBProperties.java" class="listingblock">
<div class="title">XAdES signature with additional signed attributes</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">XAdESSignatureParameters parameters = <span class="keyword">new</span> XAdESSignatureParameters();

<span class="comment">// Basic signature configuration</span>
parameters.setSignaturePackaging(SignaturePackaging.ENVELOPED);
parameters.setSignatureLevel(SignatureLevel.XAdES_BASELINE_B);
parameters.setDigestAlgorithm(DigestAlgorithm.SHA512);
parameters.setSigningCertificate(privateKey.getCertificate());
parameters.setCertificateChain(privateKey.getCertificateChain());

<span class="comment">// Configuration of several signed attributes like ...</span>
BLevelParameters bLevelParameters = parameters.bLevel();

<span class="comment">// claimed signer role(s)</span>
bLevelParameters.setClaimedSignerRoles(<span class="predefined-type">Arrays</span>.asList(<span class="string"><span class="delimiter">&quot;</span><span class="content">Manager</span><span class="delimiter">&quot;</span></span>));

<span class="comment">// signer location</span>
SignerLocation signerLocation = <span class="keyword">new</span> SignerLocation();
signerLocation.setCountry(<span class="string"><span class="delimiter">&quot;</span><span class="content">BE</span><span class="delimiter">&quot;</span></span>);
signerLocation.setStateOrProvince(<span class="string"><span class="delimiter">&quot;</span><span class="content">Luxembourg</span><span class="delimiter">&quot;</span></span>);
signerLocation.setPostalCode(<span class="string"><span class="delimiter">&quot;</span><span class="content">1234</span><span class="delimiter">&quot;</span></span>);
signerLocation.setLocality(<span class="string"><span class="delimiter">&quot;</span><span class="content">SimCity</span><span class="delimiter">&quot;</span></span>);
bLevelParameters.setSignerLocation(signerLocation);

<span class="comment">// commitment type(s)</span>
<span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; commitmentTypeIndications = <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;<span class="predefined-type">String</span>&gt;();
commitmentTypeIndications.add(CommitmentType.ProofOfOrigin.getUri());
commitmentTypeIndications.add(CommitmentType.ProofOfApproval.getUri());
bLevelParameters.setCommitmentTypeIndications(commitmentTypeIndications);

CommonCertificateVerifier verifier = <span class="keyword">new</span> CommonCertificateVerifier();
XAdESService service = <span class="keyword">new</span> XAdESService(verifier);
service.setTspSource(getOnlineTSPSource());

<span class="comment">// a content-timestamp (part of the signed attributes)</span>
TimestampToken contentTimestamp = service.getContentTimestamp(toSignDocument, parameters);
parameters.setContentTimestamps(<span class="predefined-type">Arrays</span>.asList(contentTimestamp));

<span class="comment">// Signature process with its 3 stateless steps</span>
ToBeSigned dataToSign = service.getDataToSign(toSignDocument, parameters);
SignatureValue signatureValue = signingToken.sign(dataToSign, parameters.getDigestAlgorithm(), privateKey);
DSSDocument signedDocument = service.signDocument(toSignDocument, parameters, signatureValue);</code></pre>
</div>
</div>
<div class="paragraph">
<p>This code adds the following elements into the signature :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;xades:SignedProperties</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xades-id-ea3e16770317bb1a3e97244292931644</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;xades:SignedSignatureProperties&gt;</span>
                <span class="tag">&lt;xades:SigningTime&gt;</span>2018-03-20T08:17:35Z<span class="tag">&lt;/xades:SigningTime&gt;</span>
                <span class="tag">&lt;xades:SigningCertificateV2&gt;</span>
                        <span class="tag">&lt;xades:Cert&gt;</span>
                                <span class="tag">&lt;xades:CertDigest&gt;</span>
                                        <span class="tag">&lt;ds:DigestMethod</span> <span class="attribute-name">Algorithm</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2000/09/xmldsig#sha1</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                        <span class="tag">&lt;ds:DigestValue&gt;</span>2FeANjXziO9x2877SfclRlRVjlE=<span class="tag">&lt;/ds:DigestValue&gt;</span>
                                <span class="tag">&lt;/xades:CertDigest&gt;</span>
                                <span class="tag">&lt;xades:IssuerSerialV2&gt;</span>MD4wNKQyMDAxGzAZBgNVBAMMElJvb3RTZWxmU2lnbmVkRmFrZTERMA8GA1UECgwIRFNTLXRlc3QCBi7WFNe7Vw==<span class="tag">&lt;/xades:IssuerSerialV2&gt;</span>
                        <span class="tag">&lt;/xades:Cert&gt;</span>
                <span class="tag">&lt;/xades:SigningCertificateV2&gt;</span>
                <span class="tag">&lt;xades:SignatureProductionPlaceV2&gt;</span>
                        <span class="tag">&lt;xades:City&gt;</span>SimCity<span class="tag">&lt;/xades:City&gt;</span>
                        <span class="tag">&lt;xades:StateOrProvince&gt;</span>Luxembourg<span class="tag">&lt;/xades:StateOrProvince&gt;</span>
                        <span class="tag">&lt;xades:PostalCode&gt;</span>1234<span class="tag">&lt;/xades:PostalCode&gt;</span>
                        <span class="tag">&lt;xades:CountryName&gt;</span>BE<span class="tag">&lt;/xades:CountryName&gt;</span>
                <span class="tag">&lt;/xades:SignatureProductionPlaceV2&gt;</span>
                <span class="tag">&lt;xades:SignerRoleV2&gt;</span>
                        <span class="tag">&lt;xades:ClaimedRoles&gt;</span>
                                <span class="tag">&lt;xades:ClaimedRole&gt;</span>Manager<span class="tag">&lt;/xades:ClaimedRole&gt;</span>
                        <span class="tag">&lt;/xades:ClaimedRoles&gt;</span>
                <span class="tag">&lt;/xades:SignerRoleV2&gt;</span>
        <span class="tag">&lt;/xades:SignedSignatureProperties&gt;</span>
        <span class="tag">&lt;xades:SignedDataObjectProperties&gt;</span>
                <span class="tag">&lt;xades:DataObjectFormat</span> <span class="attribute-name">ObjectReference</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#r-id-1</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                        <span class="tag">&lt;xades:MimeType&gt;</span>text/xml<span class="tag">&lt;/xades:MimeType&gt;</span>
                <span class="tag">&lt;/xades:DataObjectFormat&gt;</span>
                <span class="tag">&lt;xades:CommitmentTypeIndication&gt;</span>
                        <span class="tag">&lt;xades:CommitmentTypeId&gt;</span>
                                <span class="tag">&lt;xades:Identifier&gt;</span>http://uri.etsi.org/01903/v1.2.2#ProofOfOrigin<span class="tag">&lt;/xades:Identifier&gt;</span>
                        <span class="tag">&lt;/xades:CommitmentTypeId&gt;</span>
                        <span class="tag">&lt;xades:AllSignedDataObjects</span> <span class="tag">/&gt;</span>
                <span class="tag">&lt;/xades:CommitmentTypeIndication&gt;</span>
                <span class="tag">&lt;xades:CommitmentTypeIndication&gt;</span>
                        <span class="tag">&lt;xades:CommitmentTypeId&gt;</span>
                                <span class="tag">&lt;xades:Identifier&gt;</span>http://uri.etsi.org/01903/v1.2.2#ProofOfApproval<span class="tag">&lt;/xades:Identifier&gt;</span>
                        <span class="tag">&lt;/xades:CommitmentTypeId&gt;</span>
                        <span class="tag">&lt;xades:AllSignedDataObjects</span> <span class="tag">/&gt;</span>
                <span class="tag">&lt;/xades:CommitmentTypeIndication&gt;</span>
                <span class="tag">&lt;xades:AllDataObjectsTimeStamp</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">TS-678B5861DBA1469B3AA3DD49DD54D7046BADA578C5561F8ABDA935CE0825279E</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                        <span class="tag">&lt;ds:CanonicalizationMethod</span>
                                <span class="attribute-name">Algorithm</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/10/xml-exc-c14n#</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                        <span class="tag">&lt;xades:EncapsulatedTimeStamp&gt;</span>MIAGCSqGSIb3DQEHAq...aAAAAAA=<span class="tag">&lt;/xades:EncapsulatedTimeStamp&gt;</span>
                <span class="tag">&lt;/xades:AllDataObjectsTimeStamp&gt;</span>
        <span class="tag">&lt;/xades:SignedDataObjectProperties&gt;</span>
<span class="tag">&lt;/xades:SignedProperties&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_handling_signature_policy"><a class="anchor" href="#_handling_signature_policy"></a>Handling signature policy</h5>
<div class="paragraph">
<p>With the new standards the policy handling is linked to -B level. The old -EPES level is not used anymore by the framework. This does not alter the structure of the old signature but only modifies how to control the process of its creation.</p>
</div>
<div class="paragraph">
<p>The DSS framework allows you to reference a signature policy, which is a set of rules for the creation and validation of an electronic signature. It includes two kinds of text:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In human readable form:
It can be assessed to meet the requirements of the legal and contractual context in which it is being applied.</p>
</li>
<li>
<p>In a machine processable form:
To facilitate its automatic processing using the electronic rules.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If no signature policy is identified then the signature may be assumed to have been generated or verified without any policy constraints, and hence may be given no specific legal or contractual significance through the context of a signature policy.</p>
</div>
<div class="paragraph">
<p>The signer may reference the policy either implicitly or explicitly. An implied policy means the signer follows the rules of the policy but the signature does not indicate which policy. It is assumed the choice of policy is clear from the context in which the signature is used and SignaturePolicyIdentifier element will be empty. When the policy is not implied, the signature contains an ObjectIdentier that uniquely identifies the version of the policy in use. The signature also contains a hash of the policy document to make sure that the signer and verifier agree on the contents of the policy document.</p>
</div>
<div class="paragraph">
<p>This example demonstrates an implicit policy identifier. To implement this alternative you must set SignaturePolicyId to empty string.</p>
</div>
<div class="listingblock">
<div class="title">XAdES with implicit policy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">XAdESSignatureParameters parameters = <span class="keyword">new</span> XAdESSignatureParameters();
parameters.setSignatureLevel(SignatureLevel.XAdES_BASELINE_B);
parameters.setSignaturePackaging(SignaturePackaging.ENVELOPED);
parameters.setDigestAlgorithm(DigestAlgorithm.SHA256);

<span class="comment">// We set the signing certificate</span>
parameters.setSigningCertificate(privateKey.getCertificate());
<span class="comment">// We set the certificate chain</span>
parameters.setCertificateChain(privateKey.getCertificateChain());

BLevelParameters bLevelParameters = parameters.bLevel();

<span class="predefined-type">Policy</span> policy = <span class="keyword">new</span> <span class="predefined-type">Policy</span>();
policy.setId(<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>);

bLevelParameters.setSignaturePolicy(policy);

<span class="comment">// Create common certificate verifier</span>
CommonCertificateVerifier commonCertificateVerifier = <span class="keyword">new</span> CommonCertificateVerifier();
<span class="comment">// Create xadesService for signature</span>
XAdESService service = <span class="keyword">new</span> XAdESService(commonCertificateVerifier);

<span class="comment">// Get the SignedInfo segment that need to be signed.</span>
ToBeSigned dataToSign = service.getDataToSign(toSignDocument, parameters);

<span class="comment">// This function obtains the signature value for signed information using the</span>
<span class="comment">// private key and specified algorithm</span>
DigestAlgorithm digestAlgorithm = parameters.getDigestAlgorithm();
SignatureValue signatureValue = signingToken.sign(dataToSign, digestAlgorithm, privateKey);

<span class="comment">// We invoke the xadesService to sign the document with the signature value obtained in</span>
<span class="comment">// the previous step.</span>
DSSDocument signedDocument = service.signDocument(toSignDocument, parameters, signatureValue);</code></pre>
</div>
</div>
<div class="paragraph">
<p>An XML segment will be added to the signature&#8217;s qualified and signed properties:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;xades:SignaturePolicyIdentifier&gt;</span>
        <span class="tag">&lt;xades:SignaturePolicyId&gt;</span>
                <span class="tag">&lt;xades:SignaturePolicyImplied</span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/xades:SignaturePolicyId&gt;</span>
<span class="tag">&lt;/xades:SignaturePolicyIdentifier&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The next example demonstrates an explicit policy identifier. This is obtained by setting -B profile signature policy and assigning values to the policy parameters. The Signature Policy Identifier is a URI or OID  that uniquely identifies the version of the policy document. The signature will contain the identifier of the hash algorithm and the hash value of the policy document. The DSS framework does not automatically calculate the hash value; it is to the developer to proceed with the calculation using for example java.security.MessageDigest class (rt.jar). It is important to keep the policy file intact in order to keep the hash constant. It would be wise to make the policy file read-only. See also chapter 7 for further information.</p>
</div>
<div class="listingblock">
<div class="title">XAdES with explicit policy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">XAdESSignatureParameters parameters = <span class="keyword">new</span> XAdESSignatureParameters();
parameters.setSignatureLevel(SignatureLevel.XAdES_BASELINE_B);
parameters.setSignaturePackaging(SignaturePackaging.ENVELOPED);
parameters.setDigestAlgorithm(DigestAlgorithm.SHA256);

<span class="comment">// We set the signing certificate</span>
parameters.setSigningCertificate(privateKey.getCertificate());
<span class="comment">// We set the certificate chain</span>
parameters.setCertificateChain(privateKey.getCertificateChain());

BLevelParameters bLevelParameters = parameters.bLevel();

<span class="comment">// Get and use the explicit policy</span>
<span class="predefined-type">String</span> signaturePolicyId = <span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.example.com/policy.txt</span><span class="delimiter">&quot;</span></span>;
DigestAlgorithm signaturePolicyHashAlgo = DigestAlgorithm.SHA256;
<span class="predefined-type">String</span> signaturePolicyDescription = <span class="string"><span class="delimiter">&quot;</span><span class="content">Policy text to digest</span><span class="delimiter">&quot;</span></span>;
<span class="type">byte</span><span class="type">[]</span> signaturePolicyDescriptionBytes = signaturePolicyDescription.getBytes();
<span class="type">byte</span><span class="type">[]</span> digestedBytes = DSSUtils.digest(signaturePolicyHashAlgo, signaturePolicyDescriptionBytes);

<span class="predefined-type">Policy</span> policy = <span class="keyword">new</span> <span class="predefined-type">Policy</span>();
policy.setId(signaturePolicyId);
policy.setDigestAlgorithm(signaturePolicyHashAlgo);
policy.setDigestValue(digestedBytes);

bLevelParameters.setSignaturePolicy(policy);

<span class="comment">// Create common certificate verifier</span>
CommonCertificateVerifier commonCertificateVerifier = <span class="keyword">new</span> CommonCertificateVerifier();
<span class="comment">// Create xadesService for signature</span>
XAdESService service = <span class="keyword">new</span> XAdESService(commonCertificateVerifier);

<span class="comment">// Get the SignedInfo segment that need to be signed.</span>
ToBeSigned dataToSign = service.getDataToSign(toSignDocument, parameters);

<span class="comment">// This function obtains the signature value for signed information using the</span>
<span class="comment">// private key and specified algorithm</span>
DigestAlgorithm digestAlgorithm = parameters.getDigestAlgorithm();
SignatureValue signatureValue = signingToken.sign(dataToSign, digestAlgorithm, privateKey);

<span class="comment">// We invoke the xadesService to sign the document with the signature value obtained in</span>
<span class="comment">// the previous step.</span>
DSSDocument signedDocument = service.signDocument(toSignDocument, parameters, signatureValue);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following XML segment will be added to the signature qualified &amp; signed properties (&lt;QualifyingProperties&gt;&lt;SignedProperties&gt;):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;xades:SignaturePolicyIdentifier&gt;</span>
        <span class="tag">&lt;xades:SignaturePolicyId&gt;</span>
                <span class="tag">&lt;xades:SigPolicyId&gt;</span>
                        <span class="tag">&lt;xades:Identifier&gt;</span>http://www.example.com/policy.txt<span class="tag">&lt;/xades:Identifier&gt;</span>
                <span class="tag">&lt;/xades:SigPolicyId&gt;</span>
                <span class="tag">&lt;xades:SigPolicyHash&gt;</span>
                        <span class="tag">&lt;ds:DigestMethod</span> <span class="attribute-name">Algorithm</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/04/xmlenc#sha256</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
                <span class="tag">&lt;ds:DigestValue&gt;</span>Uw3PxkrX4SpF03jDvkSu6Zqm9UXDxs56FFXeg7MWy0c=<span class="tag">&lt;/ds:DigestValue&gt;</span>
                <span class="tag">&lt;/xades:SigPolicyHash&gt;</span>
        <span class="tag">&lt;/xades:SignaturePolicyId&gt;</span>
<span class="tag">&lt;/xades:SignaturePolicyIdentifier&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_xades_baseline_t"><a class="anchor" href="#_xades_baseline_t"></a>XAdES-BASELINE-T</h4>
<div class="paragraph">
<p>XAdES-BASELINE-T is a signature for which there exists a trusted time associated to the signature. It provides the initial steps towards providing long term validity and more specifically it provides a protection against repudiation. This extension of the signature can be created as well during the generation process as validation process. However, the case when these validation data are not added during the generation process should no longer occur. The XAdES-BASELINE-T trusted time indications must be created before the signing certificate has been revoked or expired and close to the time that the XAdES signature was produced. The XAdES-BASELINE-T form must be built on a XAdES-BASELINE-B form. The DSS framework allows extending the old -BES and -EPES profiles to the new BASELINE-T profile, indeed there is no difference in the structure of the signature.</p>
</div>
<div class="paragraph">
<p>To implement this profile of signature you must indicate to the service the TSA source, which delivers from each Timestamp Request a Timestamp Response (RFC 3161 (cf. <a href="#R07">[R07]</a>)) containing tokens. Below is the source code that creates a XAdES-BASELINE-T signature. For our example, we will use the Belgian provider and an instance of OnlineTSPSource (see "TSP Sources" chapter for more details).</p>
</div>
<div class="listingblock">
<div class="title">Create a XAdES-Baseline-T with an OnlineTSPSource</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// Preparing parameters for the XAdES signature</span>
XAdESSignatureParameters parameters = <span class="keyword">new</span> XAdESSignatureParameters();
<span class="comment">// We choose the level of the signature (-B, -T, -LT, -LTA).</span>
parameters.setSignatureLevel(SignatureLevel.XAdES_BASELINE_T);
<span class="comment">// We choose the type of the signature packaging (ENVELOPED, ENVELOPING, DETACHED).</span>
parameters.setSignaturePackaging(SignaturePackaging.ENVELOPED);
<span class="comment">// We set the digest algorithm to use with the signature algorithm. You must use the</span>
<span class="comment">// same parameter when you invoke the method sign on the token. The default value is SHA256</span>
parameters.setDigestAlgorithm(DigestAlgorithm.SHA256);

<span class="comment">// We set the signing certificate</span>
parameters.setSigningCertificate(privateKey.getCertificate());
<span class="comment">// We set the certificate chain</span>
parameters.setCertificateChain(privateKey.getCertificateChain());

<span class="comment">// Create common certificate verifier</span>
CommonCertificateVerifier commonCertificateVerifier = <span class="keyword">new</span> CommonCertificateVerifier();
<span class="comment">// Create XAdES service for signature</span>
XAdESService service = <span class="keyword">new</span> XAdESService(commonCertificateVerifier);

<span class="comment">// Set the Timestamp source</span>
<span class="predefined-type">String</span> tspServer = <span class="string"><span class="delimiter">&quot;</span><span class="content">http://tsa.belgium.be/connect</span><span class="delimiter">&quot;</span></span>;
OnlineTSPSource onlineTSPSource = <span class="keyword">new</span> OnlineTSPSource(tspServer);
service.setTspSource(onlineTSPSource);

<span class="comment">// Get the SignedInfo XML segment that need to be signed.</span>
ToBeSigned dataToSign = service.getDataToSign(toSignDocument, parameters);

<span class="comment">// This function obtains the signature value for signed information using the</span>
<span class="comment">// private key and specified algorithm</span>
SignatureValue signatureValue = signingToken.sign(dataToSign, parameters.getDigestAlgorithm(), privateKey);

<span class="comment">// We invoke the service to sign the document with the signature value obtained in</span>
<span class="comment">// the previous step.</span>
DSSDocument signedDocument = service.signDocument(toSignDocument, parameters, signatureValue);</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the timestamp source is not set a NullPointerException is thrown.</p>
</div>
<div class="paragraph">
<p>The SignatureTimeStamp mandated by the XAdES-T form appears as an unsigned property within the QualifyingProperties:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;SignatureTimeStamp</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">time-stamp-28a441da-4030-46ef-80e1-041b66c0cb96</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;ds:CanonicalizationMethod</span> <span class="attribute-name">Algorithm</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/10/xml-exc-c14n#</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
        <span class="tag">&lt;EncapsulatedTimeStamp</span>
                <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">time-stamp-token-76234ed8-cc15-46fc-aa95-9460dd601cad</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                        MIAGCSqGSIb3DQEHAqCAMIACAQMxCzAJBgUrDgMCGg
                        UAMIAGCyqGSIb3DQEJEAEEoIAkgARMMEoCAQEGBoIS
                        ...
        <span class="tag">&lt;/EncapsulatedTimeStamp&gt;</span>
<span class="tag">&lt;/SignatureTimeStamp&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_xades_baseline_lt"><a class="anchor" href="#_xades_baseline_lt"></a>XAdES-BASELINE-LT</h4>
<div class="paragraph">
<p>This level has to prove that the certification path was valid, at the time of the validation of the signature, up to a trust point according to the naming constraints and the certificate policy constraints from the "Signature Validation Policy". It will add to the signature the CertificateValues and RevocationValues unsigned properties. The CertificateValues element contains the full set of certificates that have been used to validate the electronic signature, including the signer&#8217;s certificate. However, it is not necessary to include one of those certificates, if it is already present in the ds:KeyInfo element of the signature. This is like DSS framework behaves. In order to find a list of all the certificates and the list of all revocation data, an automatic process of signature validation is executed. To carry out this process an object called CertificateVerifier must be passed to the service. The implementer must set some of its properties like par example the source of trusted certificates. The code below shows how to use the default parameters with this object. Please refer to "The Signature Validation" chapter to have the further information. It also includes an example of how to implement this level of signature:</p>
</div>
<div id="SignXmlXadesLTTest.java" class="listingblock">
<div class="title">SignXmlXadesLTTest.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// Preparing parameters for the XAdES signature</span>
XAdESSignatureParameters parameters = <span class="keyword">new</span> XAdESSignatureParameters();
<span class="comment">// We choose the level of the signature (-B, -T, -LT, -LTA).</span>
parameters.setSignatureLevel(SignatureLevel.XAdES_BASELINE_LT);
<span class="comment">// We choose the type of the signature packaging (ENVELOPED, ENVELOPING, DETACHED).</span>
parameters.setSignaturePackaging(SignaturePackaging.ENVELOPED);
<span class="comment">// We set the digest algorithm to use with the signature algorithm. You must use the</span>
<span class="comment">// same parameter when you invoke the method sign on the token. The default value is SHA256</span>
parameters.setDigestAlgorithm(DigestAlgorithm.SHA256);

<span class="comment">// We set the signing certificate</span>
parameters.setSigningCertificate(privateKey.getCertificate());
<span class="comment">// We set the certificate chain</span>
parameters.setCertificateChain(privateKey.getCertificateChain());

<span class="comment">// Create common certificate verifier</span>
CommonCertificateVerifier commonCertificateVerifier = <span class="keyword">new</span> CommonCertificateVerifier();

CommonsDataLoader commonsHttpDataLoader = <span class="keyword">new</span> CommonsDataLoader();
OCSPDataLoader ocspDataLoader = <span class="keyword">new</span> OCSPDataLoader();

KeyStoreCertificateSource keyStoreCertificateSource = <span class="keyword">new</span> KeyStoreCertificateSource(<span class="keyword">new</span> <span class="predefined-type">File</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">src/main/resources/keystore.p12</span><span class="delimiter">&quot;</span></span>), <span class="string"><span class="delimiter">&quot;</span><span class="content">PKCS12</span><span class="delimiter">&quot;</span></span>,
                <span class="string"><span class="delimiter">&quot;</span><span class="content">dss-password</span><span class="delimiter">&quot;</span></span>);

TrustedListsCertificateSource tslCertificateSource = <span class="keyword">new</span> TrustedListsCertificateSource();

TSLRepository tslRepository = <span class="keyword">new</span> TSLRepository();
tslRepository.setTrustedListsCertificateSource(tslCertificateSource);

TSLValidationJob job = <span class="keyword">new</span> TSLValidationJob();
job.setDataLoader(commonsHttpDataLoader);
job.setOjContentKeyStore(keyStoreCertificateSource);
job.setLotlRootSchemeInfoUri(<span class="string"><span class="delimiter">&quot;</span><span class="content">https://ec.europa.eu/information_society/policy/esignature/trusted-list/tl.html</span><span class="delimiter">&quot;</span></span>);
job.setLotlUrl(<span class="string"><span class="delimiter">&quot;</span><span class="content">https://ec.europa.eu/information_society/policy/esignature/trusted-list/tl-mp.xml</span><span class="delimiter">&quot;</span></span>);
job.setOjUrl(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://eur-lex.europa.eu/legal-content/EN/TXT/?uri=uriserv:OJ.C_.2016.233.01.0001.01.ENG</span><span class="delimiter">&quot;</span></span>);
job.setLotlCode(<span class="string"><span class="delimiter">&quot;</span><span class="content">EU</span><span class="delimiter">&quot;</span></span>);
job.setRepository(tslRepository);
job.refresh();

commonCertificateVerifier.setTrustedCertSource(tslCertificateSource);

OnlineCRLSource onlineCRLSource = <span class="keyword">new</span> OnlineCRLSource();
onlineCRLSource.setDataLoader(commonsHttpDataLoader);
commonCertificateVerifier.setCrlSource(onlineCRLSource);

OnlineOCSPSource onlineOCSPSource = <span class="keyword">new</span> OnlineOCSPSource();
onlineOCSPSource.setDataLoader(ocspDataLoader);
commonCertificateVerifier.setOcspSource(onlineOCSPSource);

<span class="comment">// For test purpose</span>
<span class="comment">// Will request unknown OCSP responder / download untrusted CRL</span>
commonCertificateVerifier.setCheckRevocationForUntrustedChains(<span class="predefined-constant">true</span>);

<span class="comment">// Create XAdES service for signature</span>
XAdESService service = <span class="keyword">new</span> XAdESService(commonCertificateVerifier);
service.setTspSource(getOnlineTSPSource());

<span class="comment">// Get the SignedInfo XML segment that need to be signed.</span>
ToBeSigned dataToSign = service.getDataToSign(toSignDocument, parameters);

<span class="comment">// This function obtains the signature value for signed information using the</span>
<span class="comment">// private key and specified algorithm</span>
SignatureValue signatureValue = signingToken.sign(dataToSign, parameters.getDigestAlgorithm(), privateKey);

<span class="comment">// We invoke the service to sign the document with the signature value obtained in</span>
<span class="comment">// the previous step.</span>
DSSDocument signedDocument = service.signDocument(toSignDocument, parameters, signatureValue);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following XML segment will be added to the signature qualified and unsigned properties:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;CertificateValues&gt;</span>
        <span class="tag">&lt;EncapsulatedX509Certificate&gt;</span>
                MIIFNTCCBB2gAwIBAgIBATANB...
        <span class="tag">&lt;/EncapsulatedX509Certificate&gt;</span>
        <span class="tag">&lt;EncapsulatedX509Certificate&gt;</span>
                MIIFsjCCBJqgAwIBAgIDAMoBM...
        <span class="tag">&lt;/EncapsulatedX509Certificate&gt;</span>
        <span class="tag">&lt;EncapsulatedX509Certificate&gt;</span>
                MIIFRjCCBC6gAwIBAgIBATANB...
        <span class="tag">&lt;/EncapsulatedX509Certificate&gt;</span>
<span class="tag">&lt;/CertificateValues&gt;</span>
<span class="tag">&lt;RevocationValues&gt;</span>
        <span class="tag">&lt;OCSPValues&gt;</span>
                <span class="tag">&lt;EncapsulatedOCSPValue&gt;</span>
                        MIIGzAoBAKCCBsUwggbBBgkr...
                <span class="tag">&lt;/EncapsulatedOCSPValue&gt;</span>
        <span class="tag">&lt;/OCSPValues&gt;</span>
<span class="tag">&lt;/RevocationValues&gt;</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The use of online sources can significantly increase the execution time of the signing process. For testing purpose you can create your own source of data.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In last example the CommonsHttpDataLoader is used to provide the communication layer for HTTP protocol. Each source which need to go through the network to retrieve data need to have this component set.</p>
</div>
</div>
<div class="sect3">
<h4 id="_xades_baseline_lta"><a class="anchor" href="#_xades_baseline_lta"></a>XAdES-BASELINE-LTA</h4>
<div class="paragraph">
<p>When the cryptographic data becomes weak and the cryptographic functions become vulnerable the auditor should take steps to maintain the validity of the signature. The XAdES-BASELINE-A form uses a simple approach called "archive validation data". It adds additional time-stamps for archiving signatures in a way that they are still protected, but also to be able to prove that the signatures were validated at the time when the used cryptographic algorithms were considered safe. The time-stamping process may be repeated every time the protection used becomes weak. Each time-stamp needs to be affixed before either the signing key or the algorithms used by the TSA are no longer secure. XAdES-A form adds the ArchiveTimestamp element within the UnsignedSignatureProperties and may contain several ArchiveTimestamp elements.</p>
</div>
<div class="paragraph">
<p>Below is an example of the implementation of this level of signature (but in practice, we will rather extend the signature to this level when there is a risk that the cryptographic functions become vulnerable or when one of certificates arrives to its expiration date):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">...
parameters.setSignatureLevel(SignatureLevel.XAdES_BASELINE_LTA);
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following XML segment will be added to the signature qualified and unsigned properties:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;ns4:ArchiveTimeStamp</span>
        <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">time-stamp-22b92602-2670-410e-888f-937c5777c685</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;ds:CanonicalizationMethod</span>
                <span class="attribute-name">Algorithm</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/10/xml-exc-c14n#</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
        <span class="tag">&lt;EncapsulatedTimeStamp</span>
                <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">time-stamp-token-0bd5aaf3-3850-4911-a22d-c98dcaca5cea</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>MIAGCSqGSDHAqCAM…
        <span class="tag">&lt;/EncapsulatedTimeStamp&gt;</span>
<span class="tag">&lt;/ns4:ArchiveTimeStamp&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_various_settings"><a class="anchor" href="#_various_settings"></a>Various settings</h3>
<div class="sect3">
<h4 id="_trust_anchor_inclusion_policy"><a class="anchor" href="#_trust_anchor_inclusion_policy"></a>Trust anchor inclusion policy</h4>
<div class="paragraph">
<p>It is possible to indicate to the framework if the certificate related to the trust anchor should be included to the signature or not. The setter #setTrustAnchorBPPolicy of the BLevelParameters class should be used for this purpose.</p>
</div>
<div class="paragraph">
<p>This rule applies as follows: when -B level is constructed the trust anchor is not included, when -LT level is constructed the trust anchor is included.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
when trust anchor baseline profile policy is defined only the certificates previous to the trust anchor are included when -B level is constructed.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_multiple_signatures"><a class="anchor" href="#_multiple_signatures"></a>Multiple signatures</h3>
<div class="paragraph">
<p>In everyday life, there are many examples where it is necessary to have multiple signatures covering the same document, such as a contract to purchase a vehicle. Independent signatures are parallel signatures where the ordering of the signatures is not important. The computation of these signatures is performed on exactly the same input but using different private keys.</p>
</div>
</div>
<div class="sect2">
<h3 id="_the_xml_signature_extension_xades"><a class="anchor" href="#_the_xml_signature_extension_xades"></a>The XML Signature Extension (XAdES)</h3>
<div class="paragraph">
<p>The -B level contains immutable signed properties. Once this level is created, these properties cannot be changed.</p>
</div>
<div class="paragraph">
<p>The levels -T/-LT/-LTA add unsigned properties to the signature. This means that the properties of these levels could be added afterwards to any AdES signature. This addition helps to make the signature more resistant to cryptographic attacks on a longer period of time. The extension of the signature is incremental, i.e. when you want to extend the signature to the level -LT the lower level (-T) will also be added. The whole extension process is implemented by reusing components from signature production. To extend a signature we proceed in the same way as in the case of a signature, except that you have to call the function "extendDocument" instead of the "sign" function. Note that when the document is signed with several signatures then they are all extended.</p>
</div>
</div>
<div class="sect2">
<h3 id="_xades_baseline_t_2"><a class="anchor" href="#_xades_baseline_t_2"></a>XAdES-BASELINE-T</h3>
<div class="paragraph">
<p>The XAdES-BASELINE-T trusted time indications have to be created before a certificate has been revoked or expired and close to the time that the XAdES signature was produced. It provides a protection against repudiation. The framework adds the timestamp only if there is no timestamp or there is one but the creation of a new extension of the level-T is deliberate (using another TSA). It is not possible to extend a signature which already incorporates higher level as -LT or -LTA. In the theory it would be possible to add another -T level when the signature has already reached level -LT but the framework prevents this operation. Note that if the signed document contains multiple signatures, then all the signatures will be extended to level -T. It is also possible to sign a document directly at level -T.</p>
</div>
<div class="paragraph">
<p>Here is an example of creating an extension of type T:</p>
</div>
<div class="listingblock">
<div class="title">Extend a XAdES signature</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DSSDocument document = <span class="keyword">new</span> FileDocument(<span class="string"><span class="delimiter">&quot;</span><span class="content">src/test/resources/signedXmlXadesB.xml</span><span class="delimiter">&quot;</span></span>);

XAdESSignatureParameters parameters = <span class="keyword">new</span> XAdESSignatureParameters();
parameters.setSignatureLevel(SignatureLevel.XAdES_BASELINE_T);

CommonCertificateVerifier certificateVerifier = <span class="keyword">new</span> CommonCertificateVerifier();
XAdESService xadesService = <span class="keyword">new</span> XAdESService(certificateVerifier);
xadesService.setTspSource(getOnlineTSPSource());

DSSDocument extendedDocument = xadesService.extendDocument(document, parameters);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here is the result of adding a new extension of type-T to an already existing -T level signature:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;UnsignedSignatureProperties&gt;</span>
        <span class="tag">&lt;SignatureTimeStamp</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">time-stamp-b16a2552-b218-4231-8982-40057525fbb5</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;ds:CanonicalizationMethod</span> <span class="attribute-name">Algorithm</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/10/xml-exc-c14n#</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                <span class="tag">&lt;EncapsulatedTimeStamp</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">time-stamp-token-39fbf78c-9cec-4cc1-ac21-a467d2238405</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>                         MIAGCSqGSIb3DQEHAq...
                <span class="tag">&lt;/EncapsulatedTimeStamp&gt;</span>
        <span class="tag">&lt;/SignatureTimeStamp&gt;</span>
        <span class="tag">&lt;SignatureTimeStamp</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">time-stamp-5ffab0d9-863b-414a-9690-a311d3e1af1d</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;ds:CanonicalizationMethod</span> <span class="attribute-name">Algorithm</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/10/xml-exc-c14n#</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                <span class="tag">&lt;EncapsulatedTimeStamp</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">time-stamp-token-87e8c599-89e5-4fb3-a32a-e5e2a40073ad</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>                         MIAGCSqGSIb3DQEHAq...
                <span class="tag">&lt;/EncapsulatedTimeStamp&gt;</span>
        <span class="tag">&lt;/SignatureTimeStamp&gt;</span>
<span class="tag">&lt;/UnsignedSignatureProperties&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_xades_baseline_lt_and_lta"><a class="anchor" href="#_xades_baseline_lt_and_lta"></a>XAdES-BASELINE-LT and -LTA</h3>
<div class="paragraph">
<p>For these types of extensions, the procedure to follow is the same as the case of the extension of type T. Please refer to the chapter XAdES Profiles (XAdES) to know specific parameters for each level of signature and which must be positioned.</p>
</div>
</div>
<div class="sect2">
<h3 id="_xades_and_specific_schema_version"><a class="anchor" href="#_xades_and_specific_schema_version"></a>XAdES and specific schema version</h3>
<div class="paragraph">
<p>Some signatures may have been created with an older version of XAdES standard using different schema definition. To take into account the validation of such signatures the class eu.europa.esig.dss.xades.validation.XPathQueryHolder was created. This class includes all XPath queries which are used to explore the elements of the signature. It is now easy to extend this class in order to define specific queries to a given schema. The DSS framework proposes in standard the class eu.europa.esig.dss.xades.validation.XAdES111XPathQueryHolder that defines the XPath queries for the version "http://uri.etsi.org/01903/v1.1.1#" of XAdES standard.</p>
</div>
<div class="paragraph">
<p>When carrying out the validation process of the signature, the choice of query holder to be used is taken by invoking the method: eu.europa.esig.dss.xades.validation.XPathQueryHolder#canUseThisXPathQueryHolder</p>
</div>
<div class="paragraph">
<p>This choice is made based on the namespace. If the namespace is: <a href="http://uri.etsi.org/01903/v1.3.2#" class="bare">http://uri.etsi.org/01903/v1.3.2#</a> then the default query holder is used, if the namespace is <a href="http://uri.etsi.org/01903/v1.1.1#" class="bare">http://uri.etsi.org/01903/v1.1.1#</a> the XAdES111XPathQueryHolder is used. The element used to choose the namespace is "QualifyingProperties".</p>
</div>
<div class="paragraph">
<p>To implement another query holder the class XPathQueryHolder must be extended, new XPath queries defined and the method canUseThisXPathQueryHolder overridden.</p>
</div>
<div class="paragraph">
<p>In case there is a need to use only a specific query holder the following steps should be followed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Call: eu.europa.esig.dss.xades.validation.XMLDocumentValidator#clearQueryHolders</p>
</li>
<li>
<p>Call: eu.europa.esig.dss.xades.validation.XMLDocumentValidator#addXPathQueryHolder and pass the specific query holder</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_signature_validation"><a class="anchor" href="#_the_signature_validation"></a>The signature validation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Generally and following ETSI standard, the validation process of an electronic signature must provide one of the three following status: TOTAL-FAILED, TOTAL-PASSED or INDETERMINATE. A TOTAL-PASSED response indicates that the signature has passed verification and it complies with the signature validation policy. An TOTAL_FAILED response indicates that either the signature format is incorrect or that the digital signature value fails verification. An INDETERMINATE validation response indicates that the format and digital signature verifications have not failed but there is insufficient information to determine if the electronic signature is valid. For each of the validation checks, the validation process must provide information justifying the reasons for the resulting status indication as a result of the check against the applicable constraints. In addition, the ETSI standard defines a consistent and accurate way for justifying statuses under a set of sub-indications.</p>
</div>
<div class="sect2">
<h3 id="_validation_process"><a class="anchor" href="#_validation_process"></a>Validation Process</h3>
<div class="paragraph">
<p>Since version 4.7 of the DSS framework the validation process is based on the latest ETSI standard <a href="#R08">[R08]</a>. It is driven by the validation policy and allows long term signature validation. It not only verifies the existence of certain data and their validity, but it also checks the temporal dependences between these elements. The signature check is done following basic building blocks. On the simplified diagram below, showing the process of the signature validation, you can follow the relationships between each building block which represents a logic set of checks used in validation process.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/sig_validation_process.jpg" alt="sig validation process">
</div>
</div>
<div class="paragraph">
<p>Note that the current version of the framework during the validation process does not indicate what part of document was signed. However, in the case of the XAdES signature XPath transformations present in the signature will be applied, in the case of CAdES or PAdES signature the whole document must be signed.</p>
</div>
<div class="paragraph">
<p>At the end of the validation process three reports are created. They contain the different details level concerning the validation result. They provide three kinds of visions of validation process: macroscopic, microscopic and input data. For more information about these reports, please refer to "Simple Report" chapter.</p>
</div>
<div class="paragraph">
<p>Below is the simplest example of the validation of the signature of a document. The first thing to do is instantiating an object named validator, which orchestrates the verification of the different rules. To perform this it is necessary to invoke a static method fromDocument() on the abstract class SignedDocumentValidator. This method returns the object in question whose type is chosen dynamically based on the type of source document. The DSS framework provides five types of validators:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>XMLDocumentValidator,</p>
</li>
<li>
<p>CMSDocumentValidator,</p>
</li>
<li>
<p>PDFDocumentValidator,</p>
</li>
<li>
<p>ASiCContainerWithXAdESValidator,</p>
</li>
<li>
<p>ASiCContainerWithCAdESValidator.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The next step is to create an object that will check the status of a certificate using the Trusted List model (see "Trusted Lists of Certification Service Provider" for more information). In our example, this object is instantiated from the TrustedListCertificateVerifier class. In turn, this object needs an OCSP and/or CRL source and a TSL source (which defines how the certificates are retrieved from the Trusted Lists). See chapter "Management of CRL and OCSP Sources" for more information concerning sources.</p>
</div>
<div class="listingblock">
<div class="title">Validation of a signature</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// First, we need a Certificate verifier</span>
CertificateVerifier cv = <span class="keyword">new</span> CommonCertificateVerifier();

<span class="comment">// We can inject several sources. eg: OCSP, CRL, AIA, trusted lists</span>

<span class="comment">// Capability to download resources from AIA</span>
cv.setDataLoader(<span class="keyword">new</span> CommonsDataLoader());

<span class="comment">// Capability to request OCSP Responders</span>
cv.setOcspSource(<span class="keyword">new</span> OnlineOCSPSource());

<span class="comment">// Capability to download CRL</span>
cv.setCrlSource(<span class="keyword">new</span> OnlineCRLSource());

<span class="comment">// We now add trust anchors (trusted list, keystore,...)</span>
cv.setTrustedCertSource(trustedCertSource);

<span class="comment">// We also can add missing certificates</span>
cv.setAdjunctCertSource(adjunctCertSource);

<span class="comment">// Here is the document to be validated (any kind of signature file)</span>
DSSDocument document = <span class="keyword">new</span> FileDocument(<span class="keyword">new</span> <span class="predefined-type">File</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">src/test/resources/signedXmlXadesLT.xml</span><span class="delimiter">&quot;</span></span>));

<span class="comment">// We create an instance of DocumentValidator</span>
<span class="comment">// It will automatically select the supported validator from the classpath</span>
SignedDocumentValidator documentValidator = SignedDocumentValidator.fromDocument(document);

<span class="comment">// We add the certificate verifier (which allows to verify and trust certificates)</span>
documentValidator.setCertificateVerifier(cv);

<span class="comment">// Here, everything is ready. We can execute the validation (for the example, we use the default and embedded</span>
<span class="comment">// validation policy)</span>
Reports reports = documentValidator.validateDocument();

<span class="comment">// We have 3 reports</span>
<span class="comment">// The diagnostic data which contains all used and static data</span>
DiagnosticData diagnosticData = reports.getDiagnosticData();

<span class="comment">// The detailed report which is the result of the process of the diagnostic data and the validation policy</span>
DetailedReport detailedReport = reports.getDetailedReport();

<span class="comment">// The simple report is a summary of the detailed report (more user-friendly)</span>
SimpleReport simpleReport = reports.getSimpleReport();</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
When using the TrustedListsCertificateSource class, for performance reasons, consider creating a single instance of this class and initialize it only once.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In general, the signature must cover the entire document so that the DSS framework can validate it. However, for example in the case of a XAdES signature, some transformations can be applied on the XML document. They can include operations such as canonicalization, encoding/decoding, XSLT, XPath, XML schema validation, or XInclude. XPath transforms permit the signer to derive an XML document that omits portions of the source document. Consequently those excluded portions can change without affecting signature validity.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_eu_trusted_lists_of_certification_service_providers"><a class="anchor" href="#_eu_trusted_lists_of_certification_service_providers"></a>EU Trusted Lists of Certification Service Providers</h3>
<div class="paragraph">
<p>On 16 October 2009 the European Commission adopted a Decision setting out measures facilitating the use of procedures by electronic means through the "points of single contact" under the Services Directive. One of the measures adopted by the Decision consisted in the obligation for Member States to establish and publish by 28.12.2009 their Trusted List of supervised/accredited certification service providers issuing qualified certificates to the public. The objective of this obligation is to enhance cross-border use of electronic signatures by increasing trust in electronic signatures originating from other Member States. The Decision was updated several times since 16.10.2009; the last amendment was made on 01.02.2014. The consolidated version is available here for information.</p>
</div>
<div class="paragraph">
<p>In order to allow access to the trusted lists of all Member States in an easy manner, the European Commission has published a central list with links to national "trusted lists". This central list will now be designated in the document under the abbreviation LOTL.</p>
</div>
<div class="paragraph">
<p>The LOTL is published by the EU at the following URL : <a href="https://ec.europa.eu/information_society/policy/esignature/trusted-list/tl-mp.xml" class="bare">https://ec.europa.eu/information_society/policy/esignature/trusted-list/tl-mp.xml</a>. This XML file contains the list of the trusted list. This file must be signed by an allowed certificate. To know who has the permission to sign / publish the LOTL, we need to refer to the Official Journal Of the Union (<a href="http://eur-lex.europa.eu/legal-content/EN/TXT/?uri=uriserv:OJ.C_.2016.233.01.0001.01.ENG" class="bare">http://eur-lex.europa.eu/legal-content/EN/TXT/?uri=uriserv:OJ.C_.2016.233.01.0001.01.ENG</a>).</p>
</div>
<div class="paragraph">
<p>The signature format of the LOTL and TL should be XAdES-BASELINE-B. If the LOTL signature is valid, its content can be trusted. The LOTL contains for each country some information : urls of the XML/PDF files, the allowed certificates to sign, &#8230;&#8203;</p>
</div>
<div class="paragraph">
<p>So, we trusted the LOTL, we can process each trusted list. If they are valid, we can trust the service providers and its certificates.</p>
</div>
<div class="paragraph">
<p>To build the source of trust, DSS requires :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the LOTL url (XML);</p>
</li>
<li>
<p>the LOTL country code;</p>
</li>
<li>
<p>a trust store which contains allowed certificates (extracted from the OJ).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Below, you can find a complete example to load the LOTL and its linked TLs.</p>
</div>
<div class="listingblock">
<div class="title">Configuration to load the LOTL and related TLs</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">TSLRepository tslRepository = <span class="keyword">new</span> TSLRepository();

TrustedListsCertificateSource certificateSource = <span class="keyword">new</span> TrustedListsCertificateSource();
tslRepository.setTrustedListsCertificateSource(certificateSource);

TSLValidationJob job = <span class="keyword">new</span> TSLValidationJob();
job.setDataLoader(<span class="keyword">new</span> CommonsDataLoader());
job.setCheckLOTLSignature(<span class="predefined-constant">true</span>);
job.setCheckTSLSignatures(<span class="predefined-constant">true</span>);
job.setLotlUrl(<span class="string"><span class="delimiter">&quot;</span><span class="content">https://ec.europa.eu/information_society/policy/esignature/trusted-list/tl-mp.xml</span><span class="delimiter">&quot;</span></span>);
job.setLotlCode(<span class="string"><span class="delimiter">&quot;</span><span class="content">EU</span><span class="delimiter">&quot;</span></span>);

<span class="comment">// This information is needed to be able to filter the LOTL pivots</span>
job.setLotlRootSchemeInfoUri(<span class="string"><span class="delimiter">&quot;</span><span class="content">https://ec.europa.eu/information_society/policy/esignature/trusted-list/tl.html</span><span class="delimiter">&quot;</span></span>);

<span class="comment">// The keystore contains certificates referenced in the Official Journal Link (OJ URL)</span>
KeyStoreCertificateSource keyStoreCertificateSource = <span class="keyword">new</span> KeyStoreCertificateSource(<span class="keyword">new</span> <span class="predefined-type">File</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">src/main/resources/keystore.p12</span><span class="delimiter">&quot;</span></span>), <span class="string"><span class="delimiter">&quot;</span><span class="content">PKCS12</span><span class="delimiter">&quot;</span></span>,
                <span class="string"><span class="delimiter">&quot;</span><span class="content">dss-password</span><span class="delimiter">&quot;</span></span>);
job.setOjUrl(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://eur-lex.europa.eu/legal-content/EN/TXT/?uri=uriserv:OJ.C_.2016.233.01.0001.01.ENG</span><span class="delimiter">&quot;</span></span>);
job.setOjContentKeyStore(keyStoreCertificateSource);

job.setRepository(tslRepository);

job.refresh();</code></pre>
</div>
</div>
<div class="paragraph">
<p>The TrustedListsCertificateSource is updated with the trusted certificates.</p>
</div>
<div class="paragraph">
<p>To generate the trust store, there&#8217;s an utility class CreateKeyStoreApp in the dss-cookbook module.</p>
</div>
<div class="sect3">
<h4 id="_non_european_trusted_lists_support"><a class="anchor" href="#_non_european_trusted_lists_support"></a>Non-European trusted lists support</h4>
<div class="paragraph">
<p>Additionally, DSS can load external trusted lists. These trusted lists are checked against their trust store (keystore which contains the authorized TL signers).</p>
</div>
<div class="listingblock">
<div class="title">Handling of Non-European trusted list(s)</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">TSLValidationJob job = <span class="keyword">new</span> TSLValidationJob();
<span class="comment">// ...</span>

<span class="comment">// Configuration to load the peruvian trusted list.</span>
<span class="comment">// DSS requires the country code, the URL and allowed signing certificates</span>
OtherTrustedList peru = <span class="keyword">new</span> OtherTrustedList();
peru.setCountryCode(<span class="string"><span class="delimiter">&quot;</span><span class="content">PE</span><span class="delimiter">&quot;</span></span>);
peru.setUrl(<span class="string"><span class="delimiter">&quot;</span><span class="content">https://iofe.indecopi.gob.pe/TSL/tsl-pe.xml</span><span class="delimiter">&quot;</span></span>);
peru.setTrustStore(getTrustStore());

job.setOtherTrustedLists(<span class="predefined-type">Arrays</span>.asList(peru));</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_validation_result_materials"><a class="anchor" href="#_validation_result_materials"></a>Validation Result Materials</h3>
<div class="paragraph">
<p>The result of the validation process consists of three elements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the simple report,</p>
</li>
<li>
<p>the detailed report and,</p>
</li>
<li>
<p>the diagnostic data.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All these reports are encoded using XML, which allows the implementer to easily manipulate and extract information for further analysis. For each report, XML Schema and JaxB model are available as maven dependencies.</p>
</div>
<div class="paragraph">
<p>DSS also provides XSLT to able to generate PDF or HTML reports (simple and detailed reports).</p>
</div>
<div class="paragraph">
<p>You will find below a detailed description of each of these elements.</p>
</div>
<div class="sect3">
<h4 id="_simple_report"><a class="anchor" href="#_simple_report"></a>Simple Report</h4>
<div class="paragraph">
<p>This is a sample of the simple validation report.</p>
</div>
<div class="listingblock">
<div class="title">Simple Report</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;SimpleReport</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://dss.esig.europa.eu/validation/simple-report</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;Policy&gt;</span>
        <span class="tag">&lt;PolicyName&gt;</span>QES AdESQC TL based<span class="tag">&lt;/PolicyName&gt;</span>
        <span class="tag">&lt;PolicyDescription&gt;</span>Validate electronic signatures and indicates whether they are Advanced electronic Signatures (AdES), AdES supported by a Qualified Certificate (AdES/QC) or a
                Qualified electronic Signature (QES). All certificates and their related chains supporting the signatures are validated against the EU Member State Trusted Lists (this includes
                signer's certificate and certificates used to validate certificate validity status services - CRLs, OCSP, and time-stamps).
        <span class="tag">&lt;/PolicyDescription&gt;</span>
    <span class="tag">&lt;/Policy&gt;</span>
    <span class="tag">&lt;ValidationTime&gt;</span>2018-02-23T05:50:46<span class="tag">&lt;/ValidationTime&gt;</span>
    <span class="tag">&lt;DocumentName&gt;</span>testdocument.pdf<span class="tag">&lt;/DocumentName&gt;</span>
    <span class="tag">&lt;ValidSignaturesCount&gt;</span>1<span class="tag">&lt;/ValidSignaturesCount&gt;</span>
    <span class="tag">&lt;SignaturesCount&gt;</span>1<span class="tag">&lt;/SignaturesCount&gt;</span>
    <span class="tag">&lt;Signature</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">id-2056753e8b67ab9c96a6fe80ec9f619f8e9b4505b66b078c7a2b6e151edc2bbb</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">SignatureFormat</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">PAdES-BASE-LTA</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;SigningTime&gt;</span>2017-10-27T11:54:56<span class="tag">&lt;/SigningTime&gt;</span>
        <span class="tag">&lt;BestSignatureTime&gt;</span>2017-10-27T11:55:08<span class="tag">&lt;/BestSignatureTime&gt;</span>
        <span class="tag">&lt;SignedBy&gt;</span>E Van R (Signature)<span class="tag">&lt;/SignedBy&gt;</span>
        <span class="tag">&lt;CertificateChain&gt;</span>
            <span class="tag">&lt;Certificate&gt;</span>
                <span class="tag">&lt;id&gt;</span>021EC5069EB8A903BD62B6769EDDFE439DFA90A720C9A362D5FE76B9C31D0302<span class="tag">&lt;/id&gt;</span>
                <span class="tag">&lt;qualifiedName&gt;</span>E Van R (Signature)<span class="tag">&lt;/qualifiedName&gt;</span>
            <span class="tag">&lt;/Certificate&gt;</span>
            <span class="tag">&lt;Certificate&gt;</span>
                <span class="tag">&lt;id&gt;</span>80AC352930875BA0AFE7F70DD389130C8E1E7BEFFDC96477356AD2A9E003AD2B<span class="tag">&lt;/id&gt;</span>
                <span class="tag">&lt;qualifiedName&gt;</span>Citizen CA<span class="tag">&lt;/qualifiedName&gt;</span>
            <span class="tag">&lt;/Certificate&gt;</span>
            <span class="tag">&lt;Certificate&gt;</span>
                <span class="tag">&lt;id&gt;</span>702DD5C1A093CF0A9D71FADD9BF9A7C5857D89FB73B716E867228B3C2BEB968F<span class="tag">&lt;/id&gt;</span>
                <span class="tag">&lt;qualifiedName&gt;</span>Belgium Root CA4<span class="tag">&lt;/qualifiedName&gt;</span>
            <span class="tag">&lt;/Certificate&gt;</span>
        <span class="tag">&lt;/CertificateChain&gt;</span>
        <span class="tag">&lt;SignatureLevel</span> <span class="attribute-name">description</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Qualified Electronic Signature</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>QESig<span class="tag">&lt;/SignatureLevel&gt;</span>
        <span class="tag">&lt;Indication&gt;</span>TOTAL_PASSED<span class="tag">&lt;/Indication&gt;</span>
        <span class="tag">&lt;SignatureScope</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">PDF previous version #1</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">scope</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">PdfByteRangeSignatureScope</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>The document byte range: [0, 9258, 32602, 495939]<span class="tag">&lt;/SignatureScope&gt;</span>
    <span class="tag">&lt;/Signature&gt;</span>
<span class="tag">&lt;/SimpleReport&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The result of the validation process is based on very complex rules. The purpose of this report is to make as simple as possible the information while keeping the most important elements. Thus the end user can, at a glance, have a synthetic view of the validation. To build this report the framework uses some simple rules and the detailed report as input.</p>
</div>
</div>
<div class="sect3">
<h4 id="_detailed_report"><a class="anchor" href="#_detailed_report"></a>Detailed Report</h4>
<div class="paragraph">
<p>This is a sample of the detailed validation report. Its structure is based on the ETSI standard <a href="#R08">[R08]</a> and is built around Basic Building Blocks, Basic Validation Data, Timestamp Validation Data, AdES-T Validation Data and Long Term Validation Data. Some segments were deleted to make reading easier. They are marked by three dots:</p>
</div>
<div class="listingblock">
<div class="title">Detailed Report</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;DetailedReport</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://dss.esig.europa.eu/validation/detailed-report</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;Signatures</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">id-2056753e8b67ab9c96a6fe80ec9f619f8e9b4505b66b078c7a2b6e151edc2bbb</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;ValidationProcessBasicSignatures</span> <span class="attribute-name">BestSignatureTime</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">2018-02-23T05:50:46</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;Constraint</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">id-2056753e8b67ab9c96a6fe80ec9f619f8e9b4505b66b078c7a2b6e151edc2bbb</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;Name</span> <span class="attribute-name">NameId</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">ADEST_ROBVPIIC</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>Is the result of the Basic Validation Process conclusive?<span class="tag">&lt;/Name&gt;</span>
                <span class="tag">&lt;Status&gt;</span>OK<span class="tag">&lt;/Status&gt;</span>
            <span class="tag">&lt;/Constraint&gt;</span>
            <span class="tag">&lt;Conclusion&gt;</span>
                <span class="tag">&lt;Indication&gt;</span>PASSED<span class="tag">&lt;/Indication&gt;</span>
            <span class="tag">&lt;/Conclusion&gt;</span>
        <span class="tag">&lt;/ValidationProcessBasicSignatures&gt;</span>
        <span class="tag">&lt;ValidationProcessTimestamps</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">F8B72B7574450E84664DE88950BC781CA2528CF5B39ABB3E1F93947B752BE79F</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">Type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">SIGNATURE_TIMESTAMP</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">ProductionTime</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">2017-10-27T11:55:08</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;Constraint</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">F8B72B7574450E84664DE88950BC781CA2528CF5B39ABB3E1F93947B752BE79F</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;Name</span> <span class="attribute-name">NameId</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">ADEST_ROTVPIIC</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>Is the result of the timestamps validation process conclusive?<span class="tag">&lt;/Name&gt;</span>
                <span class="tag">&lt;Status&gt;</span>OK<span class="tag">&lt;/Status&gt;</span>
            <span class="tag">&lt;/Constraint&gt;</span>
            <span class="tag">&lt;Conclusion&gt;</span>
                <span class="tag">&lt;Indication&gt;</span>PASSED<span class="tag">&lt;/Indication&gt;</span>
            <span class="tag">&lt;/Conclusion&gt;</span>
        <span class="tag">&lt;/ValidationProcessTimestamps&gt;</span>
        <span class="tag">&lt;ValidationProcessTimestamps</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">7F9B88A8161CC87905298FF8E0CD080516452FBA1480DD6AFAE38B7DD18E2A1B</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">Type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">ARCHIVE_TIMESTAMP</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">ProductionTime</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">2017-10-27T11:55:08</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;Constraint</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">7F9B88A8161CC87905298FF8E0CD080516452FBA1480DD6AFAE38B7DD18E2A1B</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;Name</span> <span class="attribute-name">NameId</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">ADEST_ROTVPIIC</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>Is the result of the timestamps validation process conclusive?<span class="tag">&lt;/Name&gt;</span>
                <span class="tag">&lt;Status&gt;</span>OK<span class="tag">&lt;/Status&gt;</span>
            <span class="tag">&lt;/Constraint&gt;</span>
            <span class="tag">&lt;Conclusion&gt;</span>
                <span class="tag">&lt;Indication&gt;</span>PASSED<span class="tag">&lt;/Indication&gt;</span>
            <span class="tag">&lt;/Conclusion&gt;</span>
        <span class="tag">&lt;/ValidationProcessTimestamps&gt;</span>
        <span class="tag">&lt;ValidationProcessLongTermData</span> <span class="attribute-name">BestSignatureTime</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">2017-10-27T11:55:08</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;Constraint&gt;</span>
                ...
            <span class="tag">&lt;/Constraint&gt;</span>
            <span class="tag">&lt;Conclusion&gt;</span>
                <span class="tag">&lt;Indication&gt;</span>PASSED<span class="tag">&lt;/Indication&gt;</span>
            <span class="tag">&lt;/Conclusion&gt;</span>
        <span class="tag">&lt;/ValidationProcessLongTermData&gt;</span>
        <span class="tag">&lt;ValidationProcessArchivalData</span> <span class="attribute-name">BestSignatureTime</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">2017-10-27T11:55:08</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;Constraint&gt;</span>
                ...
            <span class="tag">&lt;/Constraint&gt;</span>
            <span class="tag">&lt;Conclusion&gt;</span>
                <span class="tag">&lt;Indication&gt;</span>PASSED<span class="tag">&lt;/Indication&gt;</span>
            <span class="tag">&lt;/Conclusion&gt;</span>
        <span class="tag">&lt;/ValidationProcessArchivalData&gt;</span>
        <span class="tag">&lt;ValidationSignatureQualification</span> <span class="attribute-name">SignatureQualification</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">QESig</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;Constraint&gt;</span>
                ...
            <span class="tag">&lt;/Constraint&gt;</span>
            <span class="tag">&lt;Conclusion&gt;</span>
                <span class="tag">&lt;Indication&gt;</span>PASSED<span class="tag">&lt;/Indication&gt;</span>
            <span class="tag">&lt;/Conclusion&gt;</span>
            <span class="tag">&lt;ValidationCertificateQualification</span> <span class="attribute-name">DateTime</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">2017-05-15T16:19:53</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">ValidationTime</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">CERTIFICATE_ISSUANCE_TIME</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">CertificateQualification</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">QC Cert for ESig with QSCD</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;Constraint&gt;</span>
                    ...
                <span class="tag">&lt;/Constraint&gt;</span>
                <span class="tag">&lt;Conclusion&gt;</span>
                    <span class="tag">&lt;Indication&gt;</span>PASSED<span class="tag">&lt;/Indication&gt;</span>
                <span class="tag">&lt;/Conclusion&gt;</span>
            <span class="tag">&lt;/ValidationCertificateQualification&gt;</span>
            <span class="tag">&lt;ValidationCertificateQualification</span> <span class="attribute-name">DateTime</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">2017-10-27T11:55:08</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">ValidationTime</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">BEST_SIGNATURE_TIME</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">CertificateQualification</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">QC Cert for ESig with QSCD</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;Constraint&gt;</span>
                    ...
                <span class="tag">&lt;/Constraint&gt;</span>
                <span class="tag">&lt;Conclusion&gt;</span>
                    <span class="tag">&lt;Indication&gt;</span>PASSED<span class="tag">&lt;/Indication&gt;</span>
                <span class="tag">&lt;/Conclusion&gt;</span>
            <span class="tag">&lt;/ValidationCertificateQualification&gt;</span>
        <span class="tag">&lt;/ValidationSignatureQualification&gt;</span>
    <span class="tag">&lt;/Signatures&gt;</span>
    <span class="tag">&lt;BasicBuildingBlocks</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">021ec5069eb8a903bd62b6769eddfe439dfa90a720c9a362d5fe76b9c31d0302bfc08d553a774d1f440ab36525a3290e2cc23b46d0ac954ea4d8201faff0d91a</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">Type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">REVOCATION</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;ISC&gt;</span>
            <span class="tag">&lt;Constraint&gt;</span>
                                ...
            <span class="tag">&lt;/Constraint&gt;</span>
            <span class="tag">&lt;Conclusion&gt;</span>
                <span class="tag">&lt;Indication&gt;</span>PASSED<span class="tag">&lt;/Indication&gt;</span>
            <span class="tag">&lt;/Conclusion&gt;</span>
        <span class="tag">&lt;/ISC&gt;</span>
        <span class="tag">&lt;CV&gt;</span>
            <span class="tag">&lt;Constraint&gt;</span>
                ...
            <span class="tag">&lt;/Constraint&gt;</span>
            <span class="tag">&lt;Conclusion&gt;</span>
                <span class="tag">&lt;Indication&gt;</span>PASSED<span class="tag">&lt;/Indication&gt;</span>
            <span class="tag">&lt;/Conclusion&gt;</span>
        <span class="tag">&lt;/CV&gt;</span>
        <span class="tag">&lt;SAV&gt;</span>
            <span class="tag">&lt;Constraint&gt;</span>
                ...
            <span class="tag">&lt;/Constraint&gt;</span>
            <span class="tag">&lt;Conclusion&gt;</span>
                <span class="tag">&lt;Indication&gt;</span>PASSED<span class="tag">&lt;/Indication&gt;</span>
            <span class="tag">&lt;/Conclusion&gt;</span>
        <span class="tag">&lt;/SAV&gt;</span>
        <span class="tag">&lt;XCV&gt;</span>
            <span class="tag">&lt;Constraint&gt;</span>
                ...
            <span class="tag">&lt;/Constraint&gt;</span>
            <span class="tag">&lt;Conclusion&gt;</span>
                <span class="tag">&lt;Indication&gt;</span>INDETERMINATE<span class="tag">&lt;/Indication&gt;</span>
                <span class="tag">&lt;SubIndication&gt;</span>OUT_OF_BOUNDS_NO_POE<span class="tag">&lt;/SubIndication&gt;</span>
                <span class="tag">&lt;Errors</span> <span class="attribute-name">NameId</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">BBB_XCV_ICTIVRSC_ANS</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>The current time is not in the validity range of the signer's certificate.<span class="tag">&lt;/Errors&gt;</span>
            <span class="tag">&lt;/Conclusion&gt;</span>
            <span class="tag">&lt;SubXCV</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">CB217219BADFC13B4FEA3EFA43882E9FECE49E542DCDBA83428DC6854499A35F</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">TrustAnchor</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">false</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                ...
            <span class="tag">&lt;/SubXCV&gt;</span>
            <span class="tag">&lt;SubXCV</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">80AC352930875BA0AFE7F70DD389130C8E1E7BEFFDC96477356AD2A9E003AD2B</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">TrustAnchor</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">false</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                ...
            <span class="tag">&lt;/SubXCV&gt;</span>
            <span class="tag">&lt;SubXCV</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">702DD5C1A093CF0A9D71FADD9BF9A7C5857D89FB73B716E867228B3C2BEB968F</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">TrustAnchor</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
               ...
            <span class="tag">&lt;/SubXCV&gt;</span>
        <span class="tag">&lt;/XCV&gt;</span>
        <span class="tag">&lt;CertificateChain&gt;</span>
            ...
        <span class="tag">&lt;/CertificateChain&gt;</span>
        <span class="tag">&lt;Conclusion&gt;</span>
            <span class="tag">&lt;Indication&gt;</span>INDETERMINATE<span class="tag">&lt;/Indication&gt;</span>
            <span class="tag">&lt;SubIndication&gt;</span>OUT_OF_BOUNDS_NO_POE<span class="tag">&lt;/SubIndication&gt;</span>
            <span class="tag">&lt;Errors</span> <span class="attribute-name">NameId</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">BBB_XCV_ICTIVRSC_ANS</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>The current time is not in the validity range of the signer's certificate.<span class="tag">&lt;/Errors&gt;</span>
        <span class="tag">&lt;/Conclusion&gt;</span>
    <span class="tag">&lt;/BasicBuildingBlocks&gt;</span>
    <span class="tag">&lt;BasicBuildingBlocks</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">id-2056753e8b67ab9c96a6fe80ec9f619f8e9b4505b66b078c7a2b6e151edc2bbb</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">Type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">SIGNATURE</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;FC&gt;</span>
            <span class="tag">&lt;Constraint&gt;</span>
                ...
            <span class="tag">&lt;/Constraint&gt;</span>
            <span class="tag">&lt;Conclusion&gt;</span>
                <span class="tag">&lt;Indication&gt;</span>PASSED<span class="tag">&lt;/Indication&gt;</span>
            <span class="tag">&lt;/Conclusion&gt;</span>
        <span class="tag">&lt;/FC&gt;</span>
        <span class="tag">&lt;ISC&gt;</span>
            <span class="tag">&lt;Constraint&gt;</span>
                ...
            <span class="tag">&lt;/Constraint&gt;</span>
            <span class="tag">&lt;Conclusion&gt;</span>
                <span class="tag">&lt;Indication&gt;</span>PASSED<span class="tag">&lt;/Indication&gt;</span>
            <span class="tag">&lt;/Conclusion&gt;</span>
            <span class="tag">&lt;CertificateChain&gt;</span>
                <span class="tag">&lt;ChainItem</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">021EC5069EB8A903BD62B6769EDDFE439DFA90A720C9A362D5FE76B9C31D0302</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                    <span class="tag">&lt;Source&gt;</span>UNKNOWN<span class="tag">&lt;/Source&gt;</span>
                <span class="tag">&lt;/ChainItem&gt;</span>
                <span class="tag">&lt;ChainItem</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">80AC352930875BA0AFE7F70DD389130C8E1E7BEFFDC96477356AD2A9E003AD2B</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                    <span class="tag">&lt;Source&gt;</span>UNKNOWN<span class="tag">&lt;/Source&gt;</span>
                <span class="tag">&lt;/ChainItem&gt;</span>
                <span class="tag">&lt;ChainItem</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">702DD5C1A093CF0A9D71FADD9BF9A7C5857D89FB73B716E867228B3C2BEB968F</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                    <span class="tag">&lt;Source&gt;</span>TRUSTED_LIST<span class="tag">&lt;/Source&gt;</span>
                <span class="tag">&lt;/ChainItem&gt;</span>
            <span class="tag">&lt;/CertificateChain&gt;</span>
        <span class="tag">&lt;/ISC&gt;</span>
        <span class="tag">&lt;VCI&gt;</span>
            <span class="tag">&lt;Constraint&gt;</span>
                <span class="tag">&lt;Name</span> <span class="attribute-name">NameId</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">BBB_VCI_ISPK</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>Is the signature policy known?<span class="tag">&lt;/Name&gt;</span>
                <span class="tag">&lt;Status&gt;</span>OK<span class="tag">&lt;/Status&gt;</span>
            <span class="tag">&lt;/Constraint&gt;</span>
            <span class="tag">&lt;Conclusion&gt;</span>
                <span class="tag">&lt;Indication&gt;</span>PASSED<span class="tag">&lt;/Indication&gt;</span>
            <span class="tag">&lt;/Conclusion&gt;</span>
        <span class="tag">&lt;/VCI&gt;</span>
        <span class="tag">&lt;CV&gt;</span>
            <span class="tag">&lt;Constraint&gt;</span>
                ...
            <span class="tag">&lt;/Constraint&gt;</span>
            <span class="tag">&lt;Conclusion&gt;</span>
                <span class="tag">&lt;Indication&gt;</span>PASSED<span class="tag">&lt;/Indication&gt;</span>
            <span class="tag">&lt;/Conclusion&gt;</span>
        <span class="tag">&lt;/CV&gt;</span>
        <span class="tag">&lt;SAV&gt;</span>
            <span class="tag">&lt;Constraint&gt;</span>
                ...
            <span class="tag">&lt;/Constraint&gt;</span>
            <span class="tag">&lt;Conclusion&gt;</span>
                <span class="tag">&lt;Indication&gt;</span>PASSED<span class="tag">&lt;/Indication&gt;</span>
            <span class="tag">&lt;/Conclusion&gt;</span>
        <span class="tag">&lt;/SAV&gt;</span>
        <span class="tag">&lt;XCV&gt;</span>
            ...
        <span class="tag">&lt;/XCV&gt;</span>
        <span class="tag">&lt;CertificateChain&gt;</span>
            ...
        <span class="tag">&lt;/CertificateChain&gt;</span>
        <span class="tag">&lt;Conclusion&gt;</span>
            <span class="tag">&lt;Indication&gt;</span>PASSED<span class="tag">&lt;/Indication&gt;</span>
        <span class="tag">&lt;/Conclusion&gt;</span>
    <span class="tag">&lt;/BasicBuildingBlocks&gt;</span>
    <span class="tag">&lt;BasicBuildingBlocks</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">F8B72B7574450E84664DE88950BC781CA2528CF5B39ABB3E1F93947B752BE79F</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">Type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">TIMESTAMP</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        ...
    <span class="tag">&lt;/BasicBuildingBlocks&gt;</span>
    <span class="tag">&lt;BasicBuildingBlocks</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">ee3c22e06087bfec213709ad3e7f2dda9ce9d19ce238dca81a6433e9070a9fbee7a38824e892663bfaa50ba2edf0f5bfb5437dbeb73af1c9fec79b6ce77df88d</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">Type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">REVOCATION</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        ...
    <span class="tag">&lt;/BasicBuildingBlocks&gt;</span>
    <span class="tag">&lt;BasicBuildingBlocks</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">7F9B88A8161CC87905298FF8E0CD080516452FBA1480DD6AFAE38B7DD18E2A1B</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">Type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">TIMESTAMP</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        ...
    <span class="tag">&lt;/BasicBuildingBlocks&gt;</span>
    <span class="tag">&lt;BasicBuildingBlocks</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">80ac352930875ba0afe7f70dd389130c8e1e7beffdc96477356ad2a9e003ad2be7a38824e892663bfaa50ba2edf0f5bfb5437dbeb73af1c9fec79b6ce77df88d</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">Type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">REVOCATION</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        ...
    <span class="tag">&lt;/BasicBuildingBlocks&gt;</span>
    <span class="tag">&lt;TLAnalysis</span> <span class="attribute-name">CountryCode</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">EU</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;Constraint&gt;</span>
                  ...
        <span class="tag">&lt;/Constraint&gt;</span>
        <span class="tag">&lt;Conclusion&gt;</span>
            <span class="tag">&lt;Indication&gt;</span>PASSED<span class="tag">&lt;/Indication&gt;</span>
        <span class="tag">&lt;/Conclusion&gt;</span>
    <span class="tag">&lt;/TLAnalysis&gt;</span>
    <span class="tag">&lt;TLAnalysis</span> <span class="attribute-name">CountryCode</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">BE</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;Constraint&gt;</span>
                  ...
        <span class="tag">&lt;/Constraint&gt;</span>
        <span class="tag">&lt;Conclusion&gt;</span>
            <span class="tag">&lt;Indication&gt;</span>PASSED<span class="tag">&lt;/Indication&gt;</span>
        <span class="tag">&lt;/Conclusion&gt;</span>
    <span class="tag">&lt;/TLAnalysis&gt;</span>
<span class="tag">&lt;/DetailedReport&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>For example the Basic Building Blocks are divided into seven elements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>FC - Format Checking</p>
</li>
<li>
<p>ISC - Identification of the Signing Certificate</p>
</li>
<li>
<p>VCI - Validation Context Initialization</p>
</li>
<li>
<p>RFC - Revocation Freshness Checker</p>
</li>
<li>
<p>XCV - X.509 certificate validation</p>
</li>
<li>
<p>CV - Cryptographic Verification</p>
</li>
<li>
<p>SAV - Signature Acceptance Validation</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following additional elements also can be execute in case of validation in the past :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>PCV - Past Certificate Validation</p>
</li>
<li>
<p>VTS - Validation Time Sliding process</p>
</li>
<li>
<p>POE extraction - Proof Of Existence extraction</p>
</li>
<li>
<p>PSV - Past Signature Validation</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each block contains a number of rules that are executed sequentially. The rules are driven by the constraints defined in the validation policy. The result of each rule is OK or NOT OK. The process is stopped when the first rule fails. Each block also contains a conclusion. If all rules are met then the conclusion node indicates PASSED. Otherwise FAILED or INDETERMINATE indication is returned depending on the ETSI standard definition.</p>
</div>
</div>
<div class="sect3">
<h4 id="_diagnostic_data"><a class="anchor" href="#_diagnostic_data"></a>Diagnostic Data</h4>
<div class="paragraph">
<p>This is a data set constructed from the information contained in the signature itself, but also from information retrieved dynamically as revocation data and information extrapolated as the mathematical validity of a signature. All this information is independent of the applied validation policy. Two different validation policies applied to the same diagnostic data can lead to different results.</p>
</div>
<div class="paragraph">
<p>This is an example of the diagnostic data for a PAdES signature. Certain fields and certain values were trimmed or deleted to make reading easier:</p>
</div>
<div class="listingblock">
<div class="title">Diagnostic Data</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;DiagnosticData</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://dss.esig.europa.eu/validation/diagnostic</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;DocumentName&gt;</span>testdocument.pdf<span class="tag">&lt;/DocumentName&gt;</span>
    <span class="tag">&lt;ValidationDate&gt;</span>2018-02-23T05:50:46<span class="tag">&lt;/ValidationDate&gt;</span>
    <span class="tag">&lt;Signatures&gt;</span>
        <span class="tag">&lt;Signature</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">id-2056753e8b67ab9c96a6fe80ec9f619f8e9b4505b66b078c7a2b6e151edc2bbb</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;SignatureFilename&gt;</span>testdocument.pdf<span class="tag">&lt;/SignatureFilename&gt;</span>
            <span class="tag">&lt;DateTime&gt;</span>2017-10-27T11:54:56<span class="tag">&lt;/DateTime&gt;</span>
            <span class="tag">&lt;SignatureFormat&gt;</span>PAdES-BASE-LTA<span class="tag">&lt;/SignatureFormat&gt;</span>
            <span class="tag">&lt;StructuralValidation&gt;</span>
                <span class="tag">&lt;Valid&gt;</span>true<span class="tag">&lt;/Valid&gt;</span>
            <span class="tag">&lt;/StructuralValidation&gt;</span>
            <span class="tag">&lt;BasicSignature&gt;</span>
                <span class="tag">&lt;EncryptionAlgoUsedToSignThisToken&gt;</span>RSA<span class="tag">&lt;/EncryptionAlgoUsedToSignThisToken&gt;</span>
                <span class="tag">&lt;KeyLengthUsedToSignThisToken&gt;</span>2048<span class="tag">&lt;/KeyLengthUsedToSignThisToken&gt;</span>
                <span class="tag">&lt;DigestAlgoUsedToSignThisToken&gt;</span>SHA256<span class="tag">&lt;/DigestAlgoUsedToSignThisToken&gt;</span>
                <span class="tag">&lt;ReferenceDataFound&gt;</span>true<span class="tag">&lt;/ReferenceDataFound&gt;</span>
                <span class="tag">&lt;ReferenceDataIntact&gt;</span>true<span class="tag">&lt;/ReferenceDataIntact&gt;</span>
                <span class="tag">&lt;SignatureIntact&gt;</span>true<span class="tag">&lt;/SignatureIntact&gt;</span>
                <span class="tag">&lt;SignatureValid&gt;</span>true<span class="tag">&lt;/SignatureValid&gt;</span>
            <span class="tag">&lt;/BasicSignature&gt;</span>
            <span class="tag">&lt;SigningCertificate</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">021EC5069EB8A903BD62B6769EDDFE439DFA90A720C9A362D5FE76B9C31D0302</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;AttributePresent&gt;</span>true<span class="tag">&lt;/AttributePresent&gt;</span>
                <span class="tag">&lt;DigestValuePresent&gt;</span>true<span class="tag">&lt;/DigestValuePresent&gt;</span>
                <span class="tag">&lt;DigestValueMatch&gt;</span>true<span class="tag">&lt;/DigestValueMatch&gt;</span>
                <span class="tag">&lt;IssuerSerialMatch&gt;</span>true<span class="tag">&lt;/IssuerSerialMatch&gt;</span>
            <span class="tag">&lt;/SigningCertificate&gt;</span>
            <span class="tag">&lt;CertificateChain&gt;</span>
                <span class="tag">&lt;ChainItem</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">021EC5069EB8A903BD62B6769EDDFE439DFA90A720C9A362D5FE76B9C31D0302</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                    <span class="tag">&lt;Source&gt;</span>UNKNOWN<span class="tag">&lt;/Source&gt;</span>
                <span class="tag">&lt;/ChainItem&gt;</span>
                <span class="tag">&lt;ChainItem</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">80AC352930875BA0AFE7F70DD389130C8E1E7BEFFDC96477356AD2A9E003AD2B</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                    <span class="tag">&lt;Source&gt;</span>UNKNOWN<span class="tag">&lt;/Source&gt;</span>
                <span class="tag">&lt;/ChainItem&gt;</span>
                <span class="tag">&lt;ChainItem</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">702DD5C1A093CF0A9D71FADD9BF9A7C5857D89FB73B716E867228B3C2BEB968F</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                    <span class="tag">&lt;Source&gt;</span>TRUSTED_LIST<span class="tag">&lt;/Source&gt;</span>
                <span class="tag">&lt;/ChainItem&gt;</span>
            <span class="tag">&lt;/CertificateChain&gt;</span>
            <span class="tag">&lt;ContentType&gt;</span>application/pdf<span class="tag">&lt;/ContentType&gt;</span>
            <span class="tag">&lt;CommitmentTypeIndication</span><span class="tag">/&gt;</span>
            <span class="tag">&lt;ClaimedRoles</span><span class="tag">/&gt;</span>
            <span class="tag">&lt;Timestamps&gt;</span>
                <span class="tag">&lt;Timestamp</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">F8B72B7574450E84664DE88950BC781CA2528CF5B39ABB3E1F93947B752BE79F</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">Type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">SIGNATURE_TIMESTAMP</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                    <span class="tag">&lt;ProductionTime&gt;</span>2017-10-27T11:55:08<span class="tag">&lt;/ProductionTime&gt;</span>
                    <span class="tag">&lt;SignedDataDigestAlgo&gt;</span>SHA512<span class="tag">&lt;/SignedDataDigestAlgo&gt;</span>
                    <span class="tag">&lt;EncodedSignedDataDigestValue&gt;</span>kS17/pxPekqLwE8UcpnhxyZd/8gkQ8IAhho9KI+2yuh25qyB4qS7ozZ7L85YSssCy66ByRGweAG/mwK8RfXJoA==<span class="tag">&lt;/EncodedSignedDataDigestValue&gt;</span>
                    <span class="tag">&lt;MessageImprintDataFound&gt;</span>true<span class="tag">&lt;/MessageImprintDataFound&gt;</span>
                    <span class="tag">&lt;MessageImprintDataIntact&gt;</span>true<span class="tag">&lt;/MessageImprintDataIntact&gt;</span>
                    <span class="tag">&lt;BasicSignature&gt;</span>
                        <span class="tag">&lt;EncryptionAlgoUsedToSignThisToken&gt;</span>RSA<span class="tag">&lt;/EncryptionAlgoUsedToSignThisToken&gt;</span>
                        <span class="tag">&lt;KeyLengthUsedToSignThisToken&gt;</span>2048<span class="tag">&lt;/KeyLengthUsedToSignThisToken&gt;</span>
                        <span class="tag">&lt;DigestAlgoUsedToSignThisToken&gt;</span>SHA512<span class="tag">&lt;/DigestAlgoUsedToSignThisToken&gt;</span>
                        <span class="tag">&lt;ReferenceDataFound&gt;</span>true<span class="tag">&lt;/ReferenceDataFound&gt;</span>
                        <span class="tag">&lt;ReferenceDataIntact&gt;</span>true<span class="tag">&lt;/ReferenceDataIntact&gt;</span>
                        <span class="tag">&lt;SignatureIntact&gt;</span>true<span class="tag">&lt;/SignatureIntact&gt;</span>
                        <span class="tag">&lt;SignatureValid&gt;</span>true<span class="tag">&lt;/SignatureValid&gt;</span>
                    <span class="tag">&lt;/BasicSignature&gt;</span>
                    <span class="tag">&lt;SigningCertificate</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">EE3C22E06087BFEC213709AD3E7F2DDA9CE9D19CE238DCA81A6433E9070A9FBE</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
                    <span class="tag">&lt;CertificateChain&gt;</span>
                        <span class="tag">&lt;ChainItem</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">EE3C22E06087BFEC213709AD3E7F2DDA9CE9D19CE238DCA81A6433E9070A9FBE</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                            <span class="tag">&lt;Source&gt;</span>TIMESTAMP<span class="tag">&lt;/Source&gt;</span>
                        <span class="tag">&lt;/ChainItem&gt;</span>
                        <span class="tag">&lt;ChainItem</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">702DD5C1A093CF0A9D71FADD9BF9A7C5857D89FB73B716E867228B3C2BEB968F</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                            <span class="tag">&lt;Source&gt;</span>TRUSTED_LIST<span class="tag">&lt;/Source&gt;</span>
                        <span class="tag">&lt;/ChainItem&gt;</span>
                    <span class="tag">&lt;/CertificateChain&gt;</span>
                    <span class="tag">&lt;TimestampedObjects&gt;</span>
                        <span class="tag">&lt;TimestampedObject</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">id-2056753e8b67ab9c96a6fe80ec9f619f8e9b4505b66b078c7a2b6e151edc2bbb</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">Category</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">SIGNATURE</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
                        <span class="tag">&lt;TimestampedObject</span> <span class="attribute-name">Category</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">CERTIFICATE</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                            <span class="tag">&lt;DigestAlgoAndValue&gt;</span>
                                <span class="tag">&lt;DigestMethod&gt;</span>SHA256<span class="tag">&lt;/DigestMethod&gt;</span>
                                <span class="tag">&lt;DigestValue&gt;</span>Ah7FBp64qQO9YrZ2nt3+Q536kKcgyaNi1f52ucMdAwI=<span class="tag">&lt;/DigestValue&gt;</span>
                            <span class="tag">&lt;/DigestAlgoAndValue&gt;</span>
                        <span class="tag">&lt;/TimestampedObject&gt;</span>
                    <span class="tag">&lt;/TimestampedObjects&gt;</span>
                <span class="tag">&lt;/Timestamp&gt;</span>
                <span class="tag">&lt;Timestamp</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">7F9B88A8161CC87905298FF8E0CD080516452FBA1480DD6AFAE38B7DD18E2A1B</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">Type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">ARCHIVE_TIMESTAMP</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                    ....
                <span class="tag">&lt;/Timestamp&gt;</span>
            <span class="tag">&lt;/Timestamps&gt;</span>
            <span class="tag">&lt;SignatureScopes&gt;</span>
                <span class="tag">&lt;SignatureScope</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">PDF previous version #1</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">scope</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">PdfByteRangeSignatureScope</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>The document byte range: [0, 9258, 32602, 495939]<span class="tag">&lt;/SignatureScope&gt;</span>
            <span class="tag">&lt;/SignatureScopes&gt;</span>
        <span class="tag">&lt;/Signature&gt;</span>
    <span class="tag">&lt;/Signatures&gt;</span>
    <span class="tag">&lt;UsedCertificates&gt;</span>
        <span class="tag">&lt;Certificate</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">021EC5069EB8A903BD62B6769EDDFE439DFA90A720C9A362D5FE76B9C31D0302</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;SubjectDistinguishedName</span> <span class="attribute-name">Format</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">CANONICAL</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>2.5.4.5=#130b3837303533303236323231,2.5.4.42=#130b456c696e65204765726461,2.5.4.4=#130d56616e205261656d646f6e636b,cn=E van R (signature),c=be<span class="tag">&lt;/SubjectDistinguishedName&gt;</span>
            <span class="tag">&lt;SubjectDistinguishedName</span> <span class="attribute-name">Format</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">RFC2253</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>2.5.4.5=#130b3837303533303236323231,2.5.4.42=#130b456c696e65204765726461,2.5.4.4=#130d56616e205261656d646f6e636b,CN=E Van R (Signature),C=BE<span class="tag">&lt;/SubjectDistinguishedName&gt;</span>
            <span class="tag">&lt;IssuerDistinguishedName</span> <span class="attribute-name">Format</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">CANONICAL</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>2.5.4.5=#1306323031373130,cn=citizen ca,o=http://repository.eid.belgium.be/,c=be<span class="tag">&lt;/IssuerDistinguishedName&gt;</span>
            <span class="tag">&lt;IssuerDistinguishedName</span> <span class="attribute-name">Format</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">RFC2253</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>2.5.4.5=#1306323031373130,CN=Citizen CA,O=http://repository.eid.belgium.be/,C=BE<span class="tag">&lt;/IssuerDistinguishedName&gt;</span>
            <span class="tag">&lt;SerialNumber&gt;</span>21267647932559290630671294378886251870<span class="tag">&lt;/SerialNumber&gt;</span>
            <span class="tag">&lt;CommonName&gt;</span>E Van R (Signature)<span class="tag">&lt;/CommonName&gt;</span>
            <span class="tag">&lt;CountryName&gt;</span>BE<span class="tag">&lt;/CountryName&gt;</span>
            <span class="tag">&lt;GivenName&gt;</span>E G<span class="tag">&lt;/GivenName&gt;</span>
            <span class="tag">&lt;Surname&gt;</span>Van R<span class="tag">&lt;/Surname&gt;</span>
            <span class="tag">&lt;AuthorityInformationAccessUrls&gt;</span>
                <span class="tag">&lt;Url&gt;</span>http://certs.eid.belgium.be/belgiumrs4.crt<span class="tag">&lt;/Url&gt;</span>
            <span class="tag">&lt;/AuthorityInformationAccessUrls&gt;</span>
            <span class="tag">&lt;CRLDistributionPoints&gt;</span>
                <span class="tag">&lt;Url&gt;</span>http://crl.eid.belgium.be/eidc201710.crl<span class="tag">&lt;/Url&gt;</span>
            <span class="tag">&lt;/CRLDistributionPoints&gt;</span>
            <span class="tag">&lt;OCSPAccessUrls&gt;</span>
                <span class="tag">&lt;Url&gt;</span>http://ocsp.eid.belgium.be/2<span class="tag">&lt;/Url&gt;</span>
            <span class="tag">&lt;/OCSPAccessUrls&gt;</span>
            <span class="tag">&lt;DigestAlgoAndValues&gt;</span>
                <span class="tag">&lt;DigestAlgoAndValue&gt;</span>
                    <span class="tag">&lt;DigestMethod&gt;</span>SHA256<span class="tag">&lt;/DigestMethod&gt;</span>
                    <span class="tag">&lt;DigestValue&gt;</span>Ah7FBp64qQO9YrZ2nt3+Q536kKcgyaNi1f52ucMdAwI=<span class="tag">&lt;/DigestValue&gt;</span>
                <span class="tag">&lt;/DigestAlgoAndValue&gt;</span>
                <span class="tag">&lt;DigestAlgoAndValue&gt;</span>
                    <span class="tag">&lt;DigestMethod&gt;</span>SHA1<span class="tag">&lt;/DigestMethod&gt;</span>
                    <span class="tag">&lt;DigestValue&gt;</span>WWUnOSgChkevrP7omdQeS/plaNQ=<span class="tag">&lt;/DigestValue&gt;</span>
                <span class="tag">&lt;/DigestAlgoAndValue&gt;</span>
            <span class="tag">&lt;/DigestAlgoAndValues&gt;</span>
            <span class="tag">&lt;NotAfter&gt;</span>2027-03-13T23:59:59<span class="tag">&lt;/NotAfter&gt;</span>
            <span class="tag">&lt;NotBefore&gt;</span>2017-05-15T16:19:53<span class="tag">&lt;/NotBefore&gt;</span>
            <span class="tag">&lt;PublicKeySize&gt;</span>2048<span class="tag">&lt;/PublicKeySize&gt;</span>
            <span class="tag">&lt;PublicKeyEncryptionAlgo&gt;</span>RSA<span class="tag">&lt;/PublicKeyEncryptionAlgo&gt;</span>
            <span class="tag">&lt;KeyUsageBits&gt;</span>
                <span class="tag">&lt;KeyUsage&gt;</span>nonRepudiation<span class="tag">&lt;/KeyUsage&gt;</span>
            <span class="tag">&lt;/KeyUsageBits&gt;</span>
            <span class="tag">&lt;ExtendedKeyUsages</span><span class="tag">/&gt;</span>
            <span class="tag">&lt;IdPkixOcspNoCheck&gt;</span>false<span class="tag">&lt;/IdPkixOcspNoCheck&gt;</span>
            <span class="tag">&lt;BasicSignature&gt;</span>
                <span class="tag">&lt;EncryptionAlgoUsedToSignThisToken&gt;</span>RSA<span class="tag">&lt;/EncryptionAlgoUsedToSignThisToken&gt;</span>
                <span class="tag">&lt;KeyLengthUsedToSignThisToken&gt;</span>4096<span class="tag">&lt;/KeyLengthUsedToSignThisToken&gt;</span>
                <span class="tag">&lt;DigestAlgoUsedToSignThisToken&gt;</span>SHA256<span class="tag">&lt;/DigestAlgoUsedToSignThisToken&gt;</span>
                <span class="tag">&lt;ReferenceDataFound&gt;</span>true<span class="tag">&lt;/ReferenceDataFound&gt;</span>
                <span class="tag">&lt;ReferenceDataIntact&gt;</span>true<span class="tag">&lt;/ReferenceDataIntact&gt;</span>
                <span class="tag">&lt;SignatureIntact&gt;</span>true<span class="tag">&lt;/SignatureIntact&gt;</span>
                <span class="tag">&lt;SignatureValid&gt;</span>true<span class="tag">&lt;/SignatureValid&gt;</span>
            <span class="tag">&lt;/BasicSignature&gt;</span>
            <span class="tag">&lt;SigningCertificate</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">80AC352930875BA0AFE7F70DD389130C8E1E7BEFFDC96477356AD2A9E003AD2B</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;CertificateChain&gt;</span>
                <span class="tag">&lt;ChainItem</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">80AC352930875BA0AFE7F70DD389130C8E1E7BEFFDC96477356AD2A9E003AD2B</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                    <span class="tag">&lt;Source&gt;</span>UNKNOWN<span class="tag">&lt;/Source&gt;</span>
                <span class="tag">&lt;/ChainItem&gt;</span>
                <span class="tag">&lt;ChainItem</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">702DD5C1A093CF0A9D71FADD9BF9A7C5857D89FB73B716E867228B3C2BEB968F</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                    <span class="tag">&lt;Source&gt;</span>TRUSTED_LIST<span class="tag">&lt;/Source&gt;</span>
                <span class="tag">&lt;/ChainItem&gt;</span>
            <span class="tag">&lt;/CertificateChain&gt;</span>
            <span class="tag">&lt;Trusted&gt;</span>false<span class="tag">&lt;/Trusted&gt;</span>
            <span class="tag">&lt;SelfSigned&gt;</span>false<span class="tag">&lt;/SelfSigned&gt;</span>
            <span class="tag">&lt;CertificatePolicies&gt;</span>
                <span class="tag">&lt;certificatePolicy</span> <span class="attribute-name">cpsUrl</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://repository.eid.belgium.be</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>2.16.56.12.1.1.2.1<span class="tag">&lt;/certificatePolicy&gt;</span>
            <span class="tag">&lt;/CertificatePolicies&gt;</span>
            <span class="tag">&lt;QCStatementIds&gt;</span>
                <span class="tag">&lt;oid</span> <span class="attribute-name">Description</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">qc-compliance</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>0.4.0.1862.1.1<span class="tag">&lt;/oid&gt;</span>
                <span class="tag">&lt;oid</span> <span class="attribute-name">Description</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">qc-sscd</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>0.4.0.1862.1.4<span class="tag">&lt;/oid&gt;</span>
            <span class="tag">&lt;/QCStatementIds&gt;</span>
            <span class="tag">&lt;QCTypes</span><span class="tag">/&gt;</span>
            <span class="tag">&lt;TrustedServiceProviders&gt;</span>
                <span class="tag">&lt;TrustedServiceProvider&gt;</span>
                    <span class="tag">&lt;TSPName&gt;</span>Certipost n.v./s.a.<span class="tag">&lt;/TSPName&gt;</span>
                    <span class="tag">&lt;TSPRegistrationIdentifier&gt;</span>VATBE-0475396406<span class="tag">&lt;/TSPRegistrationIdentifier&gt;</span>
                    <span class="tag">&lt;CountryCode&gt;</span>BE<span class="tag">&lt;/CountryCode&gt;</span>
                    <span class="tag">&lt;TrustedServices&gt;</span>
                        <span class="tag">&lt;TrustedService&gt;</span>
                            <span class="tag">&lt;ServiceName&gt;</span>CN=Belgium Root CA4, C=BE<span class="tag">&lt;/ServiceName&gt;</span>
                            <span class="tag">&lt;ServiceType&gt;</span>http://uri.etsi.org/TrstSvc/Svctype/CA/QC<span class="tag">&lt;/ServiceType&gt;</span>
                            <span class="tag">&lt;Status&gt;</span>http://uri.etsi.org/TrstSvc/TrustedList/Svcstatus/granted<span class="tag">&lt;/Status&gt;</span>
                            <span class="tag">&lt;StartDate&gt;</span>2016-06-30T22:00:00<span class="tag">&lt;/StartDate&gt;</span>
                            <span class="tag">&lt;CapturedQualifiers&gt;</span>
                                <span class="tag">&lt;Qualifier&gt;</span>http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/QCQSCDStatusAsInCert<span class="tag">&lt;/Qualifier&gt;</span>
                            <span class="tag">&lt;/CapturedQualifiers&gt;</span>
                            <span class="tag">&lt;AdditionalServiceInfoUris&gt;</span>
                                <span class="tag">&lt;URI&gt;</span>http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/RootCA-QC<span class="tag">&lt;/URI&gt;</span>
                                <span class="tag">&lt;URI&gt;</span>http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/ForeSignatures<span class="tag">&lt;/URI&gt;</span>
                            <span class="tag">&lt;/AdditionalServiceInfoUris&gt;</span>
                        <span class="tag">&lt;/TrustedService&gt;</span>
                    <span class="tag">&lt;/TrustedServices&gt;</span>
                <span class="tag">&lt;/TrustedServiceProvider&gt;</span>
            <span class="tag">&lt;/TrustedServiceProviders&gt;</span>
            <span class="tag">&lt;Revocations&gt;</span>
                <span class="tag">&lt;Revocation</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">021ec5069eb8a903bd62b6769eddfe439dfa90a720c9a362d5fe76b9c31d0302bfc08d553a774d1f440ab36525a3290e2cc23b46d0ac954ea4d8201faff0d91a</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                    <span class="tag">&lt;Origin&gt;</span>SIGNATURE<span class="tag">&lt;/Origin&gt;</span>
                    <span class="tag">&lt;Source&gt;</span>OCSPToken<span class="tag">&lt;/Source&gt;</span>
                    <span class="tag">&lt;Status&gt;</span>true<span class="tag">&lt;/Status&gt;</span>
                    <span class="tag">&lt;ProductionDate&gt;</span>2017-10-27T11:55:08<span class="tag">&lt;/ProductionDate&gt;</span>
                    <span class="tag">&lt;ThisUpdate&gt;</span>2017-10-27T11:55:08<span class="tag">&lt;/ThisUpdate&gt;</span>
                    <span class="tag">&lt;NextUpdate&gt;</span>2017-10-27T11:56:08<span class="tag">&lt;/NextUpdate&gt;</span>
                    <span class="tag">&lt;DigestAlgoAndValues&gt;</span>
                        <span class="tag">&lt;DigestAlgoAndValue&gt;</span>
                            <span class="tag">&lt;DigestMethod&gt;</span>SHA256<span class="tag">&lt;/DigestMethod&gt;</span>
                            <span class="tag">&lt;DigestValue&gt;</span>v8CNVTp3TR9ECrNlJaMpDizCO0bQrJVOpNggH6/w2Ro=<span class="tag">&lt;/DigestValue&gt;</span>
                        <span class="tag">&lt;/DigestAlgoAndValue&gt;</span>
                        <span class="tag">&lt;DigestAlgoAndValue&gt;</span>
                            <span class="tag">&lt;DigestMethod&gt;</span>SHA1<span class="tag">&lt;/DigestMethod&gt;</span>
                            <span class="tag">&lt;DigestValue&gt;</span>MRhWbZTCsnogtBv4KZ5GzE2imWA=<span class="tag">&lt;/DigestValue&gt;</span>
                        <span class="tag">&lt;/DigestAlgoAndValue&gt;</span>
                    <span class="tag">&lt;/DigestAlgoAndValues&gt;</span>
                    <span class="tag">&lt;BasicSignature&gt;</span>
                        <span class="tag">&lt;EncryptionAlgoUsedToSignThisToken&gt;</span>RSA<span class="tag">&lt;/EncryptionAlgoUsedToSignThisToken&gt;</span>
                        <span class="tag">&lt;KeyLengthUsedToSignThisToken&gt;</span>2048<span class="tag">&lt;/KeyLengthUsedToSignThisToken&gt;</span>
                        <span class="tag">&lt;DigestAlgoUsedToSignThisToken&gt;</span>SHA256<span class="tag">&lt;/DigestAlgoUsedToSignThisToken&gt;</span>
                        <span class="tag">&lt;ReferenceDataFound&gt;</span>true<span class="tag">&lt;/ReferenceDataFound&gt;</span>
                        <span class="tag">&lt;ReferenceDataIntact&gt;</span>true<span class="tag">&lt;/ReferenceDataIntact&gt;</span>
                        <span class="tag">&lt;SignatureIntact&gt;</span>true<span class="tag">&lt;/SignatureIntact&gt;</span>
                        <span class="tag">&lt;SignatureValid&gt;</span>true<span class="tag">&lt;/SignatureValid&gt;</span>
                    <span class="tag">&lt;/BasicSignature&gt;</span>
                    <span class="tag">&lt;SigningCertificate</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">CB217219BADFC13B4FEA3EFA43882E9FECE49E542DCDBA83428DC6854499A35F</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
                    <span class="tag">&lt;CertificateChain&gt;</span>
                        <span class="tag">&lt;ChainItem</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">CB217219BADFC13B4FEA3EFA43882E9FECE49E542DCDBA83428DC6854499A35F</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                            <span class="tag">&lt;Source&gt;</span>OCSP_RESPONSE<span class="tag">&lt;/Source&gt;</span>
                        <span class="tag">&lt;/ChainItem&gt;</span>
                        <span class="tag">&lt;ChainItem</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">80AC352930875BA0AFE7F70DD389130C8E1E7BEFFDC96477356AD2A9E003AD2B</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                            <span class="tag">&lt;Source&gt;</span>UNKNOWN<span class="tag">&lt;/Source&gt;</span>
                        <span class="tag">&lt;/ChainItem&gt;</span>
                        <span class="tag">&lt;ChainItem</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">702DD5C1A093CF0A9D71FADD9BF9A7C5857D89FB73B716E867228B3C2BEB968F</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                            <span class="tag">&lt;Source&gt;</span>TRUSTED_LIST<span class="tag">&lt;/Source&gt;</span>
                        <span class="tag">&lt;/ChainItem&gt;</span>
                    <span class="tag">&lt;/CertificateChain&gt;</span>
                    <span class="tag">&lt;Info</span><span class="tag">/&gt;</span>
                <span class="tag">&lt;/Revocation&gt;</span>
            <span class="tag">&lt;/Revocations&gt;</span>
            <span class="tag">&lt;Info&gt;</span>
                <span class="tag">&lt;Message</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>No CRL info found !<span class="tag">&lt;/Message&gt;</span>
            <span class="tag">&lt;/Info&gt;</span>
        <span class="tag">&lt;/Certificate&gt;</span>
        <span class="tag">&lt;Certificate</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">80AC352930875BA0AFE7F70DD389130C8E1E7BEFFDC96477356AD2A9E003AD2B</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
            ...
        <span class="tag">&lt;/Certificate&gt;</span>
        <span class="tag">&lt;Certificate</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">702DD5C1A093CF0A9D71FADD9BF9A7C5857D89FB73B716E867228B3C2BEB968F</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                ...
        <span class="tag">&lt;/Certificate&gt;</span>
        <span class="tag">&lt;Certificate</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">EE3C22E06087BFEC213709AD3E7F2DDA9CE9D19CE238DCA81A6433E9070A9FBE</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
            ...
        <span class="tag">&lt;/Certificate&gt;</span>
        <span class="tag">&lt;Certificate</span> <span class="attribute-name">Id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">CB217219BADFC13B4FEA3EFA43882E9FECE49E542DCDBA83428DC6854499A35F</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
            ...
        <span class="tag">&lt;/Certificate&gt;</span>
    <span class="tag">&lt;/UsedCertificates&gt;</span>
    <span class="tag">&lt;TrustedLists&gt;</span>
        <span class="tag">&lt;TrustedList&gt;</span>
            <span class="tag">&lt;CountryCode&gt;</span>BE<span class="tag">&lt;/CountryCode&gt;</span>
            <span class="tag">&lt;Url&gt;</span>https://tsl.belgium.be/tsl-be.xml<span class="tag">&lt;/Url&gt;</span>
            <span class="tag">&lt;SequenceNumber&gt;</span>36<span class="tag">&lt;/SequenceNumber&gt;</span>
            <span class="tag">&lt;Version&gt;</span>5<span class="tag">&lt;/Version&gt;</span>
            <span class="tag">&lt;LastLoading&gt;</span>2018-02-23T05:15:00<span class="tag">&lt;/LastLoading&gt;</span>
            <span class="tag">&lt;IssueDate&gt;</span>2018-02-08T00:00:00<span class="tag">&lt;/IssueDate&gt;</span>
            <span class="tag">&lt;NextUpdate&gt;</span>2018-07-30T00:00:00<span class="tag">&lt;/NextUpdate&gt;</span>
            <span class="tag">&lt;WellSigned&gt;</span>true<span class="tag">&lt;/WellSigned&gt;</span>
        <span class="tag">&lt;/TrustedList&gt;</span>
    <span class="tag">&lt;/TrustedLists&gt;</span>
    <span class="tag">&lt;ListOfTrustedLists&gt;</span>
        <span class="tag">&lt;CountryCode&gt;</span>EU<span class="tag">&lt;/CountryCode&gt;</span>
        <span class="tag">&lt;Url&gt;</span>https://ec.europa.eu/information_society/policy/esignature/trusted-list/tl-mp.xml<span class="tag">&lt;/Url&gt;</span>
        <span class="tag">&lt;SequenceNumber&gt;</span>200<span class="tag">&lt;/SequenceNumber&gt;</span>
        <span class="tag">&lt;Version&gt;</span>5<span class="tag">&lt;/Version&gt;</span>
        <span class="tag">&lt;LastLoading&gt;</span>2018-02-23T05:15:00<span class="tag">&lt;/LastLoading&gt;</span>
        <span class="tag">&lt;IssueDate&gt;</span>2018-02-19T13:00:00<span class="tag">&lt;/IssueDate&gt;</span>
        <span class="tag">&lt;NextUpdate&gt;</span>2018-08-19T00:00:00<span class="tag">&lt;/NextUpdate&gt;</span>
        <span class="tag">&lt;WellSigned&gt;</span>true<span class="tag">&lt;/WellSigned&gt;</span>
    <span class="tag">&lt;/ListOfTrustedLists&gt;</span>
<span class="tag">&lt;/DiagnosticData&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_customised_validation_policy"><a class="anchor" href="#_customised_validation_policy"></a>Customised Validation Policy</h3>
<div class="paragraph">
<p>The validation process may be driven by a set of constraints that are contained in the XML file constraint.xml.</p>
</div>
<div class="listingblock">
<div class="title">constraint.xml (default policy is provided in validation-policy module)</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;ConstraintsParameters</span> <span class="attribute-name">Name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">QES AdESQC TL based</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://dss.esig.europa.eu/validation/policy</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;Description&gt;</span>Validate electronic signatures and indicates whether they are Advanced electronic Signatures (AdES), AdES supported by a Qualified Certificate (AdES/QC) or a
                Qualified electronic Signature (QES). All certificates and their related chains supporting the signatures are validated against the EU Member State Trusted Lists (this includes
                signer's certificate and certificates used to validate certificate validity status services - CRLs, OCSP, and time-stamps).
        <span class="tag">&lt;/Description&gt;</span>
        <span class="tag">&lt;ContainerConstraints&gt;</span>
                <span class="tag">&lt;AcceptableContainerTypes</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                        <span class="tag">&lt;Id&gt;</span>ASiC-S<span class="tag">&lt;/Id&gt;</span>
                        <span class="tag">&lt;Id&gt;</span>ASiC-E<span class="tag">&lt;/Id&gt;</span>
                <span class="tag">&lt;/AcceptableContainerTypes&gt;</span>
<span class="comment">&lt;!--                 &lt;ZipCommentPresent Level=&quot;WARN&quot; /&gt; --&gt;</span>
<span class="comment">&lt;!--                 &lt;AcceptableZipComment Level=&quot;WARN&quot;&gt; --&gt;</span>
<span class="comment">&lt;!--                         &lt;Id&gt;mimetype=application/vnd.etsi.asic-s+zip&lt;/Id&gt; --&gt;</span>
<span class="comment">&lt;!--                         &lt;Id&gt;mimetype=application/vnd.etsi.asic-e+zip&lt;/Id&gt; --&gt;</span>
<span class="comment">&lt;!--                 &lt;/AcceptableZipComment&gt; --&gt;</span>
                <span class="tag">&lt;MimeTypeFilePresent</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                <span class="tag">&lt;AcceptableMimeTypeFileContent</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">WARN</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                        <span class="tag">&lt;Id&gt;</span>application/vnd.etsi.asic-s+zip<span class="tag">&lt;/Id&gt;</span>
                        <span class="tag">&lt;Id&gt;</span>application/vnd.etsi.asic-e+zip<span class="tag">&lt;/Id&gt;</span>
                <span class="tag">&lt;/AcceptableMimeTypeFileContent&gt;</span>
                <span class="tag">&lt;ManifestFilePresent</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                <span class="tag">&lt;AllFilesSigned</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">WARN</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
        <span class="tag">&lt;/ContainerConstraints&gt;</span>
        <span class="tag">&lt;SignatureConstraints&gt;</span>
                <span class="tag">&lt;AcceptablePolicies</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                        <span class="tag">&lt;Id&gt;</span>ANY_POLICY<span class="tag">&lt;/Id&gt;</span>
                        <span class="tag">&lt;Id&gt;</span>NO_POLICY<span class="tag">&lt;/Id&gt;</span>
                <span class="tag">&lt;/AcceptablePolicies&gt;</span>
                <span class="tag">&lt;PolicyAvailable</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                <span class="tag">&lt;PolicyHashMatch</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                <span class="tag">&lt;AcceptableFormats</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                        <span class="tag">&lt;Id&gt;</span>*<span class="tag">&lt;/Id&gt;</span>
                <span class="tag">&lt;/AcceptableFormats&gt;</span>
                <span class="tag">&lt;BasicSignatureConstraints&gt;</span>
                        <span class="tag">&lt;ReferenceDataExistence</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                        <span class="tag">&lt;ReferenceDataIntact</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                        <span class="tag">&lt;SignatureIntact</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                        <span class="tag">&lt;ProspectiveCertificateChain</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
<span class="comment">&lt;!--                         &lt;TrustedServiceTypeIdentifier Level=&quot;WARN&quot;&gt; --&gt;</span>
<span class="comment">&lt;!--                                 &lt;Id&gt;http://uri.etsi.org/TrstSvc/Svctype/CA/QC&lt;/Id&gt; --&gt;</span>
<span class="comment">&lt;!--                         &lt;/TrustedServiceTypeIdentifier&gt; --&gt;</span>
<span class="comment">&lt;!--                         &lt;TrustedServiceStatus Level=&quot;FAIL&quot;&gt; --&gt;</span>
<span class="comment">&lt;!--                                 &lt;Id&gt;http://uri.etsi.org/TrstSvc/TrustedList/Svcstatus/undersupervision&lt;/Id&gt; --&gt;</span>
<span class="comment">&lt;!--                                 &lt;Id&gt;http://uri.etsi.org/TrstSvc/TrustedList/Svcstatus/accredited&lt;/Id&gt; --&gt;</span>
<span class="comment">&lt;!--                                 &lt;Id&gt;http://uri.etsi.org/TrstSvc/TrustedList/Svcstatus/supervisionincessation&lt;/Id&gt; --&gt;</span>
<span class="comment">&lt;!--                                 &lt;Id&gt;http://uri.etsi.org/TrstSvc/TrustedList/Svcstatus/granted&lt;/Id&gt; --&gt;</span>
<span class="comment">&lt;!--                                 &lt;Id&gt;http://uri.etsi.org/TrstSvc/TrustedList/Svcstatus/withdrawn&lt;/Id&gt; --&gt;</span>
<span class="comment">&lt;!--                         &lt;/TrustedServiceStatus&gt; --&gt;</span>
                        <span class="tag">&lt;SigningCertificate&gt;</span>
                                <span class="tag">&lt;Recognition</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;Signature</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;NotExpired</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;AuthorityInfoAccessPresent</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">WARN</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;RevocationInfoAccessPresent</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">WARN</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;RevocationDataAvailable</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;RevocationDataNextUpdatePresent</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">WARN</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;RevocationDataFreshness</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">WARN</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;KeyUsage</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">WARN</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                                        <span class="tag">&lt;Id&gt;</span>nonRepudiation<span class="tag">&lt;/Id&gt;</span>
                                <span class="tag">&lt;/KeyUsage&gt;</span>
                                <span class="tag">&lt;SerialNumberPresent</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">WARN</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;NotRevoked</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;NotOnHold</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;NotSelfSigned</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">WARN</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
<span class="comment">&lt;!--                                 &lt;Qualification Level=&quot;WARN&quot; /&gt; --&gt;</span>
<span class="comment">&lt;!--                                 &lt;SupportedByQSCD Level=&quot;WARN&quot; /&gt; --&gt;</span>
<span class="comment">&lt;!--                                 &lt;IssuedToNaturalPerson Level=&quot;INFORM&quot; /&gt; --&gt;</span>
<span class="comment">&lt;!--                                 &lt;IssuedToLegalPerson Level=&quot;INFORM&quot; /&gt; --&gt;</span>
                                <span class="tag">&lt;UsePseudonym</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">INFORM</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;Cryptographic</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                                        <span class="tag">&lt;AcceptableEncryptionAlgo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>RSA<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>DSA<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>ECDSA<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;/AcceptableEncryptionAlgo&gt;</span>
                                        <span class="tag">&lt;MiniPublicKeySize&gt;</span>
                                                <span class="tag">&lt;Algo</span> <span class="attribute-name">Size</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">128</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>DSA<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo</span> <span class="attribute-name">Size</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">1024</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>RSA<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo</span> <span class="attribute-name">Size</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">192</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>ECDSA<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;/MiniPublicKeySize&gt;</span>
                                        <span class="tag">&lt;AcceptableDigestAlgo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA1<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA224<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA256<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA384<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA512<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA3-224<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA3-256<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA3-384<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA3-512<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>RIPEMD160<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;/AcceptableDigestAlgo&gt;</span>
                                <span class="tag">&lt;/Cryptographic&gt;</span>
                        <span class="tag">&lt;/SigningCertificate&gt;</span>
                        <span class="tag">&lt;CACertificate&gt;</span>
                                <span class="tag">&lt;Signature</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;NotExpired</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;RevocationDataAvailable</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;RevocationDataNextUpdatePresent</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">WARN</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;RevocationDataFreshness</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">WARN</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;NotRevoked</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;NotOnHold</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;Cryptographic</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                                        <span class="tag">&lt;AcceptableEncryptionAlgo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>RSA<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>DSA<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>ECDSA<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;/AcceptableEncryptionAlgo&gt;</span>
                                        <span class="tag">&lt;MiniPublicKeySize&gt;</span>
                                                <span class="tag">&lt;Algo</span> <span class="attribute-name">Size</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">128</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>DSA<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo</span> <span class="attribute-name">Size</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">1024</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>RSA<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo</span> <span class="attribute-name">Size</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">192</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>ECDSA<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;/MiniPublicKeySize&gt;</span>
                                        <span class="tag">&lt;AcceptableDigestAlgo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA1<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA224<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA256<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA384<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA512<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA3-224<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA3-256<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA3-384<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA3-512<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>RIPEMD160<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;/AcceptableDigestAlgo&gt;</span>
                                <span class="tag">&lt;/Cryptographic&gt;</span>
                        <span class="tag">&lt;/CACertificate&gt;</span>
                        <span class="tag">&lt;Cryptographic</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                                <span class="tag">&lt;AcceptableEncryptionAlgo&gt;</span>
                                        <span class="tag">&lt;Algo&gt;</span>RSA<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;Algo&gt;</span>DSA<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;Algo&gt;</span>ECDSA<span class="tag">&lt;/Algo&gt;</span>
                                <span class="tag">&lt;/AcceptableEncryptionAlgo&gt;</span>
                                <span class="tag">&lt;MiniPublicKeySize&gt;</span>
                                        <span class="tag">&lt;Algo</span> <span class="attribute-name">Size</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">128</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>DSA<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;Algo</span> <span class="attribute-name">Size</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">1024</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>RSA<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;Algo</span> <span class="attribute-name">Size</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">192</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>ECDSA<span class="tag">&lt;/Algo&gt;</span>
                                <span class="tag">&lt;/MiniPublicKeySize&gt;</span>
                                <span class="tag">&lt;AcceptableDigestAlgo&gt;</span>
                                        <span class="tag">&lt;Algo&gt;</span>SHA1<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;Algo&gt;</span>SHA224<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;Algo&gt;</span>SHA256<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;Algo&gt;</span>SHA384<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;Algo&gt;</span>SHA512<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA3-224<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA3-256<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA3-384<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA3-512<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;Algo&gt;</span>RIPEMD160<span class="tag">&lt;/Algo&gt;</span>
                                <span class="tag">&lt;/AcceptableDigestAlgo&gt;</span>
                        <span class="tag">&lt;/Cryptographic&gt;</span>
                <span class="tag">&lt;/BasicSignatureConstraints&gt;</span>
                <span class="tag">&lt;SignedAttributes&gt;</span>
                        <span class="tag">&lt;SigningCertificatePresent</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                        <span class="tag">&lt;SigningCertificateSigned</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                        <span class="tag">&lt;CertDigestPresent</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                        <span class="tag">&lt;CertDigestMatch</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                        <span class="tag">&lt;IssuerSerialMatch</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">WARN</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                        <span class="tag">&lt;SigningTime</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
<span class="comment">&lt;!--                &lt;ContentType Level=&quot;FAIL&quot; value=&quot;1.2.840.113549.1.7.1&quot; /&gt;
                        &lt;ContentHints Level=&quot;FAIL&quot; value=&quot;*&quot; /&gt;
                        &lt;CommitmentTypeIndication Level=&quot;FAIL&quot;&gt;
                                &lt;Id&gt;1.2.840.113549.1.9.16.6.1&lt;/Id&gt;
                                &lt;Id&gt;1.2.840.113549.1.9.16.6.4&lt;/Id&gt;
                                &lt;Id&gt;1.2.840.113549.1.9.16.6.5&lt;/Id&gt;
                                &lt;Id&gt;1.2.840.113549.1.9.16.6.6&lt;/Id&gt;
                        &lt;/CommitmentTypeIndication&gt;
                        &lt;SignerLocation Level=&quot;FAIL&quot; /&gt;
                        &lt;ContentTimeStamp Level=&quot;FAIL&quot; /&gt; --&gt;</span>
                <span class="tag">&lt;/SignedAttributes&gt;</span>
                <span class="tag">&lt;UnsignedAttributes&gt;</span>
<span class="comment">&lt;!--                &lt;CounterSignature Level=&quot;IGNORE&quot; /&gt; check presence --&gt;</span>
                <span class="tag">&lt;/UnsignedAttributes&gt;</span>
        <span class="tag">&lt;/SignatureConstraints&gt;</span>
        <span class="tag">&lt;Timestamp&gt;</span>
                <span class="tag">&lt;TimestampDelay</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">Unit</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">DAYS</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">Value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                <span class="tag">&lt;MessageImprintDataFound</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                <span class="tag">&lt;MessageImprintDataIntact</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                <span class="tag">&lt;RevocationTimeAgainstBestSignatureTime</span>        <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                <span class="tag">&lt;BestSignatureTimeBeforeIssuanceDateOfSigningCertificate</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                <span class="tag">&lt;SigningCertificateValidityAtBestSignatureTime</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                <span class="tag">&lt;AlgorithmReliableAtBestSignatureTime</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                <span class="tag">&lt;Coherence</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">WARN</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                <span class="tag">&lt;BasicSignatureConstraints&gt;</span>
                        <span class="tag">&lt;ReferenceDataExistence</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                        <span class="tag">&lt;ReferenceDataIntact</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                        <span class="tag">&lt;SignatureIntact</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                        <span class="tag">&lt;ProspectiveCertificateChain</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">WARN</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                        <span class="tag">&lt;SigningCertificate&gt;</span>
                                <span class="tag">&lt;Recognition</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;Signature</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;NotExpired</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;RevocationDataAvailable</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;RevocationDataNextUpdatePresent</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">WARN</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;RevocationDataFreshness</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">WARN</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;NotRevoked</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;NotOnHold</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;NotSelfSigned</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">WARN</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;Cryptographic</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                                        <span class="tag">&lt;AcceptableEncryptionAlgo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>RSA<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>DSA<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>ECDSA<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;/AcceptableEncryptionAlgo&gt;</span>
                                        <span class="tag">&lt;MiniPublicKeySize&gt;</span>
                                                <span class="tag">&lt;Algo</span> <span class="attribute-name">Size</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">128</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>DSA<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo</span> <span class="attribute-name">Size</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">1024</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>RSA<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo</span> <span class="attribute-name">Size</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">192</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>ECDSA<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;/MiniPublicKeySize&gt;</span>
                                        <span class="tag">&lt;AcceptableDigestAlgo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA1<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA224<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA256<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA384<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA512<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA3-224<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA3-256<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA3-384<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA3-512<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>RIPEMD160<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;/AcceptableDigestAlgo&gt;</span>
                                <span class="tag">&lt;/Cryptographic&gt;</span>
                        <span class="tag">&lt;/SigningCertificate&gt;</span>
                        <span class="tag">&lt;CACertificate&gt;</span>
                                <span class="tag">&lt;Signature</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;NotExpired</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;RevocationDataAvailable</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">WARN</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;RevocationDataNextUpdatePresent</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">WARN</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;RevocationDataFreshness</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">WARN</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;NotRevoked</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;NotOnHold</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;Cryptographic</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                                        <span class="tag">&lt;AcceptableEncryptionAlgo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>RSA<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>DSA<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>ECDSA<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;/AcceptableEncryptionAlgo&gt;</span>
                                        <span class="tag">&lt;MiniPublicKeySize&gt;</span>
                                                <span class="tag">&lt;Algo</span> <span class="attribute-name">Size</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">128</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>DSA<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo</span> <span class="attribute-name">Size</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">1024</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>RSA<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo</span> <span class="attribute-name">Size</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">192</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>ECDSA<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;/MiniPublicKeySize&gt;</span>
                                        <span class="tag">&lt;AcceptableDigestAlgo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA1<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA224<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA256<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA384<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA512<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA3-224<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA3-256<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA3-384<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA3-512<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>RIPEMD160<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;/AcceptableDigestAlgo&gt;</span>
                                <span class="tag">&lt;/Cryptographic&gt;</span>
                        <span class="tag">&lt;/CACertificate&gt;</span>
                        <span class="tag">&lt;Cryptographic</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                                <span class="tag">&lt;AcceptableEncryptionAlgo&gt;</span>
                                        <span class="tag">&lt;Algo&gt;</span>RSA<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;Algo&gt;</span>DSA<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;Algo&gt;</span>ECDSA<span class="tag">&lt;/Algo&gt;</span>
                                <span class="tag">&lt;/AcceptableEncryptionAlgo&gt;</span>
                                <span class="tag">&lt;MiniPublicKeySize&gt;</span>
                                        <span class="tag">&lt;Algo</span> <span class="attribute-name">Size</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">128</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>DSA<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;Algo</span> <span class="attribute-name">Size</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">1024</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>RSA<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;Algo</span> <span class="attribute-name">Size</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">192</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>ECDSA<span class="tag">&lt;/Algo&gt;</span>
                                <span class="tag">&lt;/MiniPublicKeySize&gt;</span>
                                <span class="tag">&lt;AcceptableDigestAlgo&gt;</span>
                                        <span class="tag">&lt;Algo&gt;</span>SHA1<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;Algo&gt;</span>SHA224<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;Algo&gt;</span>SHA256<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;Algo&gt;</span>SHA384<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;Algo&gt;</span>SHA512<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;Algo&gt;</span>SHA3-224<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;Algo&gt;</span>SHA3-256<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;Algo&gt;</span>SHA3-384<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;Algo&gt;</span>SHA3-512<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;Algo&gt;</span>RIPEMD160<span class="tag">&lt;/Algo&gt;</span>
                                <span class="tag">&lt;/AcceptableDigestAlgo&gt;</span>
                        <span class="tag">&lt;/Cryptographic&gt;</span>
                <span class="tag">&lt;/BasicSignatureConstraints&gt;</span>
        <span class="tag">&lt;/Timestamp&gt;</span>
        <span class="tag">&lt;Revocation&gt;</span>
                <span class="tag">&lt;RevocationFreshness</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">Unit</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">DAYS</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">Value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                <span class="tag">&lt;BasicSignatureConstraints&gt;</span>
                        <span class="tag">&lt;ReferenceDataExistence</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                        <span class="tag">&lt;ReferenceDataIntact</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                        <span class="tag">&lt;SignatureIntact</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                        <span class="tag">&lt;ProspectiveCertificateChain</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">WARN</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                        <span class="tag">&lt;SigningCertificate&gt;</span>
                                <span class="tag">&lt;Recognition</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;Signature</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;NotExpired</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;RevocationDataAvailable</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;RevocationDataNextUpdatePresent</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">WARN</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;RevocationDataFreshness</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">WARN</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;NotRevoked</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;NotOnHold</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;Cryptographic</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">WARN</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                                        <span class="tag">&lt;AcceptableEncryptionAlgo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>RSA<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>DSA<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>ECDSA<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;/AcceptableEncryptionAlgo&gt;</span>
                                        <span class="tag">&lt;MiniPublicKeySize&gt;</span>
                                                <span class="tag">&lt;Algo</span> <span class="attribute-name">Size</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">128</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>DSA<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo</span> <span class="attribute-name">Size</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">1024</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>RSA<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo</span> <span class="attribute-name">Size</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">192</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>ECDSA<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;/MiniPublicKeySize&gt;</span>
                                        <span class="tag">&lt;AcceptableDigestAlgo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA1<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA224<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA256<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA384<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA512<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA3-224<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA3-256<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA3-384<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA3-512<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>RIPEMD160<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;/AcceptableDigestAlgo&gt;</span>
                                <span class="tag">&lt;/Cryptographic&gt;</span>
                        <span class="tag">&lt;/SigningCertificate&gt;</span>
                        <span class="tag">&lt;CACertificate&gt;</span>
                                <span class="tag">&lt;Signature</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;NotExpired</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;RevocationDataAvailable</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">WARN</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;RevocationDataNextUpdatePresent</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">WARN</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;RevocationDataFreshness</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">WARN</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;NotRevoked</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;NotOnHold</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                                <span class="tag">&lt;Cryptographic</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                                        <span class="tag">&lt;AcceptableEncryptionAlgo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>RSA<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>DSA<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>ECDSA<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;/AcceptableEncryptionAlgo&gt;</span>
                                        <span class="tag">&lt;MiniPublicKeySize&gt;</span>
                                                <span class="tag">&lt;Algo</span> <span class="attribute-name">Size</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">128</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>DSA<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo</span> <span class="attribute-name">Size</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">1024</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>RSA<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo</span> <span class="attribute-name">Size</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">192</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>ECDSA<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;/MiniPublicKeySize&gt;</span>
                                        <span class="tag">&lt;AcceptableDigestAlgo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA1<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA224<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA256<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA384<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA512<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA3-224<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA3-256<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA3-384<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>SHA3-512<span class="tag">&lt;/Algo&gt;</span>
                                                <span class="tag">&lt;Algo&gt;</span>RIPEMD160<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;/AcceptableDigestAlgo&gt;</span>
                                <span class="tag">&lt;/Cryptographic&gt;</span>
                        <span class="tag">&lt;/CACertificate&gt;</span>
                        <span class="tag">&lt;Cryptographic</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                                <span class="tag">&lt;AcceptableEncryptionAlgo&gt;</span>
                                        <span class="tag">&lt;Algo&gt;</span>RSA<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;Algo&gt;</span>DSA<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;Algo&gt;</span>ECDSA<span class="tag">&lt;/Algo&gt;</span>
                                <span class="tag">&lt;/AcceptableEncryptionAlgo&gt;</span>
                                <span class="tag">&lt;MiniPublicKeySize&gt;</span>
                                        <span class="tag">&lt;Algo</span> <span class="attribute-name">Size</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">128</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>DSA<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;Algo</span> <span class="attribute-name">Size</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">1024</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>RSA<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;Algo</span> <span class="attribute-name">Size</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">192</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>ECDSA<span class="tag">&lt;/Algo&gt;</span>
                                <span class="tag">&lt;/MiniPublicKeySize&gt;</span>
                                <span class="tag">&lt;AcceptableDigestAlgo&gt;</span>
                                        <span class="tag">&lt;Algo&gt;</span>SHA1<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;Algo&gt;</span>SHA224<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;Algo&gt;</span>SHA256<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;Algo&gt;</span>SHA384<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;Algo&gt;</span>SHA512<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;Algo&gt;</span>SHA3-224<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;Algo&gt;</span>SHA3-256<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;Algo&gt;</span>SHA3-384<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;Algo&gt;</span>SHA3-512<span class="tag">&lt;/Algo&gt;</span>
                                        <span class="tag">&lt;Algo&gt;</span>RIPEMD160<span class="tag">&lt;/Algo&gt;</span>
                                <span class="tag">&lt;/AcceptableDigestAlgo&gt;</span>
                        <span class="tag">&lt;/Cryptographic&gt;</span>
                <span class="tag">&lt;/BasicSignatureConstraints&gt;</span>
        <span class="tag">&lt;/Revocation&gt;</span>
        <span class="tag">&lt;Cryptographic</span> <span class="tag">/&gt;</span>
        <span class="comment">&lt;!-- &lt;Cryptographic&gt; &lt;AlgoExpirationDate Format=&quot;yyyy-MM-dd&quot;&gt; &lt;Algo Date=&quot;2017-02-24&quot;&gt;SHA1&lt;/Algo&gt; &lt;Algo Date=&quot;2035-02-24&quot;&gt;SHA224&lt;/Algo&gt; &lt;Algo Date=&quot;2035-02-24&quot;&gt;SHA256&lt;/Algo&gt; &lt;Algo
                Date=&quot;2035-02-24&quot;&gt;SHA384&lt;/Algo&gt; &lt;Algo Date=&quot;2035-02-24&quot;&gt;SHA512&lt;/Algo&gt; &lt;Algo Date=&quot;2017-02-24&quot;&gt;RIPEMD160&lt;/Algo&gt; &lt;Algo Date=&quot;2017-02-24&quot;&gt;DSA128&lt;/Algo&gt; &lt;Algo Date=&quot;2015-02-24&quot;&gt;RSA1024&lt;/Algo&gt;
                &lt;Algo Date=&quot;2015-02-24&quot;&gt;RSA1536&lt;/Algo&gt; &lt;Algo Date=&quot;2020-02-24&quot;&gt;RSA2048&lt;/Algo&gt; &lt;Algo Date=&quot;2020-02-24&quot;&gt;RSA3072&lt;/Algo&gt; &lt;Algo Date=&quot;2035-02-24&quot;&gt;RSA4096&lt;/Algo&gt; &lt;Algo Date=&quot;2035-02-24&quot;&gt;ECDSA192&lt;/Algo&gt;
                &lt;Algo Date=&quot;2035-02-24&quot;&gt;ECDSA256&lt;/Algo&gt; &lt;/AlgoExpirationDate&gt; &lt;/Cryptographic&gt; --&gt;</span>

        <span class="comment">&lt;!-- eIDAS REGL 910/EU/2014 --&gt;</span>
        <span class="tag">&lt;eIDAS&gt;</span>
                <span class="tag">&lt;TLFreshness</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">WARN</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">Unit</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">HOURS</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">Value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">6</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                <span class="tag">&lt;TLNotExpired</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                <span class="tag">&lt;TLWellSigned</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">WARN</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                <span class="tag">&lt;TLVersion</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">5</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
                <span class="tag">&lt;TLConsistency</span> <span class="attribute-name">Level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FAIL</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
        <span class="tag">&lt;/eIDAS&gt;</span>
<span class="tag">&lt;/ConstraintsParameters&gt;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_cades_signature_cms"><a class="anchor" href="#_cades_signature_cms"></a>CAdES signature (CMS)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To familiarise yourself with this type of signature it is advisable to read the following document:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CAdES Specifications (cf. <a href="#R02">[R02]</a>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To implement this form of signature you can use the XAdES examples. You only need to instantiate the CAdES object service and change the SignatureLevel parameter value. Below is an example of the CAdES-Baseline-B signature:</p>
</div>
<div class="listingblock">
<div class="title">Signing a file with CAdES</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// Preparing parameters for the CAdES signature</span>
CAdESSignatureParameters parameters = <span class="keyword">new</span> CAdESSignatureParameters();
<span class="comment">// We choose the level of the signature (-B, -T, -LT, -LTA).</span>
parameters.setSignatureLevel(SignatureLevel.CAdES_BASELINE_B);
<span class="comment">// We choose the type of the signature packaging (ENVELOPING, DETACHED).</span>
parameters.setSignaturePackaging(SignaturePackaging.ENVELOPING);
<span class="comment">// We set the digest algorithm to use with the signature algorithm. You must use the</span>
<span class="comment">// same parameter when you invoke the method sign on the token. The default value is</span>
<span class="comment">// SHA256</span>
parameters.setDigestAlgorithm(DigestAlgorithm.SHA256);

<span class="comment">// We set the signing certificate</span>
parameters.setSigningCertificate(privateKey.getCertificate());
<span class="comment">// We set the certificate chain</span>
parameters.setCertificateChain(privateKey.getCertificateChain());

<span class="comment">// Create common certificate verifier</span>
CommonCertificateVerifier commonCertificateVerifier = <span class="keyword">new</span> CommonCertificateVerifier();
<span class="comment">// Create CAdES xadesService for signature</span>
CAdESService service = <span class="keyword">new</span> CAdESService(commonCertificateVerifier);

<span class="comment">// Get the SignedInfo segment that need to be signed.</span>
ToBeSigned dataToSign = service.getDataToSign(toSignDocument, parameters);

<span class="comment">// This function obtains the signature value for signed information using the</span>
<span class="comment">// private key and specified algorithm</span>
DigestAlgorithm digestAlgorithm = parameters.getDigestAlgorithm();
SignatureValue signatureValue = signingToken.sign(dataToSign, digestAlgorithm, privateKey);

<span class="comment">// We invoke the xadesService to sign the document with the signature value obtained in</span>
<span class="comment">// the previous step.</span>
DSSDocument signedDocument = service.signDocument(toSignDocument, parameters, signatureValue);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_pades_signature_pdf"><a class="anchor" href="#_pades_signature_pdf"></a>PAdES signature (PDF)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The standard ISO 32000-1 (cf. <a href="#R05">[R05]</a>) allows defining a file format for portable electronic documents. It is based on PDF 1.7 of Adobe Systems. Concerning the digital signature it supports three operations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Adding a digital signature to a document,</p>
</li>
<li>
<p>Providing a placeholder field for signatures,</p>
</li>
<li>
<p>Checking signatures for validity.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>PAdES defines eight different profiles to be used with advanced electronic signature in the meaning of European Union Directive 1999/93/EC (cf. <a href="#R06">[R06]</a>):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>PAdES Basic - PDF signature as specified in ISO 32000-1 (cf. <a href="#R05">[R05]</a>). The profile is specified in ETSI EN 319 142 (cf. <a href="#R03">[R03]</a>).</p>
</li>
<li>
<p>PAdES-BES Profile - based upon CAdES-BES as specified in ETSI EN 319 122 (cf. <a href="#R02">[R02]</a>) with the option of a signature time-stamp (CAdES-T).</p>
</li>
<li>
<p>PAdES-EPES profile - based upon CAdES-EPES as specified in ETSI EN 319 122 (cf. <a href="#R02">[R02]</a>). This profile is the same as the PAdES - BES with the addition of a signature policy identifier and optionally a commitment type indication.</p>
</li>
<li>
<p>PAdES-LTV Profile - This profile supports the long term validation of PDF Signatures and can be used in conjunction with the above-mentioned profiles.</p>
</li>
<li>
<p>Four other PAdES profiles for XML Content.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To familiarise yourself with this type of signature it is advisable to read the documents referenced above.</p>
</div>
<div class="paragraph">
<p>Below is an example of code to perform a PAdES-BASELINE-B type signature:</p>
</div>
<div class="listingblock">
<div class="title">Signing a PDF file with PAdES</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// Preparing parameters for the PAdES signature</span>
PAdESSignatureParameters parameters = <span class="keyword">new</span> PAdESSignatureParameters();
<span class="comment">// We choose the level of the signature (-B, -T, -LT, -LTA).</span>
parameters.setSignatureLevel(SignatureLevel.PAdES_BASELINE_B);
<span class="comment">// We set the digest algorithm to use with the signature algorithm. You must use the</span>
<span class="comment">// same parameter when you invoke the method sign on the token. The default value is</span>
<span class="comment">// SHA256</span>
parameters.setDigestAlgorithm(DigestAlgorithm.SHA256);

<span class="comment">// We set the signing certificate</span>
parameters.setSigningCertificate(privateKey.getCertificate());
<span class="comment">// We set the certificate chain</span>
parameters.setCertificateChain(privateKey.getCertificateChain());

<span class="comment">// Create common certificate verifier</span>
CommonCertificateVerifier commonCertificateVerifier = <span class="keyword">new</span> CommonCertificateVerifier();
<span class="comment">// Create PAdESService for signature</span>
PAdESService service = <span class="keyword">new</span> PAdESService(commonCertificateVerifier);

<span class="comment">// Get the SignedInfo segment that need to be signed.</span>
ToBeSigned dataToSign = service.getDataToSign(toSignDocument, parameters);

<span class="comment">// This function obtains the signature value for signed information using the</span>
<span class="comment">// private key and specified algorithm</span>
DigestAlgorithm digestAlgorithm = parameters.getDigestAlgorithm();
SignatureValue signatureValue = signingToken.sign(dataToSign, digestAlgorithm, privateKey);

<span class="comment">// We invoke the xadesService to sign the document with the signature value obtained in</span>
<span class="comment">// the previous step.</span>
DSSDocument signedDocument = service.signDocument(toSignDocument, parameters, signatureValue);</code></pre>
</div>
</div>
<div class="paragraph">
<p>To add the timestamp to the signature (PAdES-T or LTA), please provide TSP source to the service.</p>
</div>
<div class="paragraph">
<p>To create PAdES-BASELINE-B level with additional options: signature policy identifier and optionally a commitment type indication, please observe the following example in code 5.</p>
</div>
<div class="paragraph">
<p>All these parameters are optional.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>SignaturePolicyOID :</strong> The string representation of the OID of the signature policy to use when signing.</p>
</li>
<li>
<p><strong>SignaturePolicyHashValue :</strong> The value of the hash of the signature policy, computed the same way as in clause 5.2.9 of CAdES (ETSI EN 319 122 (cf. <a href="#R02">[R02]</a>)).</p>
</li>
<li>
<p><strong>SignaturePolicyHashAlgorithm :</strong> The hash function used to compute the value of the SignaturePolicyHashValue entry. Entries must be represented the same way as in table 257 of ISO 32000-1 (cf. <a href="#R05">[R05]</a>).</p>
</li>
<li>
<p><strong>SignaturePolicyCommitmentType :</strong> If the SignaturePolicyOID is present, this array defines the commitment types that can be used within the signature policy. An empty string can be used to indicate the default commitment type.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the SignaturePolicyOID is absent, the three other fields defined above will be ignored. If the SignaturePolicyOID is present but the SignaturePolicyCommitmentType is absent, all commitments defined by the signature policy will be used.</p>
</div>
<div class="paragraph">
<p>The extension of a signature of the level PAdES-BASELINE-B up to PAdES-BASELINE-LTA profile will add the following features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Addition of validation data to an existing PDF document which may be used to validate earlier signatures within the document (including PDF signatures and time-stamp signatures).</p>
</li>
<li>
<p>Addition of a document time-stamp which protects the existing document and any validation data.</p>
</li>
<li>
<p>Further validation data and document time-stamp may be added to a document over time to maintain its authenticity and integrity.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_pades_visible_signature"><a class="anchor" href="#_pades_visible_signature"></a>PAdES Visible Signature</h3>
<div class="paragraph">
<p>The framework also allows to create PDF files with visible signature as specified in ETSI EN 319 142 (cf. <a href="#R03">[R03]</a>). In the SignatureParameters object, there&#8217;s a special attribute named ImageParameters. This parameter let you custom the visual signature (with text, with image or with image and text).
Below is an example of code to perform a PADES-BASELINE-B type signature with a visible signature:</p>
</div>
<div class="listingblock">
<div class="title">Add a visible signature to a PDF document</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// Preparing parameters for the PAdES signature</span>
PAdESSignatureParameters parameters = <span class="keyword">new</span> PAdESSignatureParameters();
<span class="comment">// We choose the level of the signature (-B, -T, -LT, -LTA).</span>
parameters.setSignatureLevel(SignatureLevel.PAdES_BASELINE_B);

<span class="comment">// We set the signing certificate</span>
parameters.setSigningCertificate(privateKey.getCertificate());
<span class="comment">// We set the certificate chain</span>
parameters.setCertificateChain(privateKey.getCertificateChain());

<span class="comment">// Initialize visual signature</span>
SignatureImageParameters imageParameters = <span class="keyword">new</span> SignatureImageParameters();
<span class="comment">// the origin is the left and top corner of the page</span>
imageParameters.setxAxis(<span class="integer">200</span>);
imageParameters.setyAxis(<span class="integer">500</span>);

<span class="comment">// Initialize text to generate for visual signature</span>
SignatureImageTextParameters textParameters = <span class="keyword">new</span> SignatureImageTextParameters();
textParameters.setFont(<span class="keyword">new</span> <span class="predefined-type">Font</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">serif</span><span class="delimiter">&quot;</span></span>, <span class="predefined-type">Font</span>.PLAIN, <span class="integer">14</span>));
textParameters.setTextColor(<span class="predefined-type">Color</span>.BLUE);
textParameters.setText(<span class="string"><span class="delimiter">&quot;</span><span class="content">My visual signature</span><span class="delimiter">&quot;</span></span>);
imageParameters.setTextParameters(textParameters);

parameters.setSignatureImageParameters(imageParameters);

<span class="comment">// Create common certificate verifier</span>
CommonCertificateVerifier commonCertificateVerifier = <span class="keyword">new</span> CommonCertificateVerifier();
<span class="comment">// Create PAdESService for signature</span>
PAdESService service = <span class="keyword">new</span> PAdESService(commonCertificateVerifier);

<span class="comment">// Get the SignedInfo segment that need to be signed.</span>
ToBeSigned dataToSign = service.getDataToSign(toSignDocument, parameters);

<span class="comment">// This function obtains the signature value for signed information using the</span>
<span class="comment">// private key and specified algorithm</span>
DigestAlgorithm digestAlgorithm = parameters.getDigestAlgorithm();
SignatureValue signatureValue = signingToken.sign(dataToSign, digestAlgorithm, privateKey);

<span class="comment">// We invoke the xadesService to sign the document with the signature value obtained in</span>
<span class="comment">// the previous step.</span>
DSSDocument signedDocument = service.signDocument(toSignDocument, parameters, signatureValue);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Additionally, DSS also allows to insert a visible signature in an existing field :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">parameters.setSignatureFieldId(<span class="string"><span class="delimiter">&quot;</span><span class="content">field-id</span><span class="delimiter">&quot;</span></span>);</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_asic_signature_containers"><a class="anchor" href="#_asic_signature_containers"></a>ASiC signature (containers)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When creating a digital signature, the user must choose between different packaging elements, namely enveloping, enveloped or detached. This choice is not obvious, because in one case the signature will alter the signed document and in the other case it is possible to lose the association between the signed document and its signature. That&#8217;s where the standard ETSI EN 319 162 (cf. <a href="#R04">[R04]</a>) offers a standardized use of container forms to establish a common way for associating data objects with advanced signatures or time-stamp tokens.</p>
</div>
<div class="paragraph">
<p>A number of application environments use ZIP based container formats to package sets of files together with meta-information. ASiC technical specification is designed to operate with a range of such ZIP based application environments. Rather than enforcing a single packaging structure, ASiC describes how these package formats can be used to associate advanced electronic signatures with any data objects.</p>
</div>
<div class="paragraph">
<p>The standard defines two types of containers; the first (ASiC-S) allows you to associate one or more signatures with a single data element. In this case the structure of the signature can be based (in a general way) on a single CAdES signature or on multiple XAdES signatures or finally on a single TST; the second is an extended container (ASiC-E) that includes multiple data objects. Each data object may be signed by one or more signatures which structure is similar to ASiC-S. This second type of container is compatible with OCF, UCF and ODF formats.</p>
</div>
<div class="paragraph">
<p>For the moment the DSS framework has some restrictions on the containers you can generate, depending on the input file. If the input file is already an ASiC container, the output container must be the same type of container based on the same type of signature. If the input is any other file, the output does not have any restriction.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Input</th>
<th class="tableblock halign-left valign-top">Output</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ASiC-S CAdES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ASiC-S CAdES</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ASiC-S XAdES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ASiC-S XAdES</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ASiC-E CAdES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ASiC-E CAdES</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ASiC-E XAdES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ASiC-E XAdES</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Binary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ASiC-S CAdES, ASiC-S XAdES, ASiC-E CAdES, ASiC-E XAdES</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>This is an example of the source code for signing a document using ASiCS-S based on XAdES-B:</p>
</div>
<div class="listingblock">
<div class="title">Sign a file within an ASiC-S container</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// Preparing parameters for the AsicS signature</span>
ASiCWithXAdESSignatureParameters parameters = <span class="keyword">new</span> ASiCWithXAdESSignatureParameters();
<span class="comment">// We choose the level of the signature (-B, -T, -LT, LTA).</span>
parameters.setSignatureLevel(SignatureLevel.XAdES_BASELINE_B);
<span class="comment">// We choose the container type (ASiC-S or ASiC-E)</span>
parameters.aSiC().setContainerType(ASiCContainerType.ASiC_S);

<span class="comment">// We set the digest algorithm to use with the signature algorithm. You must use the</span>
<span class="comment">// same parameter when you invoke the method sign on the token. The default value is</span>
<span class="comment">// SHA256</span>
parameters.setDigestAlgorithm(DigestAlgorithm.SHA256);

<span class="comment">// We set the signing certificate</span>
parameters.setSigningCertificate(privateKey.getCertificate());
<span class="comment">// We set the certificate chain</span>
parameters.setCertificateChain(privateKey.getCertificateChain());

<span class="comment">// Create common certificate verifier</span>
CommonCertificateVerifier commonCertificateVerifier = <span class="keyword">new</span> CommonCertificateVerifier();
<span class="comment">// Create ASiC service for signature</span>
ASiCWithXAdESService service = <span class="keyword">new</span> ASiCWithXAdESService(commonCertificateVerifier);

<span class="comment">// Get the SignedInfo segment that need to be signed.</span>
ToBeSigned dataToSign = service.getDataToSign(toSignDocument, parameters);

<span class="comment">// This function obtains the signature value for signed information using the</span>
<span class="comment">// private key and specified algorithm</span>
DigestAlgorithm digestAlgorithm = parameters.getDigestAlgorithm();
SignatureValue signatureValue = signingToken.sign(dataToSign, digestAlgorithm, privateKey);

<span class="comment">// We invoke the xadesService to sign the document with the signature value obtained in</span>
<span class="comment">// the previous step.</span>
DSSDocument signedDocument = service.signDocument(toSignDocument, parameters, signatureValue);</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is another example of the source code for signing multiple documents using ASiCS-E based on CAdES:</p>
</div>
<div class="listingblock">
<div class="title">Sign multiple files within an ASiC-E container</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// Preparing the documents to be embedded in the container and signed</span>
<span class="predefined-type">List</span>&lt;DSSDocument&gt; documentsToBeSigned = <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;DSSDocument&gt;();
documentsToBeSigned.add(<span class="keyword">new</span> FileDocument(<span class="string"><span class="delimiter">&quot;</span><span class="content">src/main/resources/hello-world.pdf</span><span class="delimiter">&quot;</span></span>));
documentsToBeSigned.add(<span class="keyword">new</span> FileDocument(<span class="string"><span class="delimiter">&quot;</span><span class="content">src/main/resources/xml_example.xml</span><span class="delimiter">&quot;</span></span>));

<span class="comment">// Preparing parameters for the ASiC-E signature</span>
ASiCWithCAdESSignatureParameters parameters = <span class="keyword">new</span> ASiCWithCAdESSignatureParameters();

<span class="comment">// We choose the level of the signature (-B, -T, -LT or -LTA).</span>
parameters.setSignatureLevel(SignatureLevel.CAdES_BASELINE_B);
<span class="comment">// We choose the container type (ASiC-S pr ASiC-E)</span>
parameters.aSiC().setContainerType(ASiCContainerType.ASiC_E);

<span class="comment">// We set the digest algorithm to use with the signature algorithm. You</span>
<span class="comment">// must use the</span>
<span class="comment">// same parameter when you invoke the method sign on the token. The</span>
<span class="comment">// default value is</span>
<span class="comment">// SHA256</span>
parameters.setDigestAlgorithm(DigestAlgorithm.SHA256);

<span class="comment">// We set the signing certificate</span>
parameters.setSigningCertificate(privateKey.getCertificate());
<span class="comment">// We set the certificate chain</span>
parameters.setCertificateChain(privateKey.getCertificateChain());

<span class="comment">// Create common certificate verifier</span>
CommonCertificateVerifier commonCertificateVerifier = <span class="keyword">new</span> CommonCertificateVerifier();
<span class="comment">// Create ASiC service for signature</span>
ASiCWithCAdESService service = <span class="keyword">new</span> ASiCWithCAdESService(commonCertificateVerifier);

<span class="comment">// Get the SignedInfo segment that need to be signed.</span>
ToBeSigned dataToSign = service.getDataToSign(documentsToBeSigned, parameters);

<span class="comment">// This function obtains the signature value for signed information</span>
<span class="comment">// using the</span>
<span class="comment">// private key and specified algorithm</span>
DigestAlgorithm digestAlgorithm = parameters.getDigestAlgorithm();
SignatureValue signatureValue = signingToken.sign(dataToSign, digestAlgorithm, privateKey);

<span class="comment">// We invoke the xadesService to sign the document with the signature</span>
<span class="comment">// value obtained in</span>
<span class="comment">// the previous step.</span>
DSSDocument signedDocument = service.signDocument(documentsToBeSigned, parameters, signatureValue);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Please note that you need to pass only few parameters to the service. Other parameters, although are positioned, will be overwritten by the internal implementation of the service. Therefore, the obtained signature is always based on CAdES and of DETACHED packaging.</p>
</div>
<div class="paragraph">
<p>It is also possible with the framework DSS to make an extension of an ASiC container to the level XAdES-BASELINE-T or -LT.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_available_implementations_of_dssdocument"><a class="anchor" href="#_available_implementations_of_dssdocument"></a>Available implementations of DSSDocument</h2>
<div class="sectionbody">
<div class="paragraph">
<p>DSS allows to create different kinds of DSSDocument :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>InMemoryDocument : fully loads in memory. This type of DSSDocument can be instantiated with an array of bytes, an InputStream,&#8230;&#8203;</p>
</li>
<li>
<p>FileDocument : refers an existing File</p>
</li>
<li>
<p>DigestDocument : only contains pre-computed digest values for a given document. That allows to avoid sending the full document (detached signatures).</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">DigestDocument</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// Firstly, we load a basic DSSDocument (FileDocument or InMemoryDocument)</span>
DSSDocument fileDocument = <span class="keyword">new</span> FileDocument(<span class="string"><span class="delimiter">&quot;</span><span class="content">src/main/resources/xml_example.xml</span><span class="delimiter">&quot;</span></span>);

<span class="comment">// After that, we create a DigestDocument</span>
DigestDocument digestDocument = <span class="keyword">new</span> DigestDocument();
digestDocument.setName(fileDocument.getName());

<span class="comment">// We add needed digest value(s). Eg : for a SHA-256 based signature</span>
digestDocument.addDigest(DigestAlgorithm.SHA256, fileDocument.getDigest(DigestAlgorithm.SHA256));</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_management_of_signature_tokens"><a class="anchor" href="#_management_of_signature_tokens"></a>Management of signature tokens</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The DSS framework is able to create signatures from PKCS#11, PKCS#12 and MS CAPI. Java 6 is inherently capable of communicating with these kinds of KeyStores. To be independent of the signing media, DSS framework uses an interface named SignatureTokenConnection to manage different implementations of the signing process. The base implementation is able to sign a stream of the data in one step. That means that all the data to be signed needs to be sent to the SSCD. This is the case for MS CAPI. As to the PKCS#11 and PKCS#12, which give to the developer a finer control in the signature operation, the DSS framework implements the AsyncSignatureTokenConnection abstract class that permits to execute the digest operation and signature operation in two different threads or even two different hardwares.</p>
</div>
<div class="paragraph">
<p>This design permits also other card providers/adopters to create own implementations. For example, this can be used for a direct connection to the Smartcard through Java 6 PC/SC.</p>
</div>
<div class="sect2">
<h3 id="_pkcs11"><a class="anchor" href="#_pkcs11"></a>PKCS#11</h3>
<div class="paragraph">
<p>PKCS#11 is widely used to access smart cards and HSMs. Most commercial software uses PKCS#11 to access the signature key of the CA or to enrol user certificates. In the DSS framework, this standard is encapsulated in the class Pkcs11SignatureToken.</p>
</div>
<div class="listingblock">
<div class="title">Pkcs11SignatureToken usage</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">try</span> (Pkcs11SignatureToken token = <span class="keyword">new</span> Pkcs11SignatureToken(<span class="string"><span class="delimiter">&quot;</span><span class="content">C:</span><span class="char">\\</span><span class="content">Windows</span><span class="char">\\</span><span class="content">System32</span><span class="char">\\</span><span class="content">beidpkcs11.dll</span><span class="delimiter">&quot;</span></span>)) {

        <span class="predefined-type">List</span>&lt;DSSPrivateKeyEntry&gt; keys = token.getKeys();
        <span class="keyword">for</span> (DSSPrivateKeyEntry entry : keys) {
                <span class="predefined-type">System</span>.out.println(entry.getCertificate().getCertificate());
        }

        ToBeSigned toBeSigned = <span class="keyword">new</span> ToBeSigned(<span class="string"><span class="delimiter">&quot;</span><span class="content">Hello world</span><span class="delimiter">&quot;</span></span>.getBytes());
        SignatureValue signatureValue = token.sign(toBeSigned, DigestAlgorithm.SHA256, keys.get(<span class="integer">0</span>));

        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Signature value : </span><span class="delimiter">&quot;</span></span> + Utils.toBase64(signatureValue.getValue()));
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_pkcs12"><a class="anchor" href="#_pkcs12"></a>PKCS#12</h3>
<div class="paragraph">
<p>This standard defines a file format commonly used to store the private key and corresponding public key certificate protecting them by password.</p>
</div>
<div class="paragraph">
<p>In order to use this format with the DSS framework you have to go through the class Pkcs12SignatureToken.</p>
</div>
<div class="listingblock">
<div class="title">Pkcs12SignatureToken usage</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">try</span> (Pkcs12SignatureToken token = <span class="keyword">new</span> Pkcs12SignatureToken(<span class="string"><span class="delimiter">&quot;</span><span class="content">src/main/resources/user_a_rsa.p12</span><span class="delimiter">&quot;</span></span>, <span class="keyword">new</span> PasswordProtection(<span class="string"><span class="delimiter">&quot;</span><span class="content">password</span><span class="delimiter">&quot;</span></span>.toCharArray()))) {

        <span class="predefined-type">List</span>&lt;DSSPrivateKeyEntry&gt; keys = token.getKeys();
        <span class="keyword">for</span> (DSSPrivateKeyEntry entry : keys) {
                <span class="predefined-type">System</span>.out.println(entry.getCertificate().getCertificate());
        }

        ToBeSigned toBeSigned = <span class="keyword">new</span> ToBeSigned(<span class="string"><span class="delimiter">&quot;</span><span class="content">Hello world</span><span class="delimiter">&quot;</span></span>.getBytes());
        SignatureValue signatureValue = token.sign(toBeSigned, DigestAlgorithm.SHA256, keys.get(<span class="integer">0</span>));

        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Signature value : </span><span class="delimiter">&quot;</span></span> + Utils.toBase64(signatureValue.getValue()));
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ms_capi"><a class="anchor" href="#_ms_capi"></a>MS CAPI</h3>
<div class="paragraph">
<p>If the middleware for communicating with an SSDC provides a CSP based on MS CAPI specification, then to sign the documents you can use MSCAPISignatureToken class.</p>
</div>
<div class="listingblock">
<div class="title">MSCAPISignatureToken usage</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">try</span> (MSCAPISignatureToken token = <span class="keyword">new</span> MSCAPISignatureToken()) {

        <span class="predefined-type">List</span>&lt;DSSPrivateKeyEntry&gt; keys = token.getKeys();
        <span class="keyword">for</span> (DSSPrivateKeyEntry entry : keys) {
                <span class="predefined-type">System</span>.out.println(entry.getCertificate().getCertificate());
        }

        ToBeSigned toBeSigned = <span class="keyword">new</span> ToBeSigned(<span class="string"><span class="delimiter">&quot;</span><span class="content">Hello world</span><span class="delimiter">&quot;</span></span>.getBytes());
        SignatureValue signatureValue = token.sign(toBeSigned, DigestAlgorithm.SHA256, keys.get(<span class="integer">0</span>));

        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Signature value : </span><span class="delimiter">&quot;</span></span> + Utils.toBase64(signatureValue.getValue()));
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_other_implementations"><a class="anchor" href="#_other_implementations"></a>Other Implementations</h3>
<div class="paragraph">
<p>As you can see, it is easy to add another implementation of the SignatureTokenConnection, thus enabling the framework to use other API than the provided three (PKCS#11, PKCS#12 and MS CAPI). For example, it is likely that in the future PC/SC will be the preferred way of accessing a Smartcard. Although PKCS#11 is currently the most used API, DSS framework is extensible and can use PC/SC. For our design example we propose to use PC/SC to communicate with the Smartcard.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_management_of_certificates_sources"><a class="anchor" href="#_management_of_certificates_sources"></a>Management of certificates sources</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The validation of a certificate requires the access to some other certificates from multiple sources like trusted lists, trust store, the signature itself: certificates can be contained inside or any other source.
Within the framework, an X509 certificate is modelled through the class:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>eu.europa.esig.dss.x509.CertificateToken</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This encapsulation helps make certificate handling more suited to the needs of the validation in the context of trust. Each certificate is unambiguously identified by its issuer DN and serial number. The framework associates a unique internal identifier to each certificate but this identifier is not calculated on the data contained in the certificate and therefore varies from one application to another. However, it is independent of its source. It allows to easily comparing certificates issued by different sources.
Certificate tokens are grouped into pools. A certificate token can be declared in several pools. The class that models a pool is called:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>eu.europa.esig.dss.x509.CertificatePool</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This class allows keeping only one occurrence of the certificate in the given context (i.e. validation).</p>
</div>
<div class="paragraph">
<p>The CertificateSource interface provides abstraction for accessing a certificate, regardless of the source. However, each source has its own type:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>eu.europa.esig.dss.x509.CertificateSourceType</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This information is used, for example, to distinguish between the certificate from a trusted source and the others. A source has one and only one type, but a certificate token can be found in multiple sources.
The DSS framework supplies some standard implementations, but also gives the possibility to implement owner solutions. Among the standard solutions you can find:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>eu.europa.esig.dss.x509.CommonCertificateSource</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This is the superclass of almost of the certificate sources.
It implements the common method CommonCertificateSource#get returns the list of CertificateToken(s) corresponding to the given subject distinguished name. Note that the content of the encapsulated certificates pool can be different from the content of the source. Only CertificateToken(s) present in the source are taken into account.
It exposes also the method CommonCertificateSource#addCertificate which gives the possibility to add manually any X509Certificate as a part of this source and as a part of the encapsulated pool. If the certificate is already present in the pool its source type is associated to the token.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>eu.europa.esig.dss.x509.SignatureCertificateSource</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Some certificate sources are based on data encapsulated within the signature. That means that the set of certificates is available and the software only needs to find the certificate using its subject name. This class adds also new methods to obtain specialized  list of certificates contained in the source:.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>SignatureCertificateSource#getKeyInfoCertificates</p>
</li>
<li>
<p>SignatureCertificateSource#getEncapsulatedCertificates</p>
<div class="ulist">
<ul>
<li>
<p>eu.europa.esig.dss.tsl.TrustedListsCertificateSource</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Certificates coming from the list of Trusted Lists. This class gives the mechanism to define the set of trusted certificates (trust anchors). They are used in the validation process to decide if the prospective certificate chain has a trust anchor. See chapter 5.2 to know more about EU Trusted Lists.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_management_of_crl_and_ocsp_sources"><a class="anchor" href="#_management_of_crl_and_ocsp_sources"></a>Management of CRL and OCSP sources</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A CRL is a time-stamped list identifying revoked certificates. It is signed by a Certificate Authority (CA) and made freely available in a public repository. Each revoked certificate is identified in a CRL by its certificate serial number.</p>
</div>
<div class="paragraph">
<p>The Online Certificate Status Protocol (OCSP) is an Internet protocol used for obtaining the revocation status of an unique X.509 digital certificate.</p>
</div>
<div class="paragraph">
<p>For every certificate, the validity has to be checked via CRL or OCSP responses. The information may originate from different CRLSources or OCSPSources:
For easing the usage of such sources, DSS implements a CRLSource and OCSPSource interfaces (which inherit from RevocationSource), which offer a generic, uniform way of accessing CRL and OCSP sources. Furthermore, a caching mechanism can be easily attached to those sources, optimizing the access time to revocation information by reducing network connections to online servers.</p>
</div>
<div class="paragraph">
<p>The interface CRLSource defines the method which returns CRLToken for the given certificate/issuer certificate couple:</p>
</div>
<div class="listingblock">
<div class="title">CRLSource usage</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CRLToken crlToken = crlSource.getRevocationToken(certificateToken, issuerCertificateToken);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The interface OCSPSource defines the method which returns OCSPToken for the given certificate/issuer certificate couple:</p>
</div>
<div class="listingblock">
<div class="title">OCSPSource usage</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">OCSPToken ocspToken = ocspSource.getRevocationToken(certificateToken, issuerCertificateToken);</code></pre>
</div>
</div>
<div class="paragraph">
<p>We use these classes during the certificate validation process through "validationContext" object (based on ValidationContext class) which is a "cache" for one validation request that contains every object retrieved so far. This object in turn instantiates a "verifier" based on CSPAndCRLCertificateVerifier class whose role is to fetch revocation data by querying an OCSP server first and then a CRL server if no OCSP response could be retrieved.
In general we can distinguish three main sources:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Offline sources;</p>
</li>
<li>
<p>Online sources;</p>
</li>
<li>
<p>Sources with the cache mechanism.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_other_implementations_of_crl_and_ocsp_sources"><a class="anchor" href="#_other_implementations_of_crl_and_ocsp_sources"></a>Other implementations of CRL and OCSP Sources</h3>
<div class="paragraph">
<p>Such sources find the status of a certificate either from a list stored locally or using the information contained in the advanced signature or online way. Here is the list of sources already implemented in the DSS framework:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CRL sources</p>
<div class="ulist">
<ul>
<li>
<p>JdbcCacheCRLSource : Retrieves information from a JDBC datasource</p>
</li>
<li>
<p>OfflineCRLSource : This class that implements in a generic way the findCrl method that operates on the different CRLs implemented in children classes.</p>
<div class="ulist">
<ul>
<li>
<p>ListCRLSource : This source maintains a list of CRLToken.</p>
</li>
<li>
<p>SignatureCRLSource : The advanced signature contains a list of CRL that was needed to validate the signature. This class is a basic skeleton that is able to retrieve the needed CRL from a list. The child needs to retrieve the list of wrapped CRLs.</p>
<div class="ulist">
<ul>
<li>
<p>CAdESCRLSource : Retrieves information from a CAdES signature.</p>
</li>
<li>
<p>PAdESCRLSource : Retrieves information from a PAdES signature.</p>
</li>
<li>
<p>XAdESCRLSource : Retrieves information from a XAdES signature.</p>
</li>
<li>
<p>ExternalResourcesCRLSource : A class that can instantiate a list of certificate revocation lists from a directory where should be the individual lists (each individual list file must end with the extension ".crl").</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>OnlineCRLSource : This is a representation of an Online CRL repository. This implementation will contact using HTTP protocol the CRL Responder to download the CRLs from the given URI. Note that certificate"s Authority Information Access (AIA) extension is used to find issuer&#8217;s resources location like CRT file and/or Online Certificate Status Protocol (OCSP). The URIs of CRL server will be extracted from this property (OID value: 1.3.6.1.5.5.7.48.1.3).</p>
</li>
</ul>
</div>
</li>
<li>
<p>OCSP sources</p>
<div class="ulist">
<ul>
<li>
<p>OfflineOCSPSource : An abstract class that helps to implement OCSPSource with an already loaded list of OCSPToken. It implements in a generic way the getOCSPResponse method that operates on the different OCSP implementations in children classes.</p>
<div class="ulist">
<ul>
<li>
<p>ListOCSPSource : Implements an OCSPSource from a list of OCSPToken.</p>
</li>
<li>
<p>SignatureOCSPSource : The advanced signature contains a list of OCSPResp that was needed to validate the signature. This class is a basic skeleton that is able to retrieve the needed OCSPResp from a list. The children need to retrieve the list of wrapped OCSPResp.</p>
<div class="ulist">
<ul>
<li>
<p>CAdESOCSPSource : Retrieves information from a CAdES signature.</p>
</li>
<li>
<p>PAdESOCSPSource : Retrieves information from a PAdES signature.</p>
</li>
<li>
<p>XAdESOCSPSource : Retrieves information from a XAdES signature.</p>
</li>
<li>
<p>ExternalResourcesOCSPSource : A class that can instantiate a list of OCSPToken from a directory where should be the individual DER Encoded X509 certificates files (each individual file must end with the extension ".der").</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>OnlineOCSPSource : This is a representation of an Online OCSP repository. This implementation will contact using HTTP protocol the OCSP Responder to retrieve the OCSP response. Note that certificate&#8217;s Authority Information Access (AIA) extension is used to find issuer&#8217;s resources location like CRT file and/or Online Certificate Status Protocol (OCSP). The URIs of OCSP server will be extracted from this property (OID value: 1.3.6.1.5.5.7.48.1).</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_certificateverifier_configuration"><a class="anchor" href="#_certificateverifier_configuration"></a>CertificateVerifier configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The CertificateVerifier and its implementation CommonCertificateVerifier determine how DSS accesses to external resources and how it should react in some occasions. This configuration is used in both extension and validation mode.</p>
</div>
<div class="listingblock">
<div class="title">CertificateVerifier usage</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CertificateVerifier cv = <span class="keyword">new</span> CommonCertificateVerifier();

<span class="comment">// This data loader is used to collect certificates from external resources</span>
<span class="comment">// (AIA)</span>
cv.setDataLoader(dataLoader);

<span class="comment">// This certificate source is used to provide missing intermediate certificates</span>
<span class="comment">// (not trusted certificates)</span>
cv.setAdjunctCertSource(adjunctCertSource);

<span class="comment">// This certificate source is used to provide trusted certificates (the trust</span>
<span class="comment">// anchors where the certificate chain building should stop)</span>
cv.setTrustedCertSource(trustedCertSource);

<span class="comment">// The CRL Source to be used for external accesses (can be configured with a</span>
<span class="comment">// cache,...)</span>
cv.setCrlSource(crlSource);

<span class="comment">// The OCSP Source to be used for external accesses (can be configured with a</span>
<span class="comment">// cache,...)</span>
cv.setOcspSource(ocspSource);

<span class="comment">// Define the behavior to be followed by DSS in case of revocation checking for</span>
<span class="comment">// certificates issued from an unsure source (DSS v 5.4+)</span>
<span class="comment">// Default : revocation check is disabled for unsure sources (security reasons)</span>
cv.setCheckRevocationForUntrustedChains(<span class="predefined-constant">false</span>);

<span class="comment">// DSS v 5.4+ : The 3 below configurations concern the extension mode (LT/LTA</span>
<span class="comment">// extension)</span>

<span class="comment">// DSS throws an exception by default in case of missing revocation data</span>
<span class="comment">// Default : true</span>
cv.setExceptionOnMissingRevocationData(<span class="predefined-constant">true</span>);

<span class="comment">// DSS throws an exception if a TSU certificate chain is not covered with a</span>
<span class="comment">// revocation data (timestamp generation time &gt; CRL/OCSP production time).</span>
<span class="comment">// Default : false</span>
cv.setExceptionOnUncoveredPOE(<span class="predefined-constant">true</span>);

<span class="comment">// DSS interrupts by default the extension process if a revoked certificate is</span>
<span class="comment">// present</span>
<span class="comment">// Default : true</span>
cv.setExceptionOnRevokedCertificate(<span class="predefined-constant">true</span>);

<span class="comment">// DSS stops the extension process if an invalid timestamp is met</span>
<span class="comment">// Default : true</span>
cv.setExceptionOnInvalidTimestamp(<span class="predefined-constant">true</span>);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_tsp_sources"><a class="anchor" href="#_tsp_sources"></a>TSP Sources</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Time Stamp Authority by creating time-stamp tokens provides independent and irrefutable proof of time for business transactions, e-documents and digital signatures. The TSA must comply with the IETF RFC 3161 specifications (cf. <a href="#R07">[R07]</a>). A time-stamp is obtained by sending the digest value of the given data and digest algorithm to the Time Stamp Authority. The returned time-stamp is a signed data that contains the digest value, the identity of the TSA, and the time of stamping. This proves that the given data existed before the time of stamping.
The DSS framework proposes TSPSource interface to implement the communication with TSA. The class OnlineTSPSource is the default implementation of TSP using HTTP(S) communication layer.
The following bit of Java code illustrates how you might use this class:</p>
</div>
<div class="listingblock">
<div class="title">OnlineTSPSource usage</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">final</span> <span class="predefined-type">String</span> tspServer = <span class="string"><span class="delimiter">&quot;</span><span class="content">http://tsa.belgium.be/connect</span><span class="delimiter">&quot;</span></span>;
OnlineTSPSource tspSource = <span class="keyword">new</span> OnlineTSPSource(tspServer);

<span class="directive">final</span> DigestAlgorithm digestAlgorithm = DigestAlgorithm.SHA256;
<span class="directive">final</span> <span class="type">byte</span><span class="type">[]</span> toDigest = <span class="string"><span class="delimiter">&quot;</span><span class="content">Hello world</span><span class="delimiter">&quot;</span></span>.getBytes(<span class="string"><span class="delimiter">&quot;</span><span class="content">UTF-8</span><span class="delimiter">&quot;</span></span>);
<span class="directive">final</span> <span class="type">byte</span><span class="type">[]</span> digestValue = DSSUtils.digest(digestAlgorithm, toDigest);
<span class="directive">final</span> TimeStampToken tsr = tspSource.getTimeStampResponse(digestAlgorithm, digestValue);

<span class="predefined-type">System</span>.out.println(DSSUtils.toHex(tsr.getEncoded()));</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_time_stamp_policy"><a class="anchor" href="#_time_stamp_policy"></a>Time-stamp policy</h3>
<div class="paragraph">
<p>A time-stamp policy is a "named set of rules that indicates the applicability of a time-stamp token to a particular community and/or class of application with common security requirements". A TSA may define its own policy which enhances the policy defined in RFC 3628. Such a policy shall incorporate or further constrain the requirements identified in RFC 3628. A time-stamp policy may be defined by the user of times-stamp services.</p>
</div>
</div>
<div class="sect2">
<h3 id="_composite_tsp_source"><a class="anchor" href="#_composite_tsp_source"></a>Composite TSP Source</h3>
<div class="paragraph">
<p>Sometimes, timestamping servers may encounter interruptions (restart,&#8230;&#8203;). To avoid failing signature extension, DSS allows to configure several TSP Sources. DSS will try source by source until getting an usable timestamp token.</p>
</div>
<div class="listingblock">
<div class="title">Configuration of a CompositeTSPSource</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// Create a map with several TSPSources</span>
<span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, TSPSource&gt; tspSources = <span class="keyword">new</span> <span class="predefined-type">HashMap</span>&lt;<span class="predefined-type">String</span>, TSPSource&gt;();
tspSources.put(<span class="string"><span class="delimiter">&quot;</span><span class="content">Poland</span><span class="delimiter">&quot;</span></span>, <span class="keyword">new</span> OnlineTSPSource(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://time.certum.pl/</span><span class="delimiter">&quot;</span></span>));
tspSources.put(<span class="string"><span class="delimiter">&quot;</span><span class="content">Belgium</span><span class="delimiter">&quot;</span></span>, <span class="keyword">new</span> OnlineTSPSource(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://tsa.belgium.be/connect</span><span class="delimiter">&quot;</span></span>));

<span class="comment">// Instantiate a new CompositeTSPSource and set the different sources</span>
CompositeTSPSource tspSource = <span class="keyword">new</span> CompositeTSPSource();
tspSource.setTspSources(tspSources);

<span class="directive">final</span> DigestAlgorithm digestAlgorithm = DigestAlgorithm.SHA256;
<span class="directive">final</span> <span class="type">byte</span><span class="type">[]</span> toDigest = <span class="string"><span class="delimiter">&quot;</span><span class="content">Hello world</span><span class="delimiter">&quot;</span></span>.getBytes(<span class="string"><span class="delimiter">&quot;</span><span class="content">UTF-8</span><span class="delimiter">&quot;</span></span>);
<span class="directive">final</span> <span class="type">byte</span><span class="type">[]</span> digestValue = DSSUtils.digest(digestAlgorithm, toDigest);

<span class="comment">// DSS will request the tsp sources (one by one) until getting a valid token.</span>
<span class="comment">// If none of them succeed, a DSSException is thrown.</span>
<span class="directive">final</span> TimeStampToken tsr = tspSource.getTimeStampResponse(digestAlgorithm, digestValue);

<span class="predefined-type">System</span>.out.println(DSSUtils.toHex(tsr.getEncoded()));</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_supported_algorithms"><a class="anchor" href="#_supported_algorithms"></a>Supported algorithms</h2>
<div class="sectionbody">
<div class="paragraph">
<p>DSS supports several signature algorithms (combination of an encryption algorithm and a digest algorithm). Below, you can find the supported combinations. The support of the algorithms depends of the registered OID (ASN1) or URI (XML).</p>
</div>
<div class="paragraph">
<p>In the next table, XAdES also applies to ASiC with embedded XAdES signatures and CAdES also concerns PAdES and ASiC with embedded CAdES signatures.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
SmartCards/HSMs don&#8217;t allow to sign with all digest algorithms. Please refer to your SmartCard/HSM provider.
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6924%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top">SHA-1</th>
<th class="tableblock halign-center valign-top">SHA-224</th>
<th class="tableblock halign-center valign-top">SHA-256</th>
<th class="tableblock halign-center valign-top">SHA-384</th>
<th class="tableblock halign-center valign-top">SHA-512</th>
<th class="tableblock halign-center valign-top">SHA3-224</th>
<th class="tableblock halign-center valign-top">SHA3-256</th>
<th class="tableblock halign-center valign-top">SHA3-384</th>
<th class="tableblock halign-center valign-top">SHA3-512</th>
<th class="tableblock halign-center valign-top">MD2</th>
<th class="tableblock halign-center valign-top">MD5</th>
<th class="tableblock halign-center valign-top">RIPEMD160</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top" colspan="13"><p class="tableblock"><strong>RSA</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">XAdES</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">CAdES</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="13"><p class="tableblock"><strong>RSA-PSS</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">XAdES</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">CAdES</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="13"><p class="tableblock"><strong>ECDSA</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">XAdES</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">CAdES</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="13"><p class="tableblock"><strong>DSA</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">XAdES</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">CAdES</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="13"><p class="tableblock"><strong>HMAC</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">XAdES</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">CAdES</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_multi_theading"><a class="anchor" href="#_multi_theading"></a>Multi-theading</h2>
<div class="sectionbody">
<div class="paragraph">
<p>DSS can be used in multi-threaded environments but some points need to be considered like resources sharing and caching. All operations are stateless and this fact requires to be maintained. Some resources can be shared, others are proper to an operation.</p>
</div>
<div class="paragraph">
<p>For each provided operation, DSS requires a CertificateVerifier object. This object is responsible to provide certificates and accesses to external resources (AIA, CRL, OCSP,&#8230;&#8203;). At the beginning of all operation, a new internal CertificatePool is created and all available certificates are copied. Throughout the signature/validation process, the CertificatePool content evolves. Certificates are added/updated from the signature, timestamp(s), revocation data,&#8230;&#8203; Revocation data / issuer certificates are collected and added to the certificate. Certificate status are updated to give as much as possible information. For these reasons, integrators need to be careful about the CertificateVerifier configuration.</p>
</div>
<div class="sect2">
<h3 id="_resource_sharing"><a class="anchor" href="#_resource_sharing"></a>Resource sharing</h3>
<div class="paragraph">
<p>The trusted certificates can be shared between multiple threads because these certificates are static. This means they don&#8217;t require more analysis. Their status won&#8217;t evolve. For these certificates, DSS doesn&#8217;t need to collect issuer certificate and/or their revocation data.</p>
</div>
<div class="paragraph">
<p>In opposition, the adjunct certificates cannot be shared. These certificates concern a specific signature/validation operation. This parameter is used to provide missing certificate(s). When DSS is unable to build the complete certificate path with the provided certificates (as signature parameters or embedded within a signature), it is possible to inject not present certificates. These certificates are not necessarily trusted and may require future "modifications" like revocation data collection,&#8230;&#8203;</p>
</div>
</div>
<div class="sect2">
<h3 id="_caching"><a class="anchor" href="#_caching"></a>Caching</h3>
<div class="paragraph">
<p>In case of multi-threading usage, we strongly recommend to cache external resources. All external resources can be cached (AIA, CRL, OCSP) to improve performances and to avoid requesting too much time the same resources. FileCacheDataLoader and JdbcCacheCRLSource can help you in this way.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_additional_features"><a class="anchor" href="#_additional_features"></a>Additional features</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_certificate_validation"><a class="anchor" href="#_certificate_validation"></a>Certificate validation</h3>
<div class="paragraph">
<p>DSS offers the possibility to validate a certificate. For a given certificate, the framework builds a certificate path until a known trust anchor (trusted list, keystore,&#8230;&#8203;), validates each found certificate (OCSP / CRL) and determines its European "qualification".</p>
</div>
<div class="paragraph">
<p>To determine the certificate qualification, DSS follows the draft standard ETSI TS 119 172-4 (<a href="#R09">[R09]</a>). It analyses the certificate properties (QCStatements, Certificate Policies,&#8230;&#8203;) and applies possible overrules from the related trusted list ("catched" qualifiers from a trust service). More information about qualifiers can be found in the standard ETSI TS 119 612 (<a href="#R10">[R10]</a>).</p>
</div>
<div class="paragraph">
<p>DSS always computes the status at 2 different times : certificate issuance and signing/validation time. The certificate qualification can evolve in the time, its status is not immutable (eg: a trust service provider lost its granted status). The eIDAS regulation (<a href="#R11">[R11]</a>) clearly defines these different times in the Article 32 and related Annex I.</p>
</div>
<div class="listingblock">
<div class="title">Validate a certificate and retrieve its qualification level</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// Firstly, we load the certificate to be validated</span>
CertificateToken token = DSSUtils.loadCertificate(<span class="keyword">new</span> <span class="predefined-type">File</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">src/main/resources/keystore/ec.europa.eu.1.cer</span><span class="delimiter">&quot;</span></span>));

<span class="comment">// We need a certificate verifier and configure it  (see specific chapter about the CertificateVerifier configuration)</span>
CertificateVerifier cv = <span class="keyword">new</span> CommonCertificateVerifier();

<span class="comment">// We create an instance of the CertificateValidator with the certificate</span>
CertificateValidator validator = CertificateValidator.fromCertificate(token);
validator.setCertificateVerifier(cv);

<span class="comment">// We execute the validation</span>
CertificateReports certificateReports = validator.validate();

<span class="comment">// We have 3 reports</span>
<span class="comment">// The diagnostic data which contains all used and static data</span>
DiagnosticData diagnosticData = certificateReports.getDiagnosticData();

<span class="comment">// The detailed report which is the result of the process of the diagnostic data and the validation policy</span>
DetailedReport detailedReport = certificateReports.getDetailedReport();

<span class="comment">// The simple report is a summary of the detailed report or diagnostic data (more user-friendly)</span>
SimpleCertificateReport simpleReport = certificateReports.getSimpleReport();</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_extract_the_signed_data_from_a_signature"><a class="anchor" href="#_extract_the_signed_data_from_a_signature"></a>Extract the signed data from a signature</h3>
<div class="paragraph">
<p>DSS is able to retrieve the original data from a valid signature.</p>
</div>
<div class="listingblock">
<div class="title">Retrieve original data from a signed document</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// We have our signed document, we want to retrieve the original/signed data</span>
DSSDocument signedDocument = <span class="keyword">new</span> FileDocument(<span class="string"><span class="delimiter">&quot;</span><span class="content">src/test/resources/signedXmlXadesB.xml</span><span class="delimiter">&quot;</span></span>);

<span class="comment">// We create an instance of DocumentValidator. DSS automatically selects the validator depending of the</span>
<span class="comment">// signature file</span>
SignedDocumentValidator documentValidator = SignedDocumentValidator.fromDocument(signedDocument);

<span class="comment">// We set a certificate verifier. It handles the certificate pool, allows to check the certificate status,...</span>
documentValidator.setCertificateVerifier(<span class="keyword">new</span> CommonCertificateVerifier());

<span class="comment">// We retrieve the found signatures</span>
<span class="predefined-type">List</span>&lt;AdvancedSignature&gt; signatures = documentValidator.getSignatures();

<span class="comment">// We select the wanted signature (the first one in our current case)</span>
AdvancedSignature advancedSignature = signatures.get(<span class="integer">0</span>);

<span class="comment">// We call get original document with the related signature id (DSS unique ID)</span>
<span class="predefined-type">List</span>&lt;DSSDocument&gt; originalDocuments = documentValidator.getOriginalDocuments(advancedSignature.getId());

<span class="comment">// We can have one or more original documents depending of the signature (ASiC, PDF,...)</span>
DSSDocument original = originalDocuments.get(<span class="integer">0</span>);

original.save(<span class="string"><span class="delimiter">&quot;</span><span class="content">target/original.xml</span><span class="delimiter">&quot;</span></span>);</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_rest_services"><a class="anchor" href="#_rest_services"></a>REST Services</h2>
<div class="sectionbody">
<div class="paragraph">
<p>DSS offers some REST and SOAP web services. The documentation will covers the REST calls. Additionally, we also provide a SOAP-UI project and Postman samples in the cookbook module.</p>
</div>
<div class="paragraph">
<p>The different webservices are :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Signature webservices (dss-soap / dss-rest and their clients) : they expose methods to allow to sign or extend a signature from a client.</p>
</li>
<li>
<p>Server-signing webservice (dss-server-signing-soap / dss-server-signing-rest and their clients) : they expose method to retrieve keys from a server (PKCS#11, PKCS#12, HSM,&#8230;&#8203;) and to sign the digest on the server side.</p>
</li>
<li>
<p>Validation webservices (dss-validation-soap / dss-validation-rest and their client) : they expose methods to allow validate a signature, with an optional detached file and an optional validation policy.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The data structure in webservices is similar in REST and SOAP.</p>
</div>
<div class="sect2">
<h3 id="_rest_signature_service"><a class="anchor" href="#_rest_signature_service"></a>REST signature service</h3>
<div class="paragraph">
<p>This service exposes 3 methods for one or more document(s) :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>getDataToSign : computes the digest to be signed</p>
</li>
<li>
<p>signDocument : adds the signature value in the document</p>
</li>
<li>
<p>extendDocument : extends an existing signature</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_get_data_to_sign"><a class="anchor" href="#_get_data_to_sign"></a>Get data to sign</h4>
<div class="paragraph">
<p>The method allows to retrieve the data to be signed. The user sends the document to be signed, the parameters (signature level,&#8230;&#8203;) and the certificate chain.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
The parameters in getDataToSign and signDocument MUST be the same (especially the signing date).
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Request</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="http">POST /services/rest/signature/one-document/getDataToSign HTTP/1.1
Accept: application/json, application/javascript, text/javascript, text/json
Content-Type: application/json; charset=UTF-8
Host: localhost:8080
Content-Length: 2433

{
  &quot;parameters&quot; : {
    &quot;signWithExpiredCertificate&quot; : false,
    &quot;generateTBSWithoutCertificate&quot; : false,
    &quot;signatureLevel&quot; : &quot;CAdES_BASELINE_B&quot;,
    &quot;signaturePackaging&quot; : &quot;ENVELOPING&quot;,
    &quot;signatureAlgorithm&quot; : &quot;RSA_SHA256&quot;,
    &quot;encryptionAlgorithm&quot; : &quot;RSA&quot;,
    &quot;digestAlgorithm&quot; : &quot;SHA256&quot;,
    &quot;referenceDigestAlgorithm&quot; : null,
    &quot;maskGenerationFunction&quot; : null,
    &quot;contentTimestampParameters&quot; : {
      &quot;digestAlgorithm&quot; : &quot;SHA256&quot;,
      &quot;canonicalizationMethod&quot; : &quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;
    },
    &quot;signatureTimestampParameters&quot; : {
      &quot;digestAlgorithm&quot; : &quot;SHA256&quot;,
      &quot;canonicalizationMethod&quot; : &quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;
    },
    &quot;archiveTimestampParameters&quot; : {
      &quot;digestAlgorithm&quot; : &quot;SHA256&quot;,
      &quot;canonicalizationMethod&quot; : &quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;
    },
    &quot;signingCertificate&quot; : {
      &quot;encodedCertificate&quot; : &quot;MIIC6jCCAdKgAwIBAgIGLtYU17tXMA0GCSqGSIb3DQEBCwUAMDAxGzAZBgNVBAMMElJvb3RTZWxmU2lnbmVkRmFrZTERMA8GA1UECgwIRFNTLXRlc3QwHhcNMTcwNjA4MTEyNjAxWhcNNDcwNzA0MDc1NzI0WjAoMRMwEQYDVQQDDApTaWduZXJGYWtlMREwDwYDVQQKDAhEU1MtdGVzdDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMI3kZhtnipn+iiZHZ9ax8FlfE5Ow/cFwBTfAEb3R1ZQUp6/BQnBt7Oo0JWBtc9qkv7JUDdcBJXPV5QWS5AyMPHpqQ75Hitjsq/Fzu8eHtkKpFizcxGa9BZdkQjh4rSrtO1Kjs0Rd5DQtWSgkeVCCN09kN0ZsZ0ENY+Ip8QxSmyztsStkYXdULqpwz4JEXW9vz64eTbde4vQJ6pjHGarJf1gQNEc2XzhmI/prXLysWNqC7lZg7PUZUTrdegABTUzYCRJ1kWBRPm4qo0LN405c94QQd45a5kTgowHzEgLnAQI28x0M3A59TKC+ieNc6VF1PsTLpUw7PNI2VstX5jAuasCAwEAAaMSMBAwDgYDVR0PAQH/BAQDAgEGMA0GCSqGSIb3DQEBCwUAA4IBAQCK6LGA01TR+rmU8p6yhAi4OkDN2b1dbIL8l8iCMYopLCxx8xqq3ubZCOxqh1X2j6pgWzarb0b/MUix00IoUvNbFOxAW7PBZIKDLnm6LsckRxs1U32sC9d1LOHe3WKBNB6GZALT1ewjh7hSbWjftlmcovq+6eVGA5cvf2u/2+TkKkyHV/NR394nXrdsdpvygwypEtXjetzD7UT93Nuw3xcV8VIftIvHf9LjU7h+UjGmKXG9c15eYr3SzUmv6kyOI0Bvw14PWtsWGl0QdOSRvIBBrP4adCnGTgjgjk9LTcO8B8FKrr+8lHGuc0bp4lIUToiUkGILXsiEeEg9WAqm+XqO&quot;
    },
    &quot;certificateChain&quot; : [ ],
    &quot;detachedContents&quot; : null,
    &quot;asicContainerType&quot; : null,
    &quot;blevelParams&quot; : {
      &quot;trustAnchorBPPolicy&quot; : true,
      &quot;signingDate&quot; : 1542794107033,
      &quot;claimedSignerRoles&quot; : null,
      &quot;signaturePolicy&quot; : null,
      &quot;commitmentTypeIndications&quot; : null,
      &quot;signerLocation&quot; : null
    }
  },
  &quot;toSignDocument&quot; : {
    &quot;bytes&quot; : &quot;SGVsbG8=&quot;,
    &quot;digestAlgorithm&quot; : null,
    &quot;name&quot; : &quot;RemoteDocument&quot;,
    &quot;mimeType&quot; : null
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Response</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="http">HTTP/1.1 200 OK
Date: Wed, 21 Nov 2018 09:55:07 GMT
Content-Type: application/json
Transfer-Encoding: chunked
Content-Length: 392

{
  &quot;bytes&quot; : &quot;MYIBETAYBgkqhkiG9w0BCQMxCwYJKoZIhvcNAQcBMBwGCSqGSIb3DQEJBTEPFw0xODExMjEwOTU1MDdaMC0GCSqGSIb3DQEJNDEgMB4wDQYJYIZIAWUDBAIBBQChDQYJKoZIhvcNAQELBQAwLwYJKoZIhvcNAQkEMSIEIBhfjbMicf4l9WGm/JOLLiZDBuwwTtpRgAfRdkgmOBlpMHcGCyqGSIb3DQEJEAIvMWgwZjBkMGIEIALz68oBYydCU7yAnSdJjdQbsDFtfmsGaWARXeFVWJ2cMD4wNKQyMDAxGzAZBgNVBAMMElJvb3RTZWxmU2lnbmVkRmFrZTERMA8GA1UECgwIRFNTLXRlc3QCBi7WFNe7Vw==&quot;
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sign_document"><a class="anchor" href="#_sign_document"></a>Sign document</h4>
<div class="paragraph">
<p>The method allows to generate the signed document with the received signature value.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
The parameters in getDataToSign and signDocument MUST be the same (especially the signing date).
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Request</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="http">POST /services/rest/signature/one-document/signDocument HTTP/1.1
Accept: application/json, application/javascript, text/javascript, text/json
Content-Type: application/json; charset=UTF-8
Host: localhost:8080
Content-Length: 2522

{
  &quot;parameters&quot; : {
    &quot;signWithExpiredCertificate&quot; : false,
    &quot;generateTBSWithoutCertificate&quot; : false,
    &quot;signatureLevel&quot; : &quot;CAdES_BASELINE_B&quot;,
    &quot;signaturePackaging&quot; : &quot;ENVELOPING&quot;,
    &quot;signatureAlgorithm&quot; : &quot;RSA_SHA256&quot;,
    &quot;encryptionAlgorithm&quot; : &quot;RSA&quot;,
    &quot;digestAlgorithm&quot; : &quot;SHA256&quot;,
    &quot;referenceDigestAlgorithm&quot; : null,
    &quot;maskGenerationFunction&quot; : null,
    &quot;contentTimestampParameters&quot; : {
      &quot;digestAlgorithm&quot; : &quot;SHA256&quot;,
      &quot;canonicalizationMethod&quot; : &quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;
    },
    &quot;signatureTimestampParameters&quot; : {
      &quot;digestAlgorithm&quot; : &quot;SHA256&quot;,
      &quot;canonicalizationMethod&quot; : &quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;
    },
    &quot;archiveTimestampParameters&quot; : {
      &quot;digestAlgorithm&quot; : &quot;SHA256&quot;,
      &quot;canonicalizationMethod&quot; : &quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;
    },
    &quot;signingCertificate&quot; : {
      &quot;encodedCertificate&quot; : &quot;MIIC6jCCAdKgAwIBAgIGLtYU17tXMA0GCSqGSIb3DQEBCwUAMDAxGzAZBgNVBAMMElJvb3RTZWxmU2lnbmVkRmFrZTERMA8GA1UECgwIRFNTLXRlc3QwHhcNMTcwNjA4MTEyNjAxWhcNNDcwNzA0MDc1NzI0WjAoMRMwEQYDVQQDDApTaWduZXJGYWtlMREwDwYDVQQKDAhEU1MtdGVzdDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMI3kZhtnipn+iiZHZ9ax8FlfE5Ow/cFwBTfAEb3R1ZQUp6/BQnBt7Oo0JWBtc9qkv7JUDdcBJXPV5QWS5AyMPHpqQ75Hitjsq/Fzu8eHtkKpFizcxGa9BZdkQjh4rSrtO1Kjs0Rd5DQtWSgkeVCCN09kN0ZsZ0ENY+Ip8QxSmyztsStkYXdULqpwz4JEXW9vz64eTbde4vQJ6pjHGarJf1gQNEc2XzhmI/prXLysWNqC7lZg7PUZUTrdegABTUzYCRJ1kWBRPm4qo0LN405c94QQd45a5kTgowHzEgLnAQI28x0M3A59TKC+ieNc6VF1PsTLpUw7PNI2VstX5jAuasCAwEAAaMSMBAwDgYDVR0PAQH/BAQDAgEGMA0GCSqGSIb3DQEBCwUAA4IBAQCK6LGA01TR+rmU8p6yhAi4OkDN2b1dbIL8l8iCMYopLCxx8xqq3ubZCOxqh1X2j6pgWzarb0b/MUix00IoUvNbFOxAW7PBZIKDLnm6LsckRxs1U32sC9d1LOHe3WKBNB6GZALT1ewjh7hSbWjftlmcovq+6eVGA5cvf2u/2+TkKkyHV/NR394nXrdsdpvygwypEtXjetzD7UT93Nuw3xcV8VIftIvHf9LjU7h+UjGmKXG9c15eYr3SzUmv6kyOI0Bvw14PWtsWGl0QdOSRvIBBrP4adCnGTgjgjk9LTcO8B8FKrr+8lHGuc0bp4lIUToiUkGILXsiEeEg9WAqm+XqO&quot;
    },
    &quot;certificateChain&quot; : [ ],
    &quot;detachedContents&quot; : null,
    &quot;asicContainerType&quot; : null,
    &quot;blevelParams&quot; : {
      &quot;trustAnchorBPPolicy&quot; : true,
      &quot;signingDate&quot; : 1542794106964,
      &quot;claimedSignerRoles&quot; : null,
      &quot;signaturePolicy&quot; : null,
      &quot;commitmentTypeIndications&quot; : null,
      &quot;signerLocation&quot; : null
    }
  },
  &quot;signatureValue&quot; : {
    &quot;algorithm&quot; : &quot;RSA_SHA256&quot;,
    &quot;value&quot; : &quot;AQIDBA==&quot;
  },
  &quot;toSignDocument&quot; : {
    &quot;bytes&quot; : &quot;SGVsbG8=&quot;,
    &quot;digestAlgorithm&quot; : null,
    &quot;name&quot; : &quot;RemoteDocument&quot;,
    &quot;mimeType&quot; : null
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Response</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="http">HTTP/1.1 200 OK
Date: Wed, 21 Nov 2018 09:55:06 GMT
Content-Type: application/json
Transfer-Encoding: chunked
Content-Length: 1791

{
  &quot;bytes&quot; : &quot;MIIErwYJKoZIhvcNAQcCoIIEoDCCBJwCAQExDzANBglghkgBZQMEAgEFADAUBgkqhkiG9w0BBwGgBwQFSGVsbG+gggLuMIIC6jCCAdKgAwIBAgIGLtYU17tXMA0GCSqGSIb3DQEBCwUAMDAxGzAZBgNVBAMMElJvb3RTZWxmU2lnbmVkRmFrZTERMA8GA1UECgwIRFNTLXRlc3QwHhcNMTcwNjA4MTEyNjAxWhcNNDcwNzA0MDc1NzI0WjAoMRMwEQYDVQQDDApTaWduZXJGYWtlMREwDwYDVQQKDAhEU1MtdGVzdDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMI3kZhtnipn+iiZHZ9ax8FlfE5Ow/cFwBTfAEb3R1ZQUp6/BQnBt7Oo0JWBtc9qkv7JUDdcBJXPV5QWS5AyMPHpqQ75Hitjsq/Fzu8eHtkKpFizcxGa9BZdkQjh4rSrtO1Kjs0Rd5DQtWSgkeVCCN09kN0ZsZ0ENY+Ip8QxSmyztsStkYXdULqpwz4JEXW9vz64eTbde4vQJ6pjHGarJf1gQNEc2XzhmI/prXLysWNqC7lZg7PUZUTrdegABTUzYCRJ1kWBRPm4qo0LN405c94QQd45a5kTgowHzEgLnAQI28x0M3A59TKC+ieNc6VF1PsTLpUw7PNI2VstX5jAuasCAwEAAaMSMBAwDgYDVR0PAQH/BAQDAgEGMA0GCSqGSIb3DQEBCwUAA4IBAQCK6LGA01TR+rmU8p6yhAi4OkDN2b1dbIL8l8iCMYopLCxx8xqq3ubZCOxqh1X2j6pgWzarb0b/MUix00IoUvNbFOxAW7PBZIKDLnm6LsckRxs1U32sC9d1LOHe3WKBNB6GZALT1ewjh7hSbWjftlmcovq+6eVGA5cvf2u/2+TkKkyHV/NR394nXrdsdpvygwypEtXjetzD7UT93Nuw3xcV8VIftIvHf9LjU7h+UjGmKXG9c15eYr3SzUmv6kyOI0Bvw14PWtsWGl0QdOSRvIBBrP4adCnGTgjgjk9LTcO8B8FKrr+8lHGuc0bp4lIUToiUkGILXsiEeEg9WAqm+XqOMYIBfDCCAXgCAQEwOjAwMRswGQYDVQQDDBJSb290U2VsZlNpZ25lZEZha2UxETAPBgNVBAoMCERTUy10ZXN0AgYu1hTXu1cwDQYJYIZIAWUDBAIBBQCgggERMBgGCSqGSIb3DQEJAzELBgkqhkiG9w0BBwEwHAYJKoZIhvcNAQkFMQ8XDTE4MTEyMTA5NTUwNlowLQYJKoZIhvcNAQk0MSAwHjANBglghkgBZQMEAgEFAKENBgkqhkiG9w0BAQsFADAvBgkqhkiG9w0BCQQxIgQgGF+NsyJx/iX1Yab8k4suJkMG7DBO2lGAB9F2SCY4GWkwdwYLKoZIhvcNAQkQAi8xaDBmMGQwYgQgAvPrygFjJ0JTvICdJ0mN1BuwMW1+awZpYBFd4VVYnZwwPjA0pDIwMDEbMBkGA1UEAwwSUm9vdFNlbGZTaWduZWRGYWtlMREwDwYDVQQKDAhEU1MtdGVzdAIGLtYU17tXMA0GCSqGSIb3DQEBCwUABAQBAgME&quot;,
  &quot;digestAlgorithm&quot; : null,
  &quot;name&quot; : &quot;RemoteDocument-signed-cades-baseline-b.pkcs7&quot;,
  &quot;mimeType&quot; : {
    &quot;mimeTypeString&quot; : &quot;application/pkcs7-signature&quot;
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_extend_document"><a class="anchor" href="#_extend_document"></a>Extend document</h4>
<div class="paragraph">
<p>The method allows to extend an existing signature to a stronger level.</p>
</div>
<div class="listingblock">
<div class="title">Request</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="http">POST /services/rest/signature/one-document/extendDocument HTTP/1.1
Accept: application/json, application/javascript, text/javascript, text/json
Content-Type: application/json; charset=UTF-8
Host: localhost:8080
Content-Length: 8677

{
  &quot;toExtendDocument&quot; : {
    &quot;bytes&quot; : &quot;PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48ZHM6U2lnbmF0dXJlIHhtbG5zOmRzPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjIiBJZD0iaWQtYWZkZTc4MjQzNjQ2OGRkNzRlZWIxODFmN2NlMTEwZTEiPjxkczpTaWduZWRJbmZvPjxkczpDYW5vbmljYWxpemF0aW9uTWV0aG9kIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS8xMC94bWwtZXhjLWMxNG4jIi8+PGRzOlNpZ25hdHVyZU1ldGhvZCBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMDQveG1sZHNpZy1tb3JlI3JzYS1zaGEyNTYiLz48ZHM6UmVmZXJlbmNlIElkPSJyLWlkLTEiIFR5cGU9IiIgVVJJPSJzYW1wbGUueG1sIj48ZHM6RGlnZXN0TWV0aG9kIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS8wNC94bWxlbmMjc2hhMjU2Ii8+PGRzOkRpZ2VzdFZhbHVlPmtjREhPWmp3WmhWZnVEaHVoQ2VDRVJSbVlwVEg0Smo0Um1mVlZpMzFROWc9PC9kczpEaWdlc3RWYWx1ZT48L2RzOlJlZmVyZW5jZT48ZHM6UmVmZXJlbmNlIFR5cGU9Imh0dHA6Ly91cmkuZXRzaS5vcmcvMDE5MDMjU2lnbmVkUHJvcGVydGllcyIgVVJJPSIjeGFkZXMtaWQtYWZkZTc4MjQzNjQ2OGRkNzRlZWIxODFmN2NlMTEwZTEiPjxkczpUcmFuc2Zvcm1zPjxkczpUcmFuc2Zvcm0gQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzEwL3htbC1leGMtYzE0biMiLz48L2RzOlRyYW5zZm9ybXM+PGRzOkRpZ2VzdE1ldGhvZCBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMDQveG1sZW5jI3NoYTI1NiIvPjxkczpEaWdlc3RWYWx1ZT5EenR3TlRtUm9PQW02L2xNSThSeW01eFpQekl2TFlEem4vZWJZWWtQc3I0PTwvZHM6RGlnZXN0VmFsdWU+PC9kczpSZWZlcmVuY2U+PC9kczpTaWduZWRJbmZvPjxkczpTaWduYXR1cmVWYWx1ZSBJZD0idmFsdWUtaWQtYWZkZTc4MjQzNjQ2OGRkNzRlZWIxODFmN2NlMTEwZTEiPllBN3NFTnQzTjh1ZkxGTW5LcjM2cjBQcXpNaVkzUTBzKytJR1RFVUMwc3BheFV2MGRIWk0wZC95bjNrcExKTG9Va0k0TTNmbGo1V0duODNrZjA1QnFNMWtoc1g2MUdKemFGVFBHcG03YWtSUUtodm9IMjV5eXFUWVhFU2xCY20wNGl6aUtoTE16WmpVZng0L0IxWkl5c3Y1cElCZ0oycjJvaTZqTG9wOXd3M2dlNGM0WUpvYUsrU1hrNmh5VE5PY044UGpHZTYzV1lPVE5WUFFGdmphOEJud2crYTBiQnV3RCs4TjZmd2lnQ2RXNWEvNERKVWUvSjhNYjcwWkk4UG9Pem5HRGZpK1RQYmlJZVZtQ2JsNW1Vb1VnMlEveFlsdUpmTGgzdUdRQVhLQnZGNDVvRElIUlZlZm5OL0QvV3l0QUNsVVZEb1FTeXdlbW5qUHBxRjhlZz09PC9kczpTaWduYXR1cmVWYWx1ZT48ZHM6S2V5SW5mbz48ZHM6WDUwOURhdGE+PGRzOlg1MDlDZXJ0aWZpY2F0ZT5NSUlEMURDQ0FyeWdBd0lCQWdJQkNqQU5CZ2txaGtpRzl3MEJBUXNGQURCTk1SQXdEZ1lEVlFRRERBZG5iMjlrTFdOaE1Sa3dGd1lEVlFRS0RCQk9iM2RwYm1FZ1UyOXNkWFJwYjI1ek1SRXdEd1lEVlFRTERBaFFTMGt0VkVWVFZERUxNQWtHQTFVRUJoTUNURlV3SGhjTk1UWXhNREkyTURjMU5ETXhXaGNOTVRnd09ESTJNRGMxTkRNeFdqQlBNUkl3RUFZRFZRUUREQWxuYjI5a0xYVnpaWEl4R1RBWEJnTlZCQW9NRUU1dmQybHVZU0JUYjJ4MWRHbHZibk14RVRBUEJnTlZCQXNNQ0ZCTFNTMVVSVk5VTVFzd0NRWURWUVFHRXdKTVZUQ0NBU0l3RFFZSktvWklodmNOQVFFQkJRQURnZ0VQQURDQ0FRb0NnZ0VCQUxSQ1VJUVpidzNuU2RMcCtCOWN6RUNncFpra1E1eFY0ZzlNLzd3bGc5N29DQ2Y3VUVoOUJBMWQrellqc3p2K0JKMWJKWlBnYW4yMTQ0QXZnc29HSmZiNlVJeVZXNGdrbFVnSWwxYXJVdm9uK1drS25zZUZ1UU9mSnlqU0ZVREl3bnV2cDBoemNKWEhYUm1MZG15aCtuKzZOTUgwb201dFZvU2ZRcnRCVmlDTGVTTVZ6dUQ1RVBqMG1JUmN4OTFwTDM4ZTNGTlRXN05hR1pMZWV6dUZ1Ui9xN3o5M2xMa3ZaNFZBTU5HR0x2SVhPWWVSQlpNeVBocEJaNEwzQThJM0VFbEtXSC8xTHdpaVhUVFNHMXNNNld2TVRWYmYydmJkNDduWlJRQTJtU3BOR2pRb3VPQUVyZmVWVlVxeklDZ2hRQ0hSR09OdVNMRy9IZnFGSGI0aldnMENBd0VBQWFPQnZEQ0J1VEFPQmdOVkhROEJBZjhFQkFNQ0JrQXdnWWNHQ0NzR0FRVUZCd0VCQkhzd2VUQTVCZ2dyQmdFRkJRY3dBWVl0YUhSMGNEb3ZMMlJ6Y3k1dWIzZHBibUV1YkhVdmNHdHBMV1poWTNSdmNua3ZiMk56Y0M5bmIyOWtMV05oTUR3R0NDc0dBUVVGQnpBQ2hqQm9kSFJ3T2k4dlpITnpMbTV2ZDJsdVlTNXNkUzl3YTJrdFptRmpkRzl5ZVM5amNuUXZaMjl2WkMxallTNWpjblF3SFFZRFZSME9CQllFRk4ycEhELzdQZWZtQlQ4b1gyOVpoV3kvT0hKMU1BMEdDU3FHU0liM0RRRUJDd1VBQTRJQkFRQkszVk9MaERJVldLb0ZycmhoV3phZGR0azZYUXRjd1JvTlBWU3NpL2dPcnpzZE03MEEzMXhJVHc3WWZMaHBvVkExeG83b3ZIbGRwTGxocXk5bzV3aDI4MnlDcHFCVUF0Z3JTa0RHb2crSzdDTDZnVXBybFlpWnVHWnJ0ZzJYM2ZIUzJVc3g0WkozdElqNndWZWNERVVxSVNGZkZUMkVzbTBRWFVuZ0lLRk1sOTVYZ210dzJ3eFhiT3pVZURkNERJUHJ2K21XNXBvQVdyNkl0c1YrSDJWUStaTC9rQm53V0hqU1RPYUdGaXNxWFkvYUgvMVB0QlhBKzE1K1lJV2VtSkJTdjNrRGFGek9YQUV0UjlaSThsWU9KYXJuWTdBeS9hTjZiOXVHZmZyYm8vaFZBY0w0V0RkaGtiQk4zbTh3K2c3NkxvQVhOZUVldTA0QS8weExaelVCPC9kczpYNTA5Q2VydGlmaWNhdGU+PGRzOlg1MDlDZXJ0aWZpY2F0ZT5NSUlENmpDQ0F0S2dBd0lCQWdJQkJEQU5CZ2txaGtpRzl3MEJBUXNGQURCTk1SQXdEZ1lEVlFRRERBZHliMjkwTFdOaE1Sa3dGd1lEVlFRS0RCQk9iM2RwYm1FZ1UyOXNkWFJwYjI1ek1SRXdEd1lEVlFRTERBaFFTMGt0VkVWVFZERUxNQWtHQTFVRUJoTUNURlV3SGhjTk1UWXhNREkyTURjMU5ETXdXaGNOTVRnd09ESTJNRGMxTkRNd1dqQk5NUkF3RGdZRFZRUUREQWRuYjI5a0xXTmhNUmt3RndZRFZRUUtEQkJPYjNkcGJtRWdVMjlzZFhScGIyNXpNUkV3RHdZRFZRUUxEQWhRUzBrdFZFVlRWREVMTUFrR0ExVUVCaE1DVEZVd2dnRWlNQTBHQ1NxR1NJYjNEUUVCQVFVQUE0SUJEd0F3Z2dFS0FvSUJBUUNiYmw1c0tCQ2pTQjhUTWRhY3lteC9XZk9qTVcxZ2lJalZKUlkyOEpiTldrQ1ZtdHpnbWl0Z2hmclBRUGx1ZXUwRFRhbGJEa3JTU3loQ3Z6elBTR1B3Q0ZPYWhGL243aFFhMUYzVWFIU3hUS3JGQzVuT3dkTHp4S1JPM1dqVnRJR1JTWDJrdjFGZlVwUXk1RXl5K3JzZlN6SjU5ZFU1WlpkV3BkYUR1RHhWVnlEZXIzRUl5Q2JHNy81SDlNRDRZdXpOcGVURldtTTZjVVNUMDc5NlhEbGJFeFNUVEdRWEZKQTIrQ0NzeTlEWG5KYThuejBGRThmbWN2UUhlVTZrOVFicHpHak1kM0RXbEU2bm83VWRDWUQxSDA0K3VzQnA1aGhDckFCNjcwTmRvVHJOVG1HTkFGdDRKVDB2aXRqS0hxOUtFSWQ2TGhkY20yVGc5M2REY1dGdEFnTUJBQUdqZ2RRd2dkRXdEZ1lEVlIwUEFRSC9CQVFEQWdlQU1FRUdBMVVkSHdRNk1EZ3dOcUEwb0RLR01HaDBkSEE2THk5a2MzTXVibTkzYVc1aExteDFMM0JyYVMxbVlXTjBiM0o1TDJOeWJDOXliMjkwTFdOaExtTnliREJNQmdnckJnRUZCUWNCQVFSQU1ENHdQQVlJS3dZQkJRVUhNQUtHTUdoMGRIQTZMeTlrYzNNdWJtOTNhVzVoTG14MUwzQnJhUzFtWVdOMGIzSjVMMk55ZEM5eWIyOTBMV05oTG1OeWREQWRCZ05WSFE0RUZnUVUrMnRGcXBOZTNHMjNZUjh5cUJaSWlWV1MzdlV3RHdZRFZSMFRBUUgvQkFVd0F3RUIvekFOQmdrcWhraUc5dzBCQVFzRkFBT0NBUUVBRStOdWQwNVhHT002RkVaSFdUYzgrYm16LzZCMFhRWE41NjRLV0JCaGNoOWk1R2FkanFwU3NldmtuK3RlTHE1bTZDTG8zZTRsWDJkSjdoc1BBdnlhTHFPSXB6ZzQ5VEdkaWIxbk9CMk83NCt5QWhUOHY5Rlp0SDFFQ0hYeFlzdXlTR0lLdmQrTDVJakpUaXMzbGw0dlU4Rkh6eVJsTTlJUW53WlI1MDZqRmNKZUdsT2d5WmgrVUxXblJORUV3cU44RFRGMkQwWG9nWUJzckN4Q0JqMFBwYUpGcnV2RVFxcFV1dVlnMTRSMURKRmFoTHdxVllTT0Q1Z1BobUEwSFI0ejNHRjNqSFN6MGk5alhTVE9zVWNka3ZVSnkwdElPbnVqc1VFa2czSDZXZzNsejhUdzNJYzdWMU5IYitNQzVLNFp2WCs1U1l5dTArZXI3YkZzY0lyWVp3PT08L2RzOlg1MDlDZXJ0aWZpY2F0ZT48L2RzOlg1MDlEYXRhPjwvZHM6S2V5SW5mbz48ZHM6T2JqZWN0Pjx4YWRlczpRdWFsaWZ5aW5nUHJvcGVydGllcyB4bWxuczp4YWRlcz0iaHR0cDovL3VyaS5ldHNpLm9yZy8wMTkwMy92MS4zLjIjIiBUYXJnZXQ9IiNpZC1hZmRlNzgyNDM2NDY4ZGQ3NGVlYjE4MWY3Y2UxMTBlMSI+PHhhZGVzOlNpZ25lZFByb3BlcnRpZXMgSWQ9InhhZGVzLWlkLWFmZGU3ODI0MzY0NjhkZDc0ZWViMTgxZjdjZTExMGUxIj48eGFkZXM6U2lnbmVkU2lnbmF0dXJlUHJvcGVydGllcz48eGFkZXM6U2lnbmluZ1RpbWU+MjAxNy0wOS0yOFQxMTowOTowNFo8L3hhZGVzOlNpZ25pbmdUaW1lPjx4YWRlczpTaWduaW5nQ2VydGlmaWNhdGVWMj48eGFkZXM6Q2VydD48eGFkZXM6Q2VydERpZ2VzdD48ZHM6RGlnZXN0TWV0aG9kIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnI3NoYTEiLz48ZHM6RGlnZXN0VmFsdWU+YytWb2hnMGpJY1o0VVFTV2VnbENnMG9HTldzPTwvZHM6RGlnZXN0VmFsdWU+PC94YWRlczpDZXJ0RGlnZXN0Pjx4YWRlczpJc3N1ZXJTZXJpYWxWMj5NRll3VWFSUE1FMHhFREFPQmdOVkJBTU1CMmR2YjJRdFkyRXhHVEFYQmdOVkJBb01FRTV2ZDJsdVlTQlRiMngxZEdsdmJuTXhFVEFQQmdOVkJBc01DRkJMU1MxVVJWTlVNUXN3Q1FZRFZRUUdFd0pNVlFJQkNnPT08L3hhZGVzOklzc3VlclNlcmlhbFYyPjwveGFkZXM6Q2VydD48L3hhZGVzOlNpZ25pbmdDZXJ0aWZpY2F0ZVYyPjwveGFkZXM6U2lnbmVkU2lnbmF0dXJlUHJvcGVydGllcz48eGFkZXM6U2lnbmVkRGF0YU9iamVjdFByb3BlcnRpZXM+PHhhZGVzOkRhdGFPYmplY3RGb3JtYXQgT2JqZWN0UmVmZXJlbmNlPSIjci1pZC0xIj48eGFkZXM6TWltZVR5cGU+dGV4dC94bWw8L3hhZGVzOk1pbWVUeXBlPjwveGFkZXM6RGF0YU9iamVjdEZvcm1hdD48L3hhZGVzOlNpZ25lZERhdGFPYmplY3RQcm9wZXJ0aWVzPjwveGFkZXM6U2lnbmVkUHJvcGVydGllcz48L3hhZGVzOlF1YWxpZnlpbmdQcm9wZXJ0aWVzPjwvZHM6T2JqZWN0PjwvZHM6U2lnbmF0dXJlPg==&quot;,
    &quot;digestAlgorithm&quot; : null,
    &quot;name&quot; : &quot;xades-detached.xml&quot;,
    &quot;mimeType&quot; : {
      &quot;mimeTypeString&quot; : &quot;text/xml&quot;
    }
  },
  &quot;parameters&quot; : {
    &quot;signWithExpiredCertificate&quot; : false,
    &quot;generateTBSWithoutCertificate&quot; : false,
    &quot;signatureLevel&quot; : &quot;XAdES_BASELINE_T&quot;,
    &quot;signaturePackaging&quot; : null,
    &quot;signatureAlgorithm&quot; : &quot;RSA_SHA256&quot;,
    &quot;encryptionAlgorithm&quot; : &quot;RSA&quot;,
    &quot;digestAlgorithm&quot; : &quot;SHA256&quot;,
    &quot;referenceDigestAlgorithm&quot; : null,
    &quot;maskGenerationFunction&quot; : null,
    &quot;contentTimestampParameters&quot; : {
      &quot;digestAlgorithm&quot; : &quot;SHA256&quot;,
      &quot;canonicalizationMethod&quot; : &quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;
    },
    &quot;signatureTimestampParameters&quot; : {
      &quot;digestAlgorithm&quot; : &quot;SHA256&quot;,
      &quot;canonicalizationMethod&quot; : &quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;
    },
    &quot;archiveTimestampParameters&quot; : {
      &quot;digestAlgorithm&quot; : &quot;SHA256&quot;,
      &quot;canonicalizationMethod&quot; : &quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;
    },
    &quot;signingCertificate&quot; : null,
    &quot;certificateChain&quot; : [ ],
    &quot;detachedContents&quot; : [ {
      &quot;bytes&quot; : &quot;77u/PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxoOnRhYmxlIHhtbG5zOmg9Imh0dHA6Ly93d3cudzMub3JnL1RSL2h0bWw0LyI+DQoJPGg6dHI+DQoJCTxoOnRkPkhlbGxvPC9oOnRkPg0KCQk8aDp0ZD5Xb3JsZDwvaDp0ZD4NCgk8L2g6dHI+DQo8L2g6dGFibGU+&quot;,
      &quot;digestAlgorithm&quot; : null,
      &quot;name&quot; : &quot;sample.xml&quot;,
      &quot;mimeType&quot; : {
        &quot;mimeTypeString&quot; : &quot;text/xml&quot;
      }
    } ],
    &quot;asicContainerType&quot; : null,
    &quot;blevelParams&quot; : {
      &quot;trustAnchorBPPolicy&quot; : true,
      &quot;signingDate&quot; : 1542794104583,
      &quot;claimedSignerRoles&quot; : null,
      &quot;signaturePolicy&quot; : null,
      &quot;commitmentTypeIndications&quot; : null,
      &quot;signerLocation&quot; : null
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Response</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="http">HTTP/1.1 200 OK
Date: Wed, 21 Nov 2018 09:55:05 GMT
Content-Type: application/json
Transfer-Encoding: chunked
Content-Length: 10552

{
  &quot;bytes&quot; : &quot;PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PGRzOlNpZ25hdHVyZSB4bWxuczpkcz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnIyIgSWQ9ImlkLWFmZGU3ODI0MzY0NjhkZDc0ZWViMTgxZjdjZTExMGUxIj48ZHM6U2lnbmVkSW5mbz48ZHM6Q2Fub25pY2FsaXphdGlvbk1ldGhvZCBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMTAveG1sLWV4Yy1jMTRuIyIvPjxkczpTaWduYXR1cmVNZXRob2QgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGRzaWctbW9yZSNyc2Etc2hhMjU2Ii8+PGRzOlJlZmVyZW5jZSBJZD0ici1pZC0xIiBUeXBlPSIiIFVSST0ic2FtcGxlLnhtbCI+PGRzOkRpZ2VzdE1ldGhvZCBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMDQveG1sZW5jI3NoYTI1NiIvPjxkczpEaWdlc3RWYWx1ZT5rY0RIT1pqd1poVmZ1RGh1aENlQ0VSUm1ZcFRINEpqNFJtZlZWaTMxUTlnPTwvZHM6RGlnZXN0VmFsdWU+PC9kczpSZWZlcmVuY2U+PGRzOlJlZmVyZW5jZSBUeXBlPSJodHRwOi8vdXJpLmV0c2kub3JnLzAxOTAzI1NpZ25lZFByb3BlcnRpZXMiIFVSST0iI3hhZGVzLWlkLWFmZGU3ODI0MzY0NjhkZDc0ZWViMTgxZjdjZTExMGUxIj48ZHM6VHJhbnNmb3Jtcz48ZHM6VHJhbnNmb3JtIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS8xMC94bWwtZXhjLWMxNG4jIi8+PC9kczpUcmFuc2Zvcm1zPjxkczpEaWdlc3RNZXRob2QgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGVuYyNzaGEyNTYiLz48ZHM6RGlnZXN0VmFsdWU+RHp0d05UbVJvT0FtNi9sTUk4UnltNXhaUHpJdkxZRHpuL2ViWVlrUHNyND08L2RzOkRpZ2VzdFZhbHVlPjwvZHM6UmVmZXJlbmNlPjwvZHM6U2lnbmVkSW5mbz48ZHM6U2lnbmF0dXJlVmFsdWUgSWQ9InZhbHVlLWlkLWFmZGU3ODI0MzY0NjhkZDc0ZWViMTgxZjdjZTExMGUxIj5ZQTdzRU50M044dWZMRk1uS3IzNnIwUHF6TWlZM1EwcysrSUdURVVDMHNwYXhVdjBkSFpNMGQveW4za3BMSkxvVWtJNE0zZmxqNVdHbjgza2YwNUJxTTFraHNYNjFHSnphRlRQR3BtN2FrUlFLaHZvSDI1eXlxVFlYRVNsQmNtMDRpemlLaExNelpqVWZ4NC9CMVpJeXN2NXBJQmdKMnIyb2k2akxvcDl3dzNnZTRjNFlKb2FLK1NYazZoeVROT2NOOFBqR2U2M1dZT1ROVlBRRnZqYThCbndnK2EwYkJ1d0QrOE42ZndpZ0NkVzVhLzRESlVlL0o4TWI3MFpJOFBvT3puR0RmaStUUGJpSWVWbUNibDVtVW9VZzJRL3hZbHVKZkxoM3VHUUFYS0J2RjQ1b0RJSFJWZWZuTi9EL1d5dEFDbFVWRG9RU3l3ZW1ualBwcUY4ZWc9PTwvZHM6U2lnbmF0dXJlVmFsdWU+PGRzOktleUluZm8+PGRzOlg1MDlEYXRhPjxkczpYNTA5Q2VydGlmaWNhdGU+TUlJRDFEQ0NBcnlnQXdJQkFnSUJDakFOQmdrcWhraUc5dzBCQVFzRkFEQk5NUkF3RGdZRFZRUUREQWRuYjI5a0xXTmhNUmt3RndZRFZRUUtEQkJPYjNkcGJtRWdVMjlzZFhScGIyNXpNUkV3RHdZRFZRUUxEQWhRUzBrdFZFVlRWREVMTUFrR0ExVUVCaE1DVEZVd0hoY05NVFl4TURJMk1EYzFORE14V2hjTk1UZ3dPREkyTURjMU5ETXhXakJQTVJJd0VBWURWUVFEREFsbmIyOWtMWFZ6WlhJeEdUQVhCZ05WQkFvTUVFNXZkMmx1WVNCVGIyeDFkR2x2Ym5NeEVUQVBCZ05WQkFzTUNGQkxTUzFVUlZOVU1Rc3dDUVlEVlFRR0V3Sk1WVENDQVNJd0RRWUpLb1pJaHZjTkFRRUJCUUFEZ2dFUEFEQ0NBUW9DZ2dFQkFMUkNVSVFaYnczblNkTHArQjljekVDZ3Baa2tRNXhWNGc5TS83d2xnOTdvQ0NmN1VFaDlCQTFkK3pZanN6ditCSjFiSlpQZ2FuMjE0NEF2Z3NvR0pmYjZVSXlWVzRna2xVZ0lsMWFyVXZvbitXa0tuc2VGdVFPZkp5alNGVURJd251dnAwaHpjSlhIWFJtTGRteWgrbis2Tk1IMG9tNXRWb1NmUXJ0QlZpQ0xlU01WenVENUVQajBtSVJjeDkxcEwzOGUzRk5UVzdOYUdaTGVlenVGdVIvcTd6OTNsTGt2WjRWQU1OR0dMdklYT1llUkJaTXlQaHBCWjRMM0E4STNFRWxLV0gvMUx3aWlYVFRTRzFzTTZXdk1UVmJmMnZiZDQ3blpSUUEybVNwTkdqUW91T0FFcmZlVlZVcXpJQ2doUUNIUkdPTnVTTEcvSGZxRkhiNGpXZzBDQXdFQUFhT0J2RENCdVRBT0JnTlZIUThCQWY4RUJBTUNCa0F3Z1ljR0NDc0dBUVVGQndFQkJIc3dlVEE1QmdnckJnRUZCUWN3QVlZdGFIUjBjRG92TDJSemN5NXViM2RwYm1FdWJIVXZjR3RwTFdaaFkzUnZjbmt2YjJOemNDOW5iMjlrTFdOaE1Ed0dDQ3NHQVFVRkJ6QUNoakJvZEhSd09pOHZaSE56TG01dmQybHVZUzVzZFM5d2Eya3RabUZqZEc5eWVTOWpjblF2WjI5dlpDMWpZUzVqY25Rd0hRWURWUjBPQkJZRUZOMnBIRC83UGVmbUJUOG9YMjlaaFd5L09ISjFNQTBHQ1NxR1NJYjNEUUVCQ3dVQUE0SUJBUUJLM1ZPTGhESVZXS29GcnJoaFd6YWRkdGs2WFF0Y3dSb05QVlNzaS9nT3J6c2RNNzBBMzF4SVR3N1lmTGhwb1ZBMXhvN292SGxkcExsaHF5OW81d2gyODJ5Q3BxQlVBdGdyU2tER29nK0s3Q0w2Z1VwcmxZaVp1R1pydGcyWDNmSFMyVXN4NFpKM3RJajZ3VmVjREVVcUlTRmZGVDJFc20wUVhVbmdJS0ZNbDk1WGdtdHcyd3hYYk96VWVEZDRESVBydittVzVwb0FXcjZJdHNWK0gyVlErWkwva0Jud1dIalNUT2FHRmlzcVhZL2FILzFQdEJYQSsxNStZSVdlbUpCU3Yza0RhRnpPWEFFdFI5Wkk4bFlPSmFyblk3QXkvYU42Yjl1R2ZmcmJvL2hWQWNMNFdEZGhrYkJOM204dytnNzZMb0FYTmVFZXUwNEEvMHhMWnpVQjwvZHM6WDUwOUNlcnRpZmljYXRlPjxkczpYNTA5Q2VydGlmaWNhdGU+TUlJRDZqQ0NBdEtnQXdJQkFnSUJCREFOQmdrcWhraUc5dzBCQVFzRkFEQk5NUkF3RGdZRFZRUUREQWR5YjI5MExXTmhNUmt3RndZRFZRUUtEQkJPYjNkcGJtRWdVMjlzZFhScGIyNXpNUkV3RHdZRFZRUUxEQWhRUzBrdFZFVlRWREVMTUFrR0ExVUVCaE1DVEZVd0hoY05NVFl4TURJMk1EYzFORE13V2hjTk1UZ3dPREkyTURjMU5ETXdXakJOTVJBd0RnWURWUVFEREFkbmIyOWtMV05oTVJrd0Z3WURWUVFLREJCT2IzZHBibUVnVTI5c2RYUnBiMjV6TVJFd0R3WURWUVFMREFoUVMwa3RWRVZUVkRFTE1Ba0dBMVVFQmhNQ1RGVXdnZ0VpTUEwR0NTcUdTSWIzRFFFQkFRVUFBNElCRHdBd2dnRUtBb0lCQVFDYmJsNXNLQkNqU0I4VE1kYWN5bXgvV2ZPak1XMWdpSWpWSlJZMjhKYk5Xa0NWbXR6Z21pdGdoZnJQUVBsdWV1MERUYWxiRGtyU1N5aEN2enpQU0dQd0NGT2FoRi9uN2hRYTFGM1VhSFN4VEtyRkM1bk93ZEx6eEtSTzNXalZ0SUdSU1gya3YxRmZVcFF5NUV5eStyc2ZTeko1OWRVNVpaZFdwZGFEdUR4VlZ5RGVyM0VJeUNiRzcvNUg5TUQ0WXV6TnBlVEZXbU02Y1VTVDA3OTZYRGxiRXhTVFRHUVhGSkEyK0NDc3k5RFhuSmE4bnowRkU4Zm1jdlFIZVU2azlRYnB6R2pNZDNEV2xFNm5vN1VkQ1lEMUgwNCt1c0JwNWhoQ3JBQjY3ME5kb1RyTlRtR05BRnQ0SlQwdml0aktIcTlLRUlkNkxoZGNtMlRnOTNkRGNXRnRBZ01CQUFHamdkUXdnZEV3RGdZRFZSMFBBUUgvQkFRREFnZUFNRUVHQTFVZEh3UTZNRGd3TnFBMG9ES0dNR2gwZEhBNkx5OWtjM011Ym05M2FXNWhMbXgxTDNCcmFTMW1ZV04wYjNKNUwyTnliQzl5YjI5MExXTmhMbU55YkRCTUJnZ3JCZ0VGQlFjQkFRUkFNRDR3UEFZSUt3WUJCUVVITUFLR01HaDBkSEE2THk5a2MzTXVibTkzYVc1aExteDFMM0JyYVMxbVlXTjBiM0o1TDJOeWRDOXliMjkwTFdOaExtTnlkREFkQmdOVkhRNEVGZ1FVKzJ0RnFwTmUzRzIzWVI4eXFCWklpVldTM3ZVd0R3WURWUjBUQVFIL0JBVXdBd0VCL3pBTkJna3Foa2lHOXcwQkFRc0ZBQU9DQVFFQUUrTnVkMDVYR09NNkZFWkhXVGM4K2Jtei82QjBYUVhONTY0S1dCQmhjaDlpNUdhZGpxcFNzZXZrbit0ZUxxNW02Q0xvM2U0bFgyZEo3aHNQQXZ5YUxxT0lwemc0OVRHZGliMW5PQjJPNzQreUFoVDh2OUZadEgxRUNIWHhZc3V5U0dJS3ZkK0w1SWpKVGlzM2xsNHZVOEZIenlSbE05SVFud1pSNTA2akZjSmVHbE9neVpoK1VMV25STkVFd3FOOERURjJEMFhvZ1lCc3JDeENCajBQcGFKRnJ1dkVRcXBVdXVZZzE0UjFESkZhaEx3cVZZU09ENWdQaG1BMEhSNHozR0YzakhTejBpOWpYU1RPc1VjZGt2VUp5MHRJT251anNVRWtnM0g2V2czbHo4VHczSWM3VjFOSGIrTUM1SzRadlgrNVNZeXUwK2VyN2JGc2NJclladz09PC9kczpYNTA5Q2VydGlmaWNhdGU+PC9kczpYNTA5RGF0YT48L2RzOktleUluZm8+PGRzOk9iamVjdD48eGFkZXM6UXVhbGlmeWluZ1Byb3BlcnRpZXMgeG1sbnM6eGFkZXM9Imh0dHA6Ly91cmkuZXRzaS5vcmcvMDE5MDMvdjEuMy4yIyIgVGFyZ2V0PSIjaWQtYWZkZTc4MjQzNjQ2OGRkNzRlZWIxODFmN2NlMTEwZTEiPjx4YWRlczpTaWduZWRQcm9wZXJ0aWVzIElkPSJ4YWRlcy1pZC1hZmRlNzgyNDM2NDY4ZGQ3NGVlYjE4MWY3Y2UxMTBlMSI+PHhhZGVzOlNpZ25lZFNpZ25hdHVyZVByb3BlcnRpZXM+PHhhZGVzOlNpZ25pbmdUaW1lPjIwMTctMDktMjhUMTE6MDk6MDRaPC94YWRlczpTaWduaW5nVGltZT48eGFkZXM6U2lnbmluZ0NlcnRpZmljYXRlVjI+PHhhZGVzOkNlcnQ+PHhhZGVzOkNlcnREaWdlc3Q+PGRzOkRpZ2VzdE1ldGhvZCBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyNzaGExIi8+PGRzOkRpZ2VzdFZhbHVlPmMrVm9oZzBqSWNaNFVRU1dlZ2xDZzBvR05Xcz08L2RzOkRpZ2VzdFZhbHVlPjwveGFkZXM6Q2VydERpZ2VzdD48eGFkZXM6SXNzdWVyU2VyaWFsVjI+TUZZd1VhUlBNRTB4RURBT0JnTlZCQU1NQjJkdmIyUXRZMkV4R1RBWEJnTlZCQW9NRUU1dmQybHVZU0JUYjJ4MWRHbHZibk14RVRBUEJnTlZCQXNNQ0ZCTFNTMVVSVk5VTVFzd0NRWURWUVFHRXdKTVZRSUJDZz09PC94YWRlczpJc3N1ZXJTZXJpYWxWMj48L3hhZGVzOkNlcnQ+PC94YWRlczpTaWduaW5nQ2VydGlmaWNhdGVWMj48L3hhZGVzOlNpZ25lZFNpZ25hdHVyZVByb3BlcnRpZXM+PHhhZGVzOlNpZ25lZERhdGFPYmplY3RQcm9wZXJ0aWVzPjx4YWRlczpEYXRhT2JqZWN0Rm9ybWF0IE9iamVjdFJlZmVyZW5jZT0iI3ItaWQtMSI+PHhhZGVzOk1pbWVUeXBlPnRleHQveG1sPC94YWRlczpNaW1lVHlwZT48L3hhZGVzOkRhdGFPYmplY3RGb3JtYXQ+PC94YWRlczpTaWduZWREYXRhT2JqZWN0UHJvcGVydGllcz48L3hhZGVzOlNpZ25lZFByb3BlcnRpZXM+PHhhZGVzOlVuc2lnbmVkUHJvcGVydGllcz48eGFkZXM6VW5zaWduZWRTaWduYXR1cmVQcm9wZXJ0aWVzPjx4YWRlczpTaWduYXR1cmVUaW1lU3RhbXAgSWQ9IlRTLThjOTNmZjkzLWUyMTQtNDZlYy05OGRmLTk0MGM3YzdhYzllZiI+PGRzOkNhbm9uaWNhbGl6YXRpb25NZXRob2QgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzEwL3htbC1leGMtYzE0biMiLz48eGFkZXM6RW5jYXBzdWxhdGVkVGltZVN0YW1wIElkPSJFVFMtOGM5M2ZmOTMtZTIxNC00NmVjLTk4ZGYtOTQwYzdjN2FjOWVmIj5NSUFHQ1NxR1NJYjNEUUVIQXFDQU1JQUNBUU14RHpBTkJnbGdoa2dCWlFNRUFnRUZBRENBQmdzcWhraUc5dzBCQ1JBQkJLQ0FKSUFFWVRCZkFnRUJCZ01xQXdRd01UQU5CZ2xnaGtnQlpRTUVBZ0VGQUFRZ3VtMFZ1MXUwSDJLSWlaRWMzUjZzMTNDcjVkN2NlNlNUVldvUEd2d0ZpN2NDRVFETkJ0T2ZjMlRWOUJYakEzV0pRVGdOR0E4eU1ERTRNVEV5TVRBNU5UVXdOVm9BQUFBQUFBQ2dnRENDQTI0d2dnSldvQU1DQVFJQ0FXUXdEUVlKS29aSWh2Y05BUUVMQlFBd1ZURVlNQllHQTFVRUF3d1BjMlZzWmkxemFXZHVaV1F0ZEhOaE1Sa3dGd1lEVlFRS0RCQk9iM2RwYm1FZ1UyOXNkWFJwYjI1ek1SRXdEd1lEVlFRTERBaFFTMGt0VkVWVFZERUxNQWtHQTFVRUJoTUNURlV3SGhjTk1UY3hNREU1TURjeU1qTTFXaGNOTVRrd09ERTVNRGN5TWpNMVdqQlZNUmd3RmdZRFZRUUREQTl6Wld4bUxYTnBaMjVsWkMxMGMyRXhHVEFYQmdOVkJBb01FRTV2ZDJsdVlTQlRiMngxZEdsdmJuTXhFVEFQQmdOVkJBc01DRkJMU1MxVVJWTlVNUXN3Q1FZRFZRUUdFd0pNVlRDQ0FTSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnRVBBRENDQVFvQ2dnRUJBS0N1K3d4c2phQWhFN2V1TDdNMXYyQlZPMlgrQmU0WkdwS1ljVEJrTERuN1ZoTFNPdnVMY2hFam1TN3BWZWZ6U2hFZjhQa3ZBSHpCRHFQZzg2RFFqbHFSTGhXNjI4UUJja2NkSTF3MEd2YjUvSUp2TzVGYVdOcGgxam5WNGdOYkkxY3N0TzYwaHhJRldtMFhSYVB2ZkJadkxuMmxRSXd4QmsrKzlYNlhFMCttM29hWVhOU3hwakpmamZRODJMdW9oM2V5RFRlWGJtTzlhNUtqMVhCNTNqek10WkpTdEFXcVNobm9DZlRRanVUeFpjZ0VsdlhzcVMwTTVEa2lSY1Q3ZHU3eTBwelVCVlMwZnZTNUY1NXBiREJnZWQvc0R5Qkh6QTVTcWVzdzhSaFRZWmdDKzdmS3A4SDN6ZXlXK1hiTE9ldzc3RXBIYVUycnN5SzJINGNOK0FVQ0F3RUFBYU5KTUVjd0RnWURWUjBQQVFIL0JBUURBZ2VBTUJZR0ExVWRKUUVCL3dRTU1Bb0dDQ3NHQVFVRkJ3TUlNQjBHQTFVZERnUVdCQlNRVTZvRmxVQW9oUVVlSnlZakNFbTdXZk0zeERBTkJna3Foa2lHOXcwQkFRc0ZBQU9DQVFFQWhpSnM2Y0g4WVF5OWxTZTU2M2gxZWphVDYvOXI5TXVtMHkxV3lPRjJZZ0RweVFFSUo5dUsyS013MS9wUkVoQmkzUmdMRk1XV1NZYmtnYUNkS1dYSnRYOWk2K1FEQVg4d21ualB1MEZxUVFha1FKdVU0VDhuUHRTKzBmOTcxVTJIRkQrQ0J2bWxpOGRTS29vYXhQVUM2amdaTkdZUk05ZmlPMHl2VWx5eVluc1hmMEswbnFuQThER3ROZHpZMkR5aUZFOWdlVlZRNXNGRFIxNitScDl1M2hadVV6UmFZWjc0dnJybHBYWXJpL01zaWxhUVRVaWg0L05CcnUvZUlLNnNueXNGVUNEejJtUHVHQlpYLzhGWDB4Ym5lRW9hcmtQZFUvRmcwMEJqb1VjaHl0NFhIZ3EzeTVxWHJzbktRQ2QwbGVycXJNUXpJUDBOV0lKMTduSittZ0FBTVlJQ1d6Q0NBbGNDQVFFd1dqQlZNUmd3RmdZRFZRUUREQTl6Wld4bUxYTnBaMjVsWkMxMGMyRXhHVEFYQmdOVkJBb01FRTV2ZDJsdVlTQlRiMngxZEdsdmJuTXhFVEFQQmdOVkJBc01DRkJMU1MxVVJWTlVNUXN3Q1FZRFZRUUdFd0pNVlFJQlpEQU5CZ2xnaGtnQlpRTUVBZ0VGQUtDQjB6QWFCZ2txaGtpRzl3MEJDUU14RFFZTEtvWklodmNOQVFrUUFRUXdIQVlKS29aSWh2Y05BUWtGTVE4WERURTRNVEV5TVRBNU5UVXdOVm93TFFZSktvWklodmNOQVFrME1TQXdIakFOQmdsZ2hrZ0JaUU1FQWdFRkFLRU5CZ2txaGtpRzl3MEJBUXNGQURBdkJna3Foa2lHOXcwQkNRUXhJZ1FnSHpQbXFrUVY0RHQ0eXg5N29wbFFTUVJTRlY5Ym9Tb1owZzJ1R3F0aE9VTXdOd1lMS29aSWh2Y05BUWtRQWk4eEtEQW1NQ1F3SWdRZ0M5SHk4MUhxZGlqN3dtRktJdTBSbmswRG5NOUE0Tk1ScWZRVEpNNmpUT1l3RFFZSktvWklodmNOQVFFTEJRQUVnZ0VBY2tYRGNJZmg0S3V3OU1DMU5nQ1MxQnk4RDVJUkd3N24ramdMV2lvUUxMV1RuYW5XaEdqYmVIeVBiTTlVeGtKbVJKMUtoMkRJdWhGTC9wSWxGZVlaYzdWMXRRaDlieEZEajVzSHFMUUhkR3VLTFhFZFpGbHRYOWp6c0FtSks0MWZzZWhHd2J3bSt2WE5CZ1M5T0pSMmlTTjRXUFQrY0hjemVnQnVEaHo4RlV1cXRyODJJaE80SG1qZWRyd3ZJTDY2eEg2TndHSmJwUXh0cGpraEszbW1naHd2aXJkZmhUdFhYNWJFTi9wV3Z4UDhwOGEvdzAvZGpJWVNKUXJmSFozUUlORTByU2gwZE9tWllFd3BrTms1N2VIb3Q3QmhvVFJGdEFZdi9jcUVWMkNWY3hkL0NSdHQ3QVc2bWxNcjV1ZnpzaldaUy9LQWh0UVdBZkVFWXNjVlNBQUFBQUFBQUE9PTwveGFkZXM6RW5jYXBzdWxhdGVkVGltZVN0YW1wPjwveGFkZXM6U2lnbmF0dXJlVGltZVN0YW1wPjwveGFkZXM6VW5zaWduZWRTaWduYXR1cmVQcm9wZXJ0aWVzPjwveGFkZXM6VW5zaWduZWRQcm9wZXJ0aWVzPjwveGFkZXM6UXVhbGlmeWluZ1Byb3BlcnRpZXM+PC9kczpPYmplY3Q+PC9kczpTaWduYXR1cmU+&quot;,
  &quot;digestAlgorithm&quot; : null,
  &quot;name&quot; : &quot;xades-detached-extended-xades-baseline-t.xml&quot;,
  &quot;mimeType&quot; : {
    &quot;mimeTypeString&quot; : &quot;text/xml&quot;
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_rest_server_signature_service"><a class="anchor" href="#_rest_server_signature_service"></a>REST server signature service</h3>
<div class="paragraph">
<p>This service also exposed 3 methods :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>getKeys : retrieves available keys on server side</p>
</li>
<li>
<p>getKey : retrieves a key on the server side by its alias</p>
</li>
<li>
<p>sign : signs the digest value with the given key</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_get_keys"><a class="anchor" href="#_get_keys"></a>Get keys</h4>
<div class="paragraph">
<p>This method allows to retrieve all available keys on the server side (PKCS#11, PKCS#12, HSM,&#8230;&#8203;). All keys will have an alias, a signing certificate and its chain. The alias will be used in following steps.</p>
</div>
<div class="listingblock">
<div class="title">Request</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="http">GET /services/rest/server-signing/keys HTTP/1.1
Accept: application/json, application/javascript, text/javascript, text/json
Host: localhost:8080</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Response</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="http">HTTP/1.1 200 OK
Date: Wed, 21 Nov 2018 09:55:06 GMT
Content-Type: application/json
Transfer-Encoding: chunked
Content-Length: 2189

[ {
  &quot;alias&quot; : &quot;certificate&quot;,
  &quot;encryptionAlgo&quot; : &quot;RSA&quot;,
  &quot;certificate&quot; : {
    &quot;encodedCertificate&quot; : &quot;MIIC6jCCAdKgAwIBAgIGLtYU17tXMA0GCSqGSIb3DQEBCwUAMDAxGzAZBgNVBAMMElJvb3RTZWxmU2lnbmVkRmFrZTERMA8GA1UECgwIRFNTLXRlc3QwHhcNMTcwNjA4MTEyNjAxWhcNNDcwNzA0MDc1NzI0WjAoMRMwEQYDVQQDDApTaWduZXJGYWtlMREwDwYDVQQKDAhEU1MtdGVzdDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMI3kZhtnipn+iiZHZ9ax8FlfE5Ow/cFwBTfAEb3R1ZQUp6/BQnBt7Oo0JWBtc9qkv7JUDdcBJXPV5QWS5AyMPHpqQ75Hitjsq/Fzu8eHtkKpFizcxGa9BZdkQjh4rSrtO1Kjs0Rd5DQtWSgkeVCCN09kN0ZsZ0ENY+Ip8QxSmyztsStkYXdULqpwz4JEXW9vz64eTbde4vQJ6pjHGarJf1gQNEc2XzhmI/prXLysWNqC7lZg7PUZUTrdegABTUzYCRJ1kWBRPm4qo0LN405c94QQd45a5kTgowHzEgLnAQI28x0M3A59TKC+ieNc6VF1PsTLpUw7PNI2VstX5jAuasCAwEAAaMSMBAwDgYDVR0PAQH/BAQDAgEGMA0GCSqGSIb3DQEBCwUAA4IBAQCK6LGA01TR+rmU8p6yhAi4OkDN2b1dbIL8l8iCMYopLCxx8xqq3ubZCOxqh1X2j6pgWzarb0b/MUix00IoUvNbFOxAW7PBZIKDLnm6LsckRxs1U32sC9d1LOHe3WKBNB6GZALT1ewjh7hSbWjftlmcovq+6eVGA5cvf2u/2+TkKkyHV/NR394nXrdsdpvygwypEtXjetzD7UT93Nuw3xcV8VIftIvHf9LjU7h+UjGmKXG9c15eYr3SzUmv6kyOI0Bvw14PWtsWGl0QdOSRvIBBrP4adCnGTgjgjk9LTcO8B8FKrr+8lHGuc0bp4lIUToiUkGILXsiEeEg9WAqm+XqO&quot;
  },
  &quot;certificateChain&quot; : [ {
    &quot;encodedCertificate&quot; : &quot;MIIC6jCCAdKgAwIBAgIGLtYU17tXMA0GCSqGSIb3DQEBCwUAMDAxGzAZBgNVBAMMElJvb3RTZWxmU2lnbmVkRmFrZTERMA8GA1UECgwIRFNTLXRlc3QwHhcNMTcwNjA4MTEyNjAxWhcNNDcwNzA0MDc1NzI0WjAoMRMwEQYDVQQDDApTaWduZXJGYWtlMREwDwYDVQQKDAhEU1MtdGVzdDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMI3kZhtnipn+iiZHZ9ax8FlfE5Ow/cFwBTfAEb3R1ZQUp6/BQnBt7Oo0JWBtc9qkv7JUDdcBJXPV5QWS5AyMPHpqQ75Hitjsq/Fzu8eHtkKpFizcxGa9BZdkQjh4rSrtO1Kjs0Rd5DQtWSgkeVCCN09kN0ZsZ0ENY+Ip8QxSmyztsStkYXdULqpwz4JEXW9vz64eTbde4vQJ6pjHGarJf1gQNEc2XzhmI/prXLysWNqC7lZg7PUZUTrdegABTUzYCRJ1kWBRPm4qo0LN405c94QQd45a5kTgowHzEgLnAQI28x0M3A59TKC+ieNc6VF1PsTLpUw7PNI2VstX5jAuasCAwEAAaMSMBAwDgYDVR0PAQH/BAQDAgEGMA0GCSqGSIb3DQEBCwUAA4IBAQCK6LGA01TR+rmU8p6yhAi4OkDN2b1dbIL8l8iCMYopLCxx8xqq3ubZCOxqh1X2j6pgWzarb0b/MUix00IoUvNbFOxAW7PBZIKDLnm6LsckRxs1U32sC9d1LOHe3WKBNB6GZALT1ewjh7hSbWjftlmcovq+6eVGA5cvf2u/2+TkKkyHV/NR394nXrdsdpvygwypEtXjetzD7UT93Nuw3xcV8VIftIvHf9LjU7h+UjGmKXG9c15eYr3SzUmv6kyOI0Bvw14PWtsWGl0QdOSRvIBBrP4adCnGTgjgjk9LTcO8B8FKrr+8lHGuc0bp4lIUToiUkGILXsiEeEg9WAqm+XqO&quot;
  } ]
} ]</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_get_key"><a class="anchor" href="#_get_key"></a>Get key</h4>
<div class="paragraph">
<p>This method allows to retrieve key informations for a given alias.</p>
</div>
<div class="listingblock">
<div class="title">Request</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="http">GET /services/rest/server-signing/key/certificate HTTP/1.1
Accept: application/json, application/javascript, text/javascript, text/json
Host: localhost:8080</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Response</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="http">HTTP/1.1 200 OK
Date: Wed, 21 Nov 2018 09:55:06 GMT
Content-Type: application/json
Transfer-Encoding: chunked
Content-Length: 2185

{
  &quot;alias&quot; : &quot;certificate&quot;,
  &quot;encryptionAlgo&quot; : &quot;RSA&quot;,
  &quot;certificate&quot; : {
    &quot;encodedCertificate&quot; : &quot;MIIC6jCCAdKgAwIBAgIGLtYU17tXMA0GCSqGSIb3DQEBCwUAMDAxGzAZBgNVBAMMElJvb3RTZWxmU2lnbmVkRmFrZTERMA8GA1UECgwIRFNTLXRlc3QwHhcNMTcwNjA4MTEyNjAxWhcNNDcwNzA0MDc1NzI0WjAoMRMwEQYDVQQDDApTaWduZXJGYWtlMREwDwYDVQQKDAhEU1MtdGVzdDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMI3kZhtnipn+iiZHZ9ax8FlfE5Ow/cFwBTfAEb3R1ZQUp6/BQnBt7Oo0JWBtc9qkv7JUDdcBJXPV5QWS5AyMPHpqQ75Hitjsq/Fzu8eHtkKpFizcxGa9BZdkQjh4rSrtO1Kjs0Rd5DQtWSgkeVCCN09kN0ZsZ0ENY+Ip8QxSmyztsStkYXdULqpwz4JEXW9vz64eTbde4vQJ6pjHGarJf1gQNEc2XzhmI/prXLysWNqC7lZg7PUZUTrdegABTUzYCRJ1kWBRPm4qo0LN405c94QQd45a5kTgowHzEgLnAQI28x0M3A59TKC+ieNc6VF1PsTLpUw7PNI2VstX5jAuasCAwEAAaMSMBAwDgYDVR0PAQH/BAQDAgEGMA0GCSqGSIb3DQEBCwUAA4IBAQCK6LGA01TR+rmU8p6yhAi4OkDN2b1dbIL8l8iCMYopLCxx8xqq3ubZCOxqh1X2j6pgWzarb0b/MUix00IoUvNbFOxAW7PBZIKDLnm6LsckRxs1U32sC9d1LOHe3WKBNB6GZALT1ewjh7hSbWjftlmcovq+6eVGA5cvf2u/2+TkKkyHV/NR394nXrdsdpvygwypEtXjetzD7UT93Nuw3xcV8VIftIvHf9LjU7h+UjGmKXG9c15eYr3SzUmv6kyOI0Bvw14PWtsWGl0QdOSRvIBBrP4adCnGTgjgjk9LTcO8B8FKrr+8lHGuc0bp4lIUToiUkGILXsiEeEg9WAqm+XqO&quot;
  },
  &quot;certificateChain&quot; : [ {
    &quot;encodedCertificate&quot; : &quot;MIIC6jCCAdKgAwIBAgIGLtYU17tXMA0GCSqGSIb3DQEBCwUAMDAxGzAZBgNVBAMMElJvb3RTZWxmU2lnbmVkRmFrZTERMA8GA1UECgwIRFNTLXRlc3QwHhcNMTcwNjA4MTEyNjAxWhcNNDcwNzA0MDc1NzI0WjAoMRMwEQYDVQQDDApTaWduZXJGYWtlMREwDwYDVQQKDAhEU1MtdGVzdDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMI3kZhtnipn+iiZHZ9ax8FlfE5Ow/cFwBTfAEb3R1ZQUp6/BQnBt7Oo0JWBtc9qkv7JUDdcBJXPV5QWS5AyMPHpqQ75Hitjsq/Fzu8eHtkKpFizcxGa9BZdkQjh4rSrtO1Kjs0Rd5DQtWSgkeVCCN09kN0ZsZ0ENY+Ip8QxSmyztsStkYXdULqpwz4JEXW9vz64eTbde4vQJ6pjHGarJf1gQNEc2XzhmI/prXLysWNqC7lZg7PUZUTrdegABTUzYCRJ1kWBRPm4qo0LN405c94QQd45a5kTgowHzEgLnAQI28x0M3A59TKC+ieNc6VF1PsTLpUw7PNI2VstX5jAuasCAwEAAaMSMBAwDgYDVR0PAQH/BAQDAgEGMA0GCSqGSIb3DQEBCwUAA4IBAQCK6LGA01TR+rmU8p6yhAi4OkDN2b1dbIL8l8iCMYopLCxx8xqq3ubZCOxqh1X2j6pgWzarb0b/MUix00IoUvNbFOxAW7PBZIKDLnm6LsckRxs1U32sC9d1LOHe3WKBNB6GZALT1ewjh7hSbWjftlmcovq+6eVGA5cvf2u/2+TkKkyHV/NR394nXrdsdpvygwypEtXjetzD7UT93Nuw3xcV8VIftIvHf9LjU7h+UjGmKXG9c15eYr3SzUmv6kyOI0Bvw14PWtsWGl0QdOSRvIBBrP4adCnGTgjgjk9LTcO8B8FKrr+8lHGuc0bp4lIUToiUkGILXsiEeEg9WAqm+XqO&quot;
  } ]
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sign"><a class="anchor" href="#_sign"></a>Sign</h4>
<div class="paragraph">
<p>This method allows to sign the given digest with a server side certificate.</p>
</div>
<div class="listingblock">
<div class="title">Request</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="http">POST /services/rest/server-signing/sign/certificate/SHA256 HTTP/1.1
Accept: application/json, application/javascript, text/javascript, text/json
Content-Type: application/json; charset=UTF-8
Host: localhost:8080
Content-Length: 24

{
  &quot;bytes&quot; : &quot;AQID&quot;
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Response</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="http">HTTP/1.1 200 OK
Date: Wed, 21 Nov 2018 09:55:06 GMT
Content-Type: application/json
Transfer-Encoding: chunked
Content-Length: 395

{
  &quot;algorithm&quot; : &quot;RSA_SHA256&quot;,
  &quot;value&quot; : &quot;AZgLVQQLPQkPgRlfTNfTg3QlcDa0JTb0lS6kSteHxHLvjTmtKnRfYTVPZ0bupdPMVQIfuBt4OQv2zVtTbor+kj1u7BaaeO50mXB8OMvo93F/ZmHPIff8VduPASOql7xc4TN73I6KoAn6ouYT0juxluQa9r79yvGo/qhoUwu9R/jGfOfGPKNHbGVDqnG1rHX0qEWPKIYxetiTLnaIZGxuZ9p2vDzZRoEaTs0UWcFu8Yln9Xk8fe6hSxAQOncBXwQX8LKAmZH4/QLsGuJwr+2FhsnC4slXi1TdXPzAlqLU38gmamK+QjqMTIPmQioLq2WLVhLye59dHvgvDChkTW3IZA==&quot;
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_rest_validation_service"><a class="anchor" href="#_rest_validation_service"></a>REST validation service</h3>
<div class="sect3">
<h4 id="_validate_a_document"><a class="anchor" href="#_validate_a_document"></a>Validate a document</h4>
<div class="paragraph">
<p>This service allows to validate signature (all formats/types) against a validation policy.</p>
</div>
<div class="listingblock">
<div class="title">Request</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="http">POST /services/rest/validation/validateSignature HTTP/1.1
Accept: application/json, application/javascript, text/javascript, text/json
Content-Type: application/json; charset=UTF-8
Host: localhost:8080
Content-Length: 7495

{
  &quot;signedDocument&quot; : {
    &quot;bytes&quot; : &quot;PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48ZHM6U2lnbmF0dXJlIHhtbG5zOmRzPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjIiBJZD0iaWQtYWZkZTc4MjQzNjQ2OGRkNzRlZWIxODFmN2NlMTEwZTEiPjxkczpTaWduZWRJbmZvPjxkczpDYW5vbmljYWxpemF0aW9uTWV0aG9kIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS8xMC94bWwtZXhjLWMxNG4jIi8+PGRzOlNpZ25hdHVyZU1ldGhvZCBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMDQveG1sZHNpZy1tb3JlI3JzYS1zaGEyNTYiLz48ZHM6UmVmZXJlbmNlIElkPSJyLWlkLTEiIFR5cGU9IiIgVVJJPSJzYW1wbGUueG1sIj48ZHM6RGlnZXN0TWV0aG9kIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS8wNC94bWxlbmMjc2hhMjU2Ii8+PGRzOkRpZ2VzdFZhbHVlPmtjREhPWmp3WmhWZnVEaHVoQ2VDRVJSbVlwVEg0Smo0Um1mVlZpMzFROWc9PC9kczpEaWdlc3RWYWx1ZT48L2RzOlJlZmVyZW5jZT48ZHM6UmVmZXJlbmNlIFR5cGU9Imh0dHA6Ly91cmkuZXRzaS5vcmcvMDE5MDMjU2lnbmVkUHJvcGVydGllcyIgVVJJPSIjeGFkZXMtaWQtYWZkZTc4MjQzNjQ2OGRkNzRlZWIxODFmN2NlMTEwZTEiPjxkczpUcmFuc2Zvcm1zPjxkczpUcmFuc2Zvcm0gQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzEwL3htbC1leGMtYzE0biMiLz48L2RzOlRyYW5zZm9ybXM+PGRzOkRpZ2VzdE1ldGhvZCBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMDQveG1sZW5jI3NoYTI1NiIvPjxkczpEaWdlc3RWYWx1ZT5EenR3TlRtUm9PQW02L2xNSThSeW01eFpQekl2TFlEem4vZWJZWWtQc3I0PTwvZHM6RGlnZXN0VmFsdWU+PC9kczpSZWZlcmVuY2U+PC9kczpTaWduZWRJbmZvPjxkczpTaWduYXR1cmVWYWx1ZSBJZD0idmFsdWUtaWQtYWZkZTc4MjQzNjQ2OGRkNzRlZWIxODFmN2NlMTEwZTEiPllBN3NFTnQzTjh1ZkxGTW5LcjM2cjBQcXpNaVkzUTBzKytJR1RFVUMwc3BheFV2MGRIWk0wZC95bjNrcExKTG9Va0k0TTNmbGo1V0duODNrZjA1QnFNMWtoc1g2MUdKemFGVFBHcG03YWtSUUtodm9IMjV5eXFUWVhFU2xCY20wNGl6aUtoTE16WmpVZng0L0IxWkl5c3Y1cElCZ0oycjJvaTZqTG9wOXd3M2dlNGM0WUpvYUsrU1hrNmh5VE5PY044UGpHZTYzV1lPVE5WUFFGdmphOEJud2crYTBiQnV3RCs4TjZmd2lnQ2RXNWEvNERKVWUvSjhNYjcwWkk4UG9Pem5HRGZpK1RQYmlJZVZtQ2JsNW1Vb1VnMlEveFlsdUpmTGgzdUdRQVhLQnZGNDVvRElIUlZlZm5OL0QvV3l0QUNsVVZEb1FTeXdlbW5qUHBxRjhlZz09PC9kczpTaWduYXR1cmVWYWx1ZT48ZHM6S2V5SW5mbz48ZHM6WDUwOURhdGE+PGRzOlg1MDlDZXJ0aWZpY2F0ZT5NSUlEMURDQ0FyeWdBd0lCQWdJQkNqQU5CZ2txaGtpRzl3MEJBUXNGQURCTk1SQXdEZ1lEVlFRRERBZG5iMjlrTFdOaE1Sa3dGd1lEVlFRS0RCQk9iM2RwYm1FZ1UyOXNkWFJwYjI1ek1SRXdEd1lEVlFRTERBaFFTMGt0VkVWVFZERUxNQWtHQTFVRUJoTUNURlV3SGhjTk1UWXhNREkyTURjMU5ETXhXaGNOTVRnd09ESTJNRGMxTkRNeFdqQlBNUkl3RUFZRFZRUUREQWxuYjI5a0xYVnpaWEl4R1RBWEJnTlZCQW9NRUU1dmQybHVZU0JUYjJ4MWRHbHZibk14RVRBUEJnTlZCQXNNQ0ZCTFNTMVVSVk5VTVFzd0NRWURWUVFHRXdKTVZUQ0NBU0l3RFFZSktvWklodmNOQVFFQkJRQURnZ0VQQURDQ0FRb0NnZ0VCQUxSQ1VJUVpidzNuU2RMcCtCOWN6RUNncFpra1E1eFY0ZzlNLzd3bGc5N29DQ2Y3VUVoOUJBMWQrellqc3p2K0JKMWJKWlBnYW4yMTQ0QXZnc29HSmZiNlVJeVZXNGdrbFVnSWwxYXJVdm9uK1drS25zZUZ1UU9mSnlqU0ZVREl3bnV2cDBoemNKWEhYUm1MZG15aCtuKzZOTUgwb201dFZvU2ZRcnRCVmlDTGVTTVZ6dUQ1RVBqMG1JUmN4OTFwTDM4ZTNGTlRXN05hR1pMZWV6dUZ1Ui9xN3o5M2xMa3ZaNFZBTU5HR0x2SVhPWWVSQlpNeVBocEJaNEwzQThJM0VFbEtXSC8xTHdpaVhUVFNHMXNNNld2TVRWYmYydmJkNDduWlJRQTJtU3BOR2pRb3VPQUVyZmVWVlVxeklDZ2hRQ0hSR09OdVNMRy9IZnFGSGI0aldnMENBd0VBQWFPQnZEQ0J1VEFPQmdOVkhROEJBZjhFQkFNQ0JrQXdnWWNHQ0NzR0FRVUZCd0VCQkhzd2VUQTVCZ2dyQmdFRkJRY3dBWVl0YUhSMGNEb3ZMMlJ6Y3k1dWIzZHBibUV1YkhVdmNHdHBMV1poWTNSdmNua3ZiMk56Y0M5bmIyOWtMV05oTUR3R0NDc0dBUVVGQnpBQ2hqQm9kSFJ3T2k4dlpITnpMbTV2ZDJsdVlTNXNkUzl3YTJrdFptRmpkRzl5ZVM5amNuUXZaMjl2WkMxallTNWpjblF3SFFZRFZSME9CQllFRk4ycEhELzdQZWZtQlQ4b1gyOVpoV3kvT0hKMU1BMEdDU3FHU0liM0RRRUJDd1VBQTRJQkFRQkszVk9MaERJVldLb0ZycmhoV3phZGR0azZYUXRjd1JvTlBWU3NpL2dPcnpzZE03MEEzMXhJVHc3WWZMaHBvVkExeG83b3ZIbGRwTGxocXk5bzV3aDI4MnlDcHFCVUF0Z3JTa0RHb2crSzdDTDZnVXBybFlpWnVHWnJ0ZzJYM2ZIUzJVc3g0WkozdElqNndWZWNERVVxSVNGZkZUMkVzbTBRWFVuZ0lLRk1sOTVYZ210dzJ3eFhiT3pVZURkNERJUHJ2K21XNXBvQVdyNkl0c1YrSDJWUStaTC9rQm53V0hqU1RPYUdGaXNxWFkvYUgvMVB0QlhBKzE1K1lJV2VtSkJTdjNrRGFGek9YQUV0UjlaSThsWU9KYXJuWTdBeS9hTjZiOXVHZmZyYm8vaFZBY0w0V0RkaGtiQk4zbTh3K2c3NkxvQVhOZUVldTA0QS8weExaelVCPC9kczpYNTA5Q2VydGlmaWNhdGU+PGRzOlg1MDlDZXJ0aWZpY2F0ZT5NSUlENmpDQ0F0S2dBd0lCQWdJQkJEQU5CZ2txaGtpRzl3MEJBUXNGQURCTk1SQXdEZ1lEVlFRRERBZHliMjkwTFdOaE1Sa3dGd1lEVlFRS0RCQk9iM2RwYm1FZ1UyOXNkWFJwYjI1ek1SRXdEd1lEVlFRTERBaFFTMGt0VkVWVFZERUxNQWtHQTFVRUJoTUNURlV3SGhjTk1UWXhNREkyTURjMU5ETXdXaGNOTVRnd09ESTJNRGMxTkRNd1dqQk5NUkF3RGdZRFZRUUREQWRuYjI5a0xXTmhNUmt3RndZRFZRUUtEQkJPYjNkcGJtRWdVMjlzZFhScGIyNXpNUkV3RHdZRFZRUUxEQWhRUzBrdFZFVlRWREVMTUFrR0ExVUVCaE1DVEZVd2dnRWlNQTBHQ1NxR1NJYjNEUUVCQVFVQUE0SUJEd0F3Z2dFS0FvSUJBUUNiYmw1c0tCQ2pTQjhUTWRhY3lteC9XZk9qTVcxZ2lJalZKUlkyOEpiTldrQ1ZtdHpnbWl0Z2hmclBRUGx1ZXUwRFRhbGJEa3JTU3loQ3Z6elBTR1B3Q0ZPYWhGL243aFFhMUYzVWFIU3hUS3JGQzVuT3dkTHp4S1JPM1dqVnRJR1JTWDJrdjFGZlVwUXk1RXl5K3JzZlN6SjU5ZFU1WlpkV3BkYUR1RHhWVnlEZXIzRUl5Q2JHNy81SDlNRDRZdXpOcGVURldtTTZjVVNUMDc5NlhEbGJFeFNUVEdRWEZKQTIrQ0NzeTlEWG5KYThuejBGRThmbWN2UUhlVTZrOVFicHpHak1kM0RXbEU2bm83VWRDWUQxSDA0K3VzQnA1aGhDckFCNjcwTmRvVHJOVG1HTkFGdDRKVDB2aXRqS0hxOUtFSWQ2TGhkY20yVGc5M2REY1dGdEFnTUJBQUdqZ2RRd2dkRXdEZ1lEVlIwUEFRSC9CQVFEQWdlQU1FRUdBMVVkSHdRNk1EZ3dOcUEwb0RLR01HaDBkSEE2THk5a2MzTXVibTkzYVc1aExteDFMM0JyYVMxbVlXTjBiM0o1TDJOeWJDOXliMjkwTFdOaExtTnliREJNQmdnckJnRUZCUWNCQVFSQU1ENHdQQVlJS3dZQkJRVUhNQUtHTUdoMGRIQTZMeTlrYzNNdWJtOTNhVzVoTG14MUwzQnJhUzFtWVdOMGIzSjVMMk55ZEM5eWIyOTBMV05oTG1OeWREQWRCZ05WSFE0RUZnUVUrMnRGcXBOZTNHMjNZUjh5cUJaSWlWV1MzdlV3RHdZRFZSMFRBUUgvQkFVd0F3RUIvekFOQmdrcWhraUc5dzBCQVFzRkFBT0NBUUVBRStOdWQwNVhHT002RkVaSFdUYzgrYm16LzZCMFhRWE41NjRLV0JCaGNoOWk1R2FkanFwU3NldmtuK3RlTHE1bTZDTG8zZTRsWDJkSjdoc1BBdnlhTHFPSXB6ZzQ5VEdkaWIxbk9CMk83NCt5QWhUOHY5Rlp0SDFFQ0hYeFlzdXlTR0lLdmQrTDVJakpUaXMzbGw0dlU4Rkh6eVJsTTlJUW53WlI1MDZqRmNKZUdsT2d5WmgrVUxXblJORUV3cU44RFRGMkQwWG9nWUJzckN4Q0JqMFBwYUpGcnV2RVFxcFV1dVlnMTRSMURKRmFoTHdxVllTT0Q1Z1BobUEwSFI0ejNHRjNqSFN6MGk5alhTVE9zVWNka3ZVSnkwdElPbnVqc1VFa2czSDZXZzNsejhUdzNJYzdWMU5IYitNQzVLNFp2WCs1U1l5dTArZXI3YkZzY0lyWVp3PT08L2RzOlg1MDlDZXJ0aWZpY2F0ZT48L2RzOlg1MDlEYXRhPjwvZHM6S2V5SW5mbz48ZHM6T2JqZWN0Pjx4YWRlczpRdWFsaWZ5aW5nUHJvcGVydGllcyB4bWxuczp4YWRlcz0iaHR0cDovL3VyaS5ldHNpLm9yZy8wMTkwMy92MS4zLjIjIiBUYXJnZXQ9IiNpZC1hZmRlNzgyNDM2NDY4ZGQ3NGVlYjE4MWY3Y2UxMTBlMSI+PHhhZGVzOlNpZ25lZFByb3BlcnRpZXMgSWQ9InhhZGVzLWlkLWFmZGU3ODI0MzY0NjhkZDc0ZWViMTgxZjdjZTExMGUxIj48eGFkZXM6U2lnbmVkU2lnbmF0dXJlUHJvcGVydGllcz48eGFkZXM6U2lnbmluZ1RpbWU+MjAxNy0wOS0yOFQxMTowOTowNFo8L3hhZGVzOlNpZ25pbmdUaW1lPjx4YWRlczpTaWduaW5nQ2VydGlmaWNhdGVWMj48eGFkZXM6Q2VydD48eGFkZXM6Q2VydERpZ2VzdD48ZHM6RGlnZXN0TWV0aG9kIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnI3NoYTEiLz48ZHM6RGlnZXN0VmFsdWU+YytWb2hnMGpJY1o0VVFTV2VnbENnMG9HTldzPTwvZHM6RGlnZXN0VmFsdWU+PC94YWRlczpDZXJ0RGlnZXN0Pjx4YWRlczpJc3N1ZXJTZXJpYWxWMj5NRll3VWFSUE1FMHhFREFPQmdOVkJBTU1CMmR2YjJRdFkyRXhHVEFYQmdOVkJBb01FRTV2ZDJsdVlTQlRiMngxZEdsdmJuTXhFVEFQQmdOVkJBc01DRkJMU1MxVVJWTlVNUXN3Q1FZRFZRUUdFd0pNVlFJQkNnPT08L3hhZGVzOklzc3VlclNlcmlhbFYyPjwveGFkZXM6Q2VydD48L3hhZGVzOlNpZ25pbmdDZXJ0aWZpY2F0ZVYyPjwveGFkZXM6U2lnbmVkU2lnbmF0dXJlUHJvcGVydGllcz48eGFkZXM6U2lnbmVkRGF0YU9iamVjdFByb3BlcnRpZXM+PHhhZGVzOkRhdGFPYmplY3RGb3JtYXQgT2JqZWN0UmVmZXJlbmNlPSIjci1pZC0xIj48eGFkZXM6TWltZVR5cGU+dGV4dC94bWw8L3hhZGVzOk1pbWVUeXBlPjwveGFkZXM6RGF0YU9iamVjdEZvcm1hdD48L3hhZGVzOlNpZ25lZERhdGFPYmplY3RQcm9wZXJ0aWVzPjwveGFkZXM6U2lnbmVkUHJvcGVydGllcz48L3hhZGVzOlF1YWxpZnlpbmdQcm9wZXJ0aWVzPjwvZHM6T2JqZWN0PjwvZHM6U2lnbmF0dXJlPg==&quot;,
    &quot;digestAlgorithm&quot; : null,
    &quot;name&quot; : &quot;xades-detached.xml&quot;,
    &quot;mimeType&quot; : {
      &quot;mimeTypeString&quot; : &quot;text/xml&quot;
    }
  },
  &quot;originalDocuments&quot; : [ {
    &quot;bytes&quot; : &quot;77u/PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxoOnRhYmxlIHhtbG5zOmg9Imh0dHA6Ly93d3cudzMub3JnL1RSL2h0bWw0LyI+DQoJPGg6dHI+DQoJCTxoOnRkPkhlbGxvPC9oOnRkPg0KCQk8aDp0ZD5Xb3JsZDwvaDp0ZD4NCgk8L2g6dHI+DQo8L2g6dGFibGU+&quot;,
    &quot;digestAlgorithm&quot; : null,
    &quot;name&quot; : &quot;sample.xml&quot;,
    &quot;mimeType&quot; : {
      &quot;mimeTypeString&quot; : &quot;text/xml&quot;
    }
  } ],
  &quot;policy&quot; : null,
  &quot;signatureId&quot; : null
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Response</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="http">HTTP/1.1 200 OK
Date: Wed, 21 Nov 2018 09:55:06 GMT
Content-Type: application/json
Transfer-Encoding: chunked
Content-Length: 31957

{
  &quot;diagnosticData&quot; : {
    &quot;documentName&quot; : &quot;xades-detached.xml&quot;,
    &quot;validationDate&quot; : 1542794106070,
    &quot;containerInfo&quot; : null,
    &quot;signatures&quot; : [ {
      &quot;signatureFilename&quot; : &quot;xades-detached.xml&quot;,
      &quot;parentId&quot; : null,
      &quot;errorMessage&quot; : null,
      &quot;dateTime&quot; : 1506596944000,
      &quot;signatureFormat&quot; : &quot;XAdES-BASELINE-B&quot;,
      &quot;structuralValidation&quot; : {
        &quot;valid&quot; : true,
        &quot;message&quot; : null
      },
      &quot;digestMatchers&quot; : [ {
        &quot;digestMethod&quot; : &quot;SHA256&quot;,
        &quot;digestValue&quot; : &quot;kcDHOZjwZhVfuDhuhCeCERRmYpTH4Jj4RmfVVi31Q9g=&quot;,
        &quot;dataFound&quot; : true,
        &quot;dataIntact&quot; : true,
        &quot;type&quot; : &quot;REFERENCE&quot;,
        &quot;name&quot; : &quot;r-id-1&quot;
      }, {
        &quot;digestMethod&quot; : &quot;SHA256&quot;,
        &quot;digestValue&quot; : &quot;DztwNTmRoOAm6/lMI8Rym5xZPzIvLYDzn/ebYYkPsr4=&quot;,
        &quot;dataFound&quot; : true,
        &quot;dataIntact&quot; : true,
        &quot;type&quot; : &quot;SIGNED_PROPERTIES&quot;,
        &quot;name&quot; : &quot;#xades-id-afde782436468dd74eeb181f7ce110e1&quot;
      } ],
      &quot;basicSignature&quot; : {
        &quot;encryptionAlgoUsedToSignThisToken&quot; : &quot;RSA&quot;,
        &quot;keyLengthUsedToSignThisToken&quot; : &quot;2048&quot;,
        &quot;digestAlgoUsedToSignThisToken&quot; : &quot;SHA256&quot;,
        &quot;maskGenerationFunctionUsedToSignThisToken&quot; : null,
        &quot;signatureIntact&quot; : true,
        &quot;signatureValid&quot; : true
      },
      &quot;signingCertificate&quot; : {
        &quot;attributePresent&quot; : true,
        &quot;digestValuePresent&quot; : true,
        &quot;digestValueMatch&quot; : true,
        &quot;issuerSerialMatch&quot; : true,
        &quot;id&quot; : &quot;F0FF0B4514D316304F2817DBA0BFB05DEDB98527C0E47C73E8D8FDFE16DF267E&quot;
      },
      &quot;certificateChain&quot; : [ {
        &quot;source&quot; : &quot;SIGNATURE&quot;,
        &quot;id&quot; : &quot;F0FF0B4514D316304F2817DBA0BFB05DEDB98527C0E47C73E8D8FDFE16DF267E&quot;
      }, {
        &quot;source&quot; : &quot;SIGNATURE&quot;,
        &quot;id&quot; : &quot;6F35DE3965B9A69BC3661D1A355B0AE60907ADB741CC1911EFD0F3BE72D6A6E9&quot;
      } ],
      &quot;contentType&quot; : &quot;text/xml&quot;,
      &quot;contentIdentifier&quot; : null,
      &quot;contentHints&quot; : null,
      &quot;signatureProductionPlace&quot; : null,
      &quot;commitmentTypeIndication&quot; : [ ],
      &quot;claimedRoles&quot; : [ ],
      &quot;certifiedRoles&quot; : [ ],
      &quot;policy&quot; : null,
      &quot;timestamps&quot; : [ ],
      &quot;signatureScopes&quot; : [ {
        &quot;value&quot; : &quot;Full document&quot;,
        &quot;name&quot; : &quot;sample.xml&quot;,
        &quot;scope&quot; : &quot;FULL&quot;
      } ],
      &quot;id&quot; : &quot;id-afde782436468dd74eeb181f7ce110e1&quot;,
      &quot;counterSignature&quot; : null
    } ],
    &quot;usedCertificates&quot; : [ {
      &quot;subjectDistinguishedName&quot; : [ {
        &quot;value&quot; : &quot;c=lu,ou=pki-test,o=nowina solutions,cn=good-ca&quot;,
        &quot;format&quot; : &quot;CANONICAL&quot;
      }, {
        &quot;value&quot; : &quot;C=LU,OU=PKI-TEST,O=Nowina Solutions,CN=good-ca&quot;,
        &quot;format&quot; : &quot;RFC2253&quot;
      } ],
      &quot;issuerDistinguishedName&quot; : [ {
        &quot;value&quot; : &quot;c=lu,ou=pki-test,o=nowina solutions,cn=root-ca&quot;,
        &quot;format&quot; : &quot;CANONICAL&quot;
      }, {
        &quot;value&quot; : &quot;C=LU,OU=PKI-TEST,O=Nowina Solutions,CN=root-ca&quot;,
        &quot;format&quot; : &quot;RFC2253&quot;
      } ],
      &quot;serialNumber&quot; : 4,
      &quot;commonName&quot; : &quot;good-ca&quot;,
      &quot;locality&quot; : null,
      &quot;state&quot; : null,
      &quot;countryName&quot; : &quot;LU&quot;,
      &quot;organizationName&quot; : &quot;Nowina Solutions&quot;,
      &quot;givenName&quot; : null,
      &quot;organizationalUnit&quot; : &quot;PKI-TEST&quot;,
      &quot;surname&quot; : null,
      &quot;pseudonym&quot; : null,
      &quot;email&quot; : null,
      &quot;authorityInformationAccessUrls&quot; : [ &quot;http://dss.nowina.lu/pki-factory/crt/root-ca.crt&quot; ],
      &quot;digestAlgoAndValues&quot; : [ ],
      &quot;notAfter&quot; : 1535270070000,
      &quot;notBefore&quot; : 1477468470000,
      &quot;publicKeySize&quot; : 2048,
      &quot;publicKeyEncryptionAlgo&quot; : &quot;RSA&quot;,
      &quot;keyUsageBits&quot; : [ &quot;digitalSignature&quot; ],
      &quot;extendedKeyUsages&quot; : [ ],
      &quot;idPkixOcspNoCheck&quot; : false,
      &quot;basicSignature&quot; : {
        &quot;encryptionAlgoUsedToSignThisToken&quot; : &quot;RSA&quot;,
        &quot;keyLengthUsedToSignThisToken&quot; : &quot;?&quot;,
        &quot;digestAlgoUsedToSignThisToken&quot; : &quot;SHA256&quot;,
        &quot;maskGenerationFunctionUsedToSignThisToken&quot; : null,
        &quot;signatureIntact&quot; : false,
        &quot;signatureValid&quot; : false
      },
      &quot;signingCertificate&quot; : null,
      &quot;certificateChain&quot; : [ ],
      &quot;trusted&quot; : false,
      &quot;selfSigned&quot; : false,
      &quot;certificatePolicies&quot; : [ ],
      &quot;trustedServiceProviders&quot; : [ ],
      &quot;revocations&quot; : [ ],
      &quot;base64Encoded&quot; : &quot;MIID6jCCAtKgAwIBAgIBBDANBgkqhkiG9w0BAQsFADBNMRAwDgYDVQQDDAdyb290LWNhMRkwFwYDVQQKDBBOb3dpbmEgU29sdXRpb25zMREwDwYDVQQLDAhQS0ktVEVTVDELMAkGA1UEBhMCTFUwHhcNMTYxMDI2MDc1NDMwWhcNMTgwODI2MDc1NDMwWjBNMRAwDgYDVQQDDAdnb29kLWNhMRkwFwYDVQQKDBBOb3dpbmEgU29sdXRpb25zMREwDwYDVQQLDAhQS0ktVEVTVDELMAkGA1UEBhMCTFUwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCbbl5sKBCjSB8TMdacymx/WfOjMW1giIjVJRY28JbNWkCVmtzgmitghfrPQPlueu0DTalbDkrSSyhCvzzPSGPwCFOahF/n7hQa1F3UaHSxTKrFC5nOwdLzxKRO3WjVtIGRSX2kv1FfUpQy5Eyy+rsfSzJ59dU5ZZdWpdaDuDxVVyDer3EIyCbG7/5H9MD4YuzNpeTFWmM6cUST0796XDlbExSTTGQXFJA2+CCsy9DXnJa8nz0FE8fmcvQHeU6k9QbpzGjMd3DWlE6no7UdCYD1H04+usBp5hhCrAB670NdoTrNTmGNAFt4JT0vitjKHq9KEId6Lhdcm2Tg93dDcWFtAgMBAAGjgdQwgdEwDgYDVR0PAQH/BAQDAgeAMEEGA1UdHwQ6MDgwNqA0oDKGMGh0dHA6Ly9kc3Mubm93aW5hLmx1L3BraS1mYWN0b3J5L2NybC9yb290LWNhLmNybDBMBggrBgEFBQcBAQRAMD4wPAYIKwYBBQUHMAKGMGh0dHA6Ly9kc3Mubm93aW5hLmx1L3BraS1mYWN0b3J5L2NydC9yb290LWNhLmNydDAdBgNVHQ4EFgQU+2tFqpNe3G23YR8yqBZIiVWS3vUwDwYDVR0TAQH/BAUwAwEB/zANBgkqhkiG9w0BAQsFAAOCAQEAE+Nud05XGOM6FEZHWTc8+bmz/6B0XQXN564KWBBhch9i5GadjqpSsevkn+teLq5m6CLo3e4lX2dJ7hsPAvyaLqOIpzg49TGdib1nOB2O74+yAhT8v9FZtH1ECHXxYsuySGIKvd+L5IjJTis3ll4vU8FHzyRlM9IQnwZR506jFcJeGlOgyZh+ULWnRNEEwqN8DTF2D0XogYBsrCxCBj0PpaJFruvEQqpUuuYg14R1DJFahLwqVYSOD5gPhmA0HR4z3GF3jHSz0i9jXSTOsUcdkvUJy0tIOnujsUEkg3H6Wg3lz8Tw3Ic7V1NHb+MC5K4ZvX+5SYyu0+er7bFscIrYZw==&quot;,
      &quot;id&quot; : &quot;6F35DE3965B9A69BC3661D1A355B0AE60907ADB741CC1911EFD0F3BE72D6A6E9&quot;,
      &quot;qctypes&quot; : [ ],
      &quot;ocspaccessUrls&quot; : [ ],
      &quot;crldistributionPoints&quot; : [ &quot;http://dss.nowina.lu/pki-factory/crl/root-ca.crl&quot; ],
      &quot;qcstatementIds&quot; : [ ]
    }, {
      &quot;subjectDistinguishedName&quot; : [ {
        &quot;value&quot; : &quot;c=lu,ou=pki-test,o=nowina solutions,cn=root-ca&quot;,
        &quot;format&quot; : &quot;CANONICAL&quot;
      }, {
        &quot;value&quot; : &quot;C=LU,OU=PKI-TEST,O=Nowina Solutions,CN=root-ca&quot;,
        &quot;format&quot; : &quot;RFC2253&quot;
      } ],
      &quot;issuerDistinguishedName&quot; : [ {
        &quot;value&quot; : &quot;c=lu,ou=pki-test,o=nowina solutions,cn=root-ca&quot;,
        &quot;format&quot; : &quot;CANONICAL&quot;
      }, {
        &quot;value&quot; : &quot;C=LU,OU=PKI-TEST,O=Nowina Solutions,CN=root-ca&quot;,
        &quot;format&quot; : &quot;RFC2253&quot;
      } ],
      &quot;serialNumber&quot; : 1,
      &quot;commonName&quot; : &quot;root-ca&quot;,
      &quot;locality&quot; : null,
      &quot;state&quot; : null,
      &quot;countryName&quot; : &quot;LU&quot;,
      &quot;organizationName&quot; : &quot;Nowina Solutions&quot;,
      &quot;givenName&quot; : null,
      &quot;organizationalUnit&quot; : &quot;PKI-TEST&quot;,
      &quot;surname&quot; : null,
      &quot;pseudonym&quot; : null,
      &quot;email&quot; : null,
      &quot;authorityInformationAccessUrls&quot; : [ ],
      &quot;digestAlgoAndValues&quot; : [ ],
      &quot;notAfter&quot; : 1571924603000,
      &quot;notBefore&quot; : 1508852603000,
      &quot;publicKeySize&quot; : 2048,
      &quot;publicKeyEncryptionAlgo&quot; : &quot;RSA&quot;,
      &quot;keyUsageBits&quot; : [ &quot;keyCertSign&quot;, &quot;crlSign&quot; ],
      &quot;extendedKeyUsages&quot; : [ ],
      &quot;idPkixOcspNoCheck&quot; : false,
      &quot;basicSignature&quot; : {
        &quot;encryptionAlgoUsedToSignThisToken&quot; : &quot;RSA&quot;,
        &quot;keyLengthUsedToSignThisToken&quot; : &quot;2048&quot;,
        &quot;digestAlgoUsedToSignThisToken&quot; : &quot;SHA512&quot;,
        &quot;maskGenerationFunctionUsedToSignThisToken&quot; : null,
        &quot;signatureIntact&quot; : true,
        &quot;signatureValid&quot; : true
      },
      &quot;signingCertificate&quot; : null,
      &quot;certificateChain&quot; : [ ],
      &quot;trusted&quot; : false,
      &quot;selfSigned&quot; : true,
      &quot;certificatePolicies&quot; : [ ],
      &quot;trustedServiceProviders&quot; : [ ],
      &quot;revocations&quot; : [ ],
      &quot;base64Encoded&quot; : &quot;MIIDVzCCAj+gAwIBAgIBATANBgkqhkiG9w0BAQ0FADBNMRAwDgYDVQQDDAdyb290LWNhMRkwFwYDVQQKDBBOb3dpbmEgU29sdXRpb25zMREwDwYDVQQLDAhQS0ktVEVTVDELMAkGA1UEBhMCTFUwHhcNMTcxMDI0MTM0MzIzWhcNMTkxMDI0MTM0MzIzWjBNMRAwDgYDVQQDDAdyb290LWNhMRkwFwYDVQQKDBBOb3dpbmEgU29sdXRpb25zMREwDwYDVQQLDAhQS0ktVEVTVDELMAkGA1UEBhMCTFUwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCcPx2j0OcAL0qmQ99apDybqwXCMvzwTDzNU7RkDYvGRQVTaqthrp7abnJnOzgjeCsu4N/9GgwXn8ICQTYEq00QVD6fabZT4ophtPbuIPF0CCL8FIXkpK2p6qpBNeHNxvgpQegMXMNUVqcYyp1v39/zyYI+iimBLhSTzO9QP54i32Katfn7ophaaYnsc02TJ0s9aBGRxekzyliUimWekr/KSY9fIHLEU09lgmdYhk1P+OAcuGQHrNYnOE2Jyl9NLN+3gtBuzTSxwJEvQIvTGAWIz+qCnCugMH6eHOs3CkbWlRSEy1qIgidqsNYm0yP6BO2hJdim9r0A3z8O9HSe4KFlAgMBAAGjQjBAMA4GA1UdDwEB/wQEAwIBBjAdBgNVHQ4EFgQUw91nslwAwQ7I31tDQp2YOrBeFxowDwYDVR0TAQH/BAUwAwEB/zANBgkqhkiG9w0BAQ0FAAOCAQEAO4PsY/jm4VkJKDA19mlpy2/qRaAj5n3MlgX2/8UaVRm4+5HUZ1zOrXM9Dl4gofS1eYvAD2HeBnHrY+6mfwBcH+NF54YDRjRibXp48FOn91HjnkMNjYB5o16tl8y0frI+eWJbq+GgLLvlruWShXCSQuWgDbY5jXcHV+TQskSQOcOy1hh82jdH2ysEtd4KcO/E2OGDUy+M7ZffBnLxPjxZRm198eyeC/gcVjBZoqHykwkivkYazbWhWvMkV95htR6x7dL2fp2sr9s12Gbq8Y9PfpXfXJ06qCQtojJiml4rF3YWWPVOUK6Gy1DFAvlU2iOASiV4sVwLkp1WAIFwKSChHQ==&quot;,
      &quot;id&quot; : &quot;9B3449709FC4B27B39B4BB289BF5C368A4FEA913A901E183163B3D8E32462E02&quot;,
      &quot;qctypes&quot; : [ ],
      &quot;ocspaccessUrls&quot; : [ ],
      &quot;crldistributionPoints&quot; : [ ],
      &quot;qcstatementIds&quot; : [ ]
    }, {
      &quot;subjectDistinguishedName&quot; : [ {
        &quot;value&quot; : &quot;c=lu,ou=pki-test,o=nowina solutions,cn=good-user&quot;,
        &quot;format&quot; : &quot;CANONICAL&quot;
      }, {
        &quot;value&quot; : &quot;C=LU,OU=PKI-TEST,O=Nowina Solutions,CN=good-user&quot;,
        &quot;format&quot; : &quot;RFC2253&quot;
      } ],
      &quot;issuerDistinguishedName&quot; : [ {
        &quot;value&quot; : &quot;c=lu,ou=pki-test,o=nowina solutions,cn=good-ca&quot;,
        &quot;format&quot; : &quot;CANONICAL&quot;
      }, {
        &quot;value&quot; : &quot;C=LU,OU=PKI-TEST,O=Nowina Solutions,CN=good-ca&quot;,
        &quot;format&quot; : &quot;RFC2253&quot;
      } ],
      &quot;serialNumber&quot; : 10,
      &quot;commonName&quot; : &quot;good-user&quot;,
      &quot;locality&quot; : null,
      &quot;state&quot; : null,
      &quot;countryName&quot; : &quot;LU&quot;,
      &quot;organizationName&quot; : &quot;Nowina Solutions&quot;,
      &quot;givenName&quot; : null,
      &quot;organizationalUnit&quot; : &quot;PKI-TEST&quot;,
      &quot;surname&quot; : null,
      &quot;pseudonym&quot; : null,
      &quot;email&quot; : null,
      &quot;authorityInformationAccessUrls&quot; : [ &quot;http://dss.nowina.lu/pki-factory/crt/good-ca.crt&quot; ],
      &quot;digestAlgoAndValues&quot; : [ ],
      &quot;notAfter&quot; : 1535270071000,
      &quot;notBefore&quot; : 1477468471000,
      &quot;publicKeySize&quot; : 2048,
      &quot;publicKeyEncryptionAlgo&quot; : &quot;RSA&quot;,
      &quot;keyUsageBits&quot; : [ &quot;nonRepudiation&quot; ],
      &quot;extendedKeyUsages&quot; : [ ],
      &quot;idPkixOcspNoCheck&quot; : false,
      &quot;basicSignature&quot; : {
        &quot;encryptionAlgoUsedToSignThisToken&quot; : &quot;RSA&quot;,
        &quot;keyLengthUsedToSignThisToken&quot; : &quot;2048&quot;,
        &quot;digestAlgoUsedToSignThisToken&quot; : &quot;SHA256&quot;,
        &quot;maskGenerationFunctionUsedToSignThisToken&quot; : null,
        &quot;signatureIntact&quot; : true,
        &quot;signatureValid&quot; : true
      },
      &quot;signingCertificate&quot; : {
        &quot;attributePresent&quot; : null,
        &quot;digestValuePresent&quot; : null,
        &quot;digestValueMatch&quot; : null,
        &quot;issuerSerialMatch&quot; : null,
        &quot;id&quot; : &quot;6F35DE3965B9A69BC3661D1A355B0AE60907ADB741CC1911EFD0F3BE72D6A6E9&quot;
      },
      &quot;certificateChain&quot; : [ {
        &quot;source&quot; : &quot;SIGNATURE&quot;,
        &quot;id&quot; : &quot;6F35DE3965B9A69BC3661D1A355B0AE60907ADB741CC1911EFD0F3BE72D6A6E9&quot;
      } ],
      &quot;trusted&quot; : false,
      &quot;selfSigned&quot; : false,
      &quot;certificatePolicies&quot; : [ ],
      &quot;trustedServiceProviders&quot; : [ ],
      &quot;revocations&quot; : [ ],
      &quot;base64Encoded&quot; : &quot;MIID1DCCArygAwIBAgIBCjANBgkqhkiG9w0BAQsFADBNMRAwDgYDVQQDDAdnb29kLWNhMRkwFwYDVQQKDBBOb3dpbmEgU29sdXRpb25zMREwDwYDVQQLDAhQS0ktVEVTVDELMAkGA1UEBhMCTFUwHhcNMTYxMDI2MDc1NDMxWhcNMTgwODI2MDc1NDMxWjBPMRIwEAYDVQQDDAlnb29kLXVzZXIxGTAXBgNVBAoMEE5vd2luYSBTb2x1dGlvbnMxETAPBgNVBAsMCFBLSS1URVNUMQswCQYDVQQGEwJMVTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBALRCUIQZbw3nSdLp+B9czECgpZkkQ5xV4g9M/7wlg97oCCf7UEh9BA1d+zYjszv+BJ1bJZPgan2144AvgsoGJfb6UIyVW4gklUgIl1arUvon+WkKnseFuQOfJyjSFUDIwnuvp0hzcJXHXRmLdmyh+n+6NMH0om5tVoSfQrtBViCLeSMVzuD5EPj0mIRcx91pL38e3FNTW7NaGZLeezuFuR/q7z93lLkvZ4VAMNGGLvIXOYeRBZMyPhpBZ4L3A8I3EElKWH/1LwiiXTTSG1sM6WvMTVbf2vbd47nZRQA2mSpNGjQouOAErfeVVUqzICghQCHRGONuSLG/HfqFHb4jWg0CAwEAAaOBvDCBuTAOBgNVHQ8BAf8EBAMCBkAwgYcGCCsGAQUFBwEBBHsweTA5BggrBgEFBQcwAYYtaHR0cDovL2Rzcy5ub3dpbmEubHUvcGtpLWZhY3Rvcnkvb2NzcC9nb29kLWNhMDwGCCsGAQUFBzAChjBodHRwOi8vZHNzLm5vd2luYS5sdS9wa2ktZmFjdG9yeS9jcnQvZ29vZC1jYS5jcnQwHQYDVR0OBBYEFN2pHD/7PefmBT8oX29ZhWy/OHJ1MA0GCSqGSIb3DQEBCwUAA4IBAQBK3VOLhDIVWKoFrrhhWzaddtk6XQtcwRoNPVSsi/gOrzsdM70A31xITw7YfLhpoVA1xo7ovHldpLlhqy9o5wh282yCpqBUAtgrSkDGog+K7CL6gUprlYiZuGZrtg2X3fHS2Usx4ZJ3tIj6wVecDEUqISFfFT2Esm0QXUngIKFMl95Xgmtw2wxXbOzUeDd4DIPrv+mW5poAWr6ItsV+H2VQ+ZL/kBnwWHjSTOaGFisqXY/aH/1PtBXA+15+YIWemJBSv3kDaFzOXAEtR9ZI8lYOJarnY7Ay/aN6b9uGffrbo/hVAcL4WDdhkbBN3m8w+g76LoAXNeEeu04A/0xLZzUB&quot;,
      &quot;id&quot; : &quot;F0FF0B4514D316304F2817DBA0BFB05DEDB98527C0E47C73E8D8FDFE16DF267E&quot;,
      &quot;qctypes&quot; : [ ],
      &quot;ocspaccessUrls&quot; : [ &quot;http://dss.nowina.lu/pki-factory/ocsp/good-ca&quot; ],
      &quot;crldistributionPoints&quot; : [ ],
      &quot;qcstatementIds&quot; : [ ]
    }, {
      &quot;subjectDistinguishedName&quot; : [ {
        &quot;value&quot; : &quot;c=lu,ou=pki-test,o=nowina solutions,cn=good-ca&quot;,
        &quot;format&quot; : &quot;CANONICAL&quot;
      }, {
        &quot;value&quot; : &quot;C=LU,OU=PKI-TEST,O=Nowina Solutions,CN=good-ca&quot;,
        &quot;format&quot; : &quot;RFC2253&quot;
      } ],
      &quot;issuerDistinguishedName&quot; : [ {
        &quot;value&quot; : &quot;c=lu,ou=pki-test,o=nowina solutions,cn=root-ca&quot;,
        &quot;format&quot; : &quot;CANONICAL&quot;
      }, {
        &quot;value&quot; : &quot;C=LU,OU=PKI-TEST,O=Nowina Solutions,CN=root-ca&quot;,
        &quot;format&quot; : &quot;RFC2253&quot;
      } ],
      &quot;serialNumber&quot; : 4,
      &quot;commonName&quot; : &quot;good-ca&quot;,
      &quot;locality&quot; : null,
      &quot;state&quot; : null,
      &quot;countryName&quot; : &quot;LU&quot;,
      &quot;organizationName&quot; : &quot;Nowina Solutions&quot;,
      &quot;givenName&quot; : null,
      &quot;organizationalUnit&quot; : &quot;PKI-TEST&quot;,
      &quot;surname&quot; : null,
      &quot;pseudonym&quot; : null,
      &quot;email&quot; : null,
      &quot;authorityInformationAccessUrls&quot; : [ &quot;http://dss.nowina.lu/pki-factory/crt/root-ca.crt&quot; ],
      &quot;digestAlgoAndValues&quot; : [ ],
      &quot;notAfter&quot; : 1569332604000,
      &quot;notBefore&quot; : 1511534604000,
      &quot;publicKeySize&quot; : 2048,
      &quot;publicKeyEncryptionAlgo&quot; : &quot;RSA&quot;,
      &quot;keyUsageBits&quot; : [ &quot;digitalSignature&quot; ],
      &quot;extendedKeyUsages&quot; : [ ],
      &quot;idPkixOcspNoCheck&quot; : false,
      &quot;basicSignature&quot; : {
        &quot;encryptionAlgoUsedToSignThisToken&quot; : &quot;RSA&quot;,
        &quot;keyLengthUsedToSignThisToken&quot; : &quot;2048&quot;,
        &quot;digestAlgoUsedToSignThisToken&quot; : &quot;SHA256&quot;,
        &quot;maskGenerationFunctionUsedToSignThisToken&quot; : null,
        &quot;signatureIntact&quot; : true,
        &quot;signatureValid&quot; : true
      },
      &quot;signingCertificate&quot; : {
        &quot;attributePresent&quot; : null,
        &quot;digestValuePresent&quot; : null,
        &quot;digestValueMatch&quot; : null,
        &quot;issuerSerialMatch&quot; : null,
        &quot;id&quot; : &quot;9B3449709FC4B27B39B4BB289BF5C368A4FEA913A901E183163B3D8E32462E02&quot;
      },
      &quot;certificateChain&quot; : [ {
        &quot;source&quot; : &quot;AIA&quot;,
        &quot;id&quot; : &quot;9B3449709FC4B27B39B4BB289BF5C368A4FEA913A901E183163B3D8E32462E02&quot;
      } ],
      &quot;trusted&quot; : false,
      &quot;selfSigned&quot; : false,
      &quot;certificatePolicies&quot; : [ ],
      &quot;trustedServiceProviders&quot; : [ ],
      &quot;revocations&quot; : [ ],
      &quot;base64Encoded&quot; : &quot;MIID6jCCAtKgAwIBAgIBBDANBgkqhkiG9w0BAQsFADBNMRAwDgYDVQQDDAdyb290LWNhMRkwFwYDVQQKDBBOb3dpbmEgU29sdXRpb25zMREwDwYDVQQLDAhQS0ktVEVTVDELMAkGA1UEBhMCTFUwHhcNMTcxMTI0MTQ0MzI0WhcNMTkwOTI0MTM0MzI0WjBNMRAwDgYDVQQDDAdnb29kLWNhMRkwFwYDVQQKDBBOb3dpbmEgU29sdXRpb25zMREwDwYDVQQLDAhQS0ktVEVTVDELMAkGA1UEBhMCTFUwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDE0JtjEg9q26lR5tJnvPLkgtWaMrRkeDfABta1qI3XLC2+AwLketU1lPuwK5HopmHkSTpXFE/cWfGmbgsHSkYlfcsXD6CKtYtinjzeekMQE7xiPWM5b9QtyGoh6BZUyydw934LnNjJNHfMgQVtyVnQ8L6SwFhyT3BTWU9SzVCNSlyUSJCAEsNQrFP1mxiHsdXJlUUykqxhaLC0gGZhIyhTZB3qNaRSIcGr4IlXTCXUkB8oaWNqwe/sS1+JlkiGdGED3NR9Zh4SBAk65wfL1xjzN+JgDrTTbPoKJOlqeTrv3NMsW9rzG/Fx4AlJgA7Lo+ujrHwggyC9zg3pRRQaH+LpAgMBAAGjgdQwgdEwDgYDVR0PAQH/BAQDAgeAMEEGA1UdHwQ6MDgwNqA0oDKGMGh0dHA6Ly9kc3Mubm93aW5hLmx1L3BraS1mYWN0b3J5L2NybC9yb290LWNhLmNybDBMBggrBgEFBQcBAQRAMD4wPAYIKwYBBQUHMAKGMGh0dHA6Ly9kc3Mubm93aW5hLmx1L3BraS1mYWN0b3J5L2NydC9yb290LWNhLmNydDAdBgNVHQ4EFgQUYEoTfXrajcuuURqGnbZIZlxBRQ0wDwYDVR0TAQH/BAUwAwEB/zANBgkqhkiG9w0BAQsFAAOCAQEAMEZzOXyFl4FEUrOXIaI2ha74zIbGsmtKdk2p801cYh4vrsldN8hbXUu7sbWTJ9BP6HdFJ+89fP+OUbyHm1NwFYf+BN11+NFKQoDniheezha9ZO8m0aKSTQvt/J3SHr/Ui7F00cDZhPa4SNHWdtl2capxYUY0o7ww/WpI+z5bIUauwiimBEqK2Dr2jwxbztM0qlDjKgHpCtriW48e5NmT9IBnJhMqqlLJpt9/AwepRMakcz65/wu40YcPd42TINMWwcIAWAZLPxdemIuwMrCQnGKZSmi1GkCWuMOwFcHXk7Yb2xku6PQPvcLWqSRMjD0RzVy8G2kK52VMwwwjoDi+Gg==&quot;,
      &quot;id&quot; : &quot;AB3AE83863C1B024F54BFCCB363792CD9051E540853820756EA46D2A2E2B9E43&quot;,
      &quot;qctypes&quot; : [ ],
      &quot;ocspaccessUrls&quot; : [ ],
      &quot;crldistributionPoints&quot; : [ &quot;http://dss.nowina.lu/pki-factory/crl/root-ca.crl&quot; ],
      &quot;qcstatementIds&quot; : [ ]
    } ],
    &quot;trustedLists&quot; : [ ],
    &quot;listOfTrustedLists&quot; : null
  },
  &quot;simpleReport&quot; : {
    &quot;policy&quot; : {
      &quot;policyName&quot; : &quot;QES AdESQC TL based&quot;,
      &quot;policyDescription&quot; : &quot;Validate electronic signatures and indicates whether they are Advanced electronic Signatures (AdES), AdES supported by a Qualified Certificate (AdES/QC) or a\n\t\tQualified electronic Signature (QES). All certificates and their related chains supporting the signatures are validated against the EU Member State Trusted Lists (this includes\n\t\tsigner's certificate and certificates used to validate certificate validity status services - CRLs, OCSP, and time-stamps).\n\t&quot;
    },
    &quot;validationTime&quot; : 1542794106070,
    &quot;documentName&quot; : &quot;xades-detached.xml&quot;,
    &quot;validSignaturesCount&quot; : 0,
    &quot;signaturesCount&quot; : 1,
    &quot;containerType&quot; : null,
    &quot;signature&quot; : [ {
      &quot;filename&quot; : null,
      &quot;signingTime&quot; : 1506596944000,
      &quot;bestSignatureTime&quot; : 1542794106070,
      &quot;signedBy&quot; : &quot;good-user&quot;,
      &quot;certificateChain&quot; : {
        &quot;certificate&quot; : [ {
          &quot;id&quot; : &quot;F0FF0B4514D316304F2817DBA0BFB05DEDB98527C0E47C73E8D8FDFE16DF267E&quot;,
          &quot;qualifiedName&quot; : &quot;good-user&quot;
        }, {
          &quot;id&quot; : &quot;6F35DE3965B9A69BC3661D1A355B0AE60907ADB741CC1911EFD0F3BE72D6A6E9&quot;,
          &quot;qualifiedName&quot; : &quot;good-ca&quot;
        } ]
      },
      &quot;signatureLevel&quot; : {
        &quot;value&quot; : &quot;NA&quot;,
        &quot;description&quot; : &quot;Not applicable&quot;
      },
      &quot;indication&quot; : &quot;INDETERMINATE&quot;,
      &quot;subIndication&quot; : &quot;NO_CERTIFICATE_CHAIN_FOUND&quot;,
      &quot;errors&quot; : [ &quot;The certificate path is not trusted!&quot;, &quot;The result of the LTV validation process is not acceptable to continue the process!&quot; ],
      &quot;warnings&quot; : [ &quot;The signature/seal is an INDETERMINATE AdES!&quot; ],
      &quot;infos&quot; : [ ],
      &quot;signatureScope&quot; : [ {
        &quot;value&quot; : &quot;Full document&quot;,
        &quot;name&quot; : &quot;sample.xml&quot;,
        &quot;scope&quot; : &quot;FULL&quot;
      } ],
      &quot;id&quot; : &quot;id-afde782436468dd74eeb181f7ce110e1&quot;,
      &quot;counterSignature&quot; : null,
      &quot;parentId&quot; : null,
      &quot;signatureFormat&quot; : &quot;XAdES-BASELINE-B&quot;
    } ]
  },
  &quot;detailedReport&quot; : {
    &quot;signatures&quot; : [ {
      &quot;validationProcessBasicSignatures&quot; : {
        &quot;constraint&quot; : [ {
          &quot;name&quot; : {
            &quot;value&quot; : &quot;Is the result of the Basic Validation Process conclusive?&quot;,
            &quot;nameId&quot; : &quot;ADEST_ROBVPIIC&quot;
          },
          &quot;status&quot; : &quot;NOT_OK&quot;,
          &quot;error&quot; : {
            &quot;value&quot; : &quot;The result of the Basic validation process is not conclusive!&quot;,
            &quot;nameId&quot; : &quot;ADEST_ROBVPIIC_ANS&quot;
          },
          &quot;warning&quot; : null,
          &quot;info&quot; : null,
          &quot;additionalInfo&quot; : null,
          &quot;id&quot; : &quot;id-afde782436468dd74eeb181f7ce110e1&quot;
        } ],
        &quot;conclusion&quot; : {
          &quot;indication&quot; : &quot;INDETERMINATE&quot;,
          &quot;subIndication&quot; : &quot;NO_CERTIFICATE_CHAIN_FOUND&quot;,
          &quot;errors&quot; : [ {
            &quot;value&quot; : &quot;The certificate chain for signature is not trusted, there is no trusted anchor.&quot;,
            &quot;nameId&quot; : &quot;BBB_XCV_CCCBB_SIG_ANS&quot;
          } ],
          &quot;warnings&quot; : [ ],
          &quot;infos&quot; : [ ]
        },
        &quot;bestSignatureTime&quot; : 1542794106070
      },
      &quot;validationProcessTimestamps&quot; : [ ],
      &quot;validationProcessLongTermData&quot; : {
        &quot;constraint&quot; : [ {
          &quot;name&quot; : {
            &quot;value&quot; : &quot;Is the result of the Basic Validation Process acceptable?&quot;,
            &quot;nameId&quot; : &quot;LTV_ABSV&quot;
          },
          &quot;status&quot; : &quot;NOT_OK&quot;,
          &quot;error&quot; : {
            &quot;value&quot; : &quot;The result of the Basic validation process is not acceptable to continue the process!&quot;,
            &quot;nameId&quot; : &quot;LTV_ABSV_ANS&quot;
          },
          &quot;warning&quot; : null,
          &quot;info&quot; : null,
          &quot;additionalInfo&quot; : null,
          &quot;id&quot; : null
        } ],
        &quot;conclusion&quot; : {
          &quot;indication&quot; : &quot;INDETERMINATE&quot;,
          &quot;subIndication&quot; : &quot;NO_CERTIFICATE_CHAIN_FOUND&quot;,
          &quot;errors&quot; : [ {
            &quot;value&quot; : &quot;The certificate chain for signature is not trusted, there is no trusted anchor.&quot;,
            &quot;nameId&quot; : &quot;BBB_XCV_CCCBB_SIG_ANS&quot;
          } ],
          &quot;warnings&quot; : [ ],
          &quot;infos&quot; : [ ]
        },
        &quot;bestSignatureTime&quot; : 1542794106070
      },
      &quot;validationProcessArchivalData&quot; : {
        &quot;constraint&quot; : [ {
          &quot;name&quot; : {
            &quot;value&quot; : &quot;Is the result of the LTV validation process acceptable?&quot;,
            &quot;nameId&quot; : &quot;ARCH_LTVV&quot;
          },
          &quot;status&quot; : &quot;NOT_OK&quot;,
          &quot;error&quot; : {
            &quot;value&quot; : &quot;The result of the LTV validation process is not acceptable to continue the process!&quot;,
            &quot;nameId&quot; : &quot;ARCH_LTVV_ANS&quot;
          },
          &quot;warning&quot; : null,
          &quot;info&quot; : null,
          &quot;additionalInfo&quot; : null,
          &quot;id&quot; : null
        } ],
        &quot;conclusion&quot; : {
          &quot;indication&quot; : &quot;INDETERMINATE&quot;,
          &quot;subIndication&quot; : &quot;NO_CERTIFICATE_CHAIN_FOUND&quot;,
          &quot;errors&quot; : [ {
            &quot;value&quot; : &quot;The certificate chain for signature is not trusted, there is no trusted anchor.&quot;,
            &quot;nameId&quot; : &quot;BBB_XCV_CCCBB_SIG_ANS&quot;
          } ],
          &quot;warnings&quot; : [ ],
          &quot;infos&quot; : [ ]
        },
        &quot;bestSignatureTime&quot; : 1542794106070
      },
      &quot;validationSignatureQualification&quot; : {
        &quot;constraint&quot; : [ {
          &quot;name&quot; : {
            &quot;value&quot; : &quot;Is the signature/seal an acceptable AdES (ETSI EN 319 102-1) ?&quot;,
            &quot;nameId&quot; : &quot;QUAL_IS_ADES&quot;
          },
          &quot;status&quot; : &quot;WARNING&quot;,
          &quot;error&quot; : null,
          &quot;warning&quot; : {
            &quot;value&quot; : &quot;The signature/seal is an INDETERMINATE AdES!&quot;,
            &quot;nameId&quot; : &quot;QUAL_IS_ADES_IND&quot;
          },
          &quot;info&quot; : null,
          &quot;additionalInfo&quot; : null,
          &quot;id&quot; : null
        }, {
          &quot;name&quot; : {
            &quot;value&quot; : &quot;Is the certificate path trusted?&quot;,
            &quot;nameId&quot; : &quot;QUAL_TRUSTED_CERT_PATH&quot;
          },
          &quot;status&quot; : &quot;NOT_OK&quot;,
          &quot;error&quot; : {
            &quot;value&quot; : &quot;The certificate path is not trusted!&quot;,
            &quot;nameId&quot; : &quot;QUAL_TRUSTED_CERT_PATH_ANS&quot;
          },
          &quot;warning&quot; : null,
          &quot;info&quot; : null,
          &quot;additionalInfo&quot; : null,
          &quot;id&quot; : null
        } ],
        &quot;conclusion&quot; : {
          &quot;indication&quot; : &quot;FAILED&quot;,
          &quot;subIndication&quot; : null,
          &quot;errors&quot; : [ {
            &quot;value&quot; : &quot;The certificate path is not trusted!&quot;,
            &quot;nameId&quot; : &quot;QUAL_TRUSTED_CERT_PATH_ANS&quot;
          }, {
            &quot;value&quot; : &quot;The certificate path is not trusted!&quot;,
            &quot;nameId&quot; : &quot;QUAL_TRUSTED_CERT_PATH_ANS&quot;
          } ],
          &quot;warnings&quot; : [ {
            &quot;value&quot; : &quot;The signature/seal is an INDETERMINATE AdES!&quot;,
            &quot;nameId&quot; : &quot;QUAL_IS_ADES_IND&quot;
          } ],
          &quot;infos&quot; : [ ]
        },
        &quot;validationCertificateQualification&quot; : [ ],
        &quot;id&quot; : null,
        &quot;signatureQualification&quot; : &quot;NA&quot;
      },
      &quot;id&quot; : &quot;id-afde782436468dd74eeb181f7ce110e1&quot;,
      &quot;counterSignature&quot; : null
    } ],
    &quot;certificate&quot; : null,
    &quot;basicBuildingBlocks&quot; : [ {
      &quot;fc&quot; : {
        &quot;constraint&quot; : [ {
          &quot;name&quot; : {
            &quot;value&quot; : &quot;Is the expected format found?&quot;,
            &quot;nameId&quot; : &quot;BBB_FC_IEFF&quot;
          },
          &quot;status&quot; : &quot;OK&quot;,
          &quot;error&quot; : null,
          &quot;warning&quot; : null,
          &quot;info&quot; : null,
          &quot;additionalInfo&quot; : null,
          &quot;id&quot; : null
        } ],
        &quot;conclusion&quot; : {
          &quot;indication&quot; : &quot;PASSED&quot;,
          &quot;subIndication&quot; : null,
          &quot;errors&quot; : [ ],
          &quot;warnings&quot; : [ ],
          &quot;infos&quot; : [ ]
        }
      },
      &quot;isc&quot; : {
        &quot;constraint&quot; : [ {
          &quot;name&quot; : {
            &quot;value&quot; : &quot;Is there an identified candidate for the signing certificate?&quot;,
            &quot;nameId&quot; : &quot;BBB_ICS_ISCI&quot;
          },
          &quot;status&quot; : &quot;OK&quot;,
          &quot;error&quot; : null,
          &quot;warning&quot; : null,
          &quot;info&quot; : null,
          &quot;additionalInfo&quot; : null,
          &quot;id&quot; : null
        }, {
          &quot;name&quot; : {
            &quot;value&quot; : &quot;Is the signed attribute: 'signing-certificate' present?&quot;,
            &quot;nameId&quot; : &quot;BBB_ICS_ISASCP&quot;
          },
          &quot;status&quot; : &quot;OK&quot;,
          &quot;error&quot; : null,
          &quot;warning&quot; : null,
          &quot;info&quot; : null,
          &quot;additionalInfo&quot; : null,
          &quot;id&quot; : null
        }, {
          &quot;name&quot; : {
            &quot;value&quot; : &quot;Is the signed attribute: 'cert-digest' of the certificate present?&quot;,
            &quot;nameId&quot; : &quot;BBB_ICS_ISACDP&quot;
          },
          &quot;status&quot; : &quot;OK&quot;,
          &quot;error&quot; : null,
          &quot;warning&quot; : null,
          &quot;info&quot; : null,
          &quot;additionalInfo&quot; : null,
          &quot;id&quot; : null
        }, {
          &quot;name&quot; : {
            &quot;value&quot; : &quot;Is the certificate's digest value valid?&quot;,
            &quot;nameId&quot; : &quot;BBB_ICS_ICDVV&quot;
          },
          &quot;status&quot; : &quot;OK&quot;,
          &quot;error&quot; : null,
          &quot;warning&quot; : null,
          &quot;info&quot; : null,
          &quot;additionalInfo&quot; : null,
          &quot;id&quot; : null
        }, {
          &quot;name&quot; : {
            &quot;value&quot; : &quot;Are the issuer distinguished name and the serial number equal?&quot;,
            &quot;nameId&quot; : &quot;BBB_ICS_AIDNASNE&quot;
          },
          &quot;status&quot; : &quot;OK&quot;,
          &quot;error&quot; : null,
          &quot;warning&quot; : null,
          &quot;info&quot; : null,
          &quot;additionalInfo&quot; : null,
          &quot;id&quot; : null
        } ],
        &quot;conclusion&quot; : {
          &quot;indication&quot; : &quot;PASSED&quot;,
          &quot;subIndication&quot; : null,
          &quot;errors&quot; : [ ],
          &quot;warnings&quot; : [ ],
          &quot;infos&quot; : [ ]
        },
        &quot;certificateChain&quot; : {
          &quot;chainItem&quot; : [ {
            &quot;source&quot; : &quot;SIGNATURE&quot;,
            &quot;id&quot; : &quot;F0FF0B4514D316304F2817DBA0BFB05DEDB98527C0E47C73E8D8FDFE16DF267E&quot;
          }, {
            &quot;source&quot; : &quot;SIGNATURE&quot;,
            &quot;id&quot; : &quot;6F35DE3965B9A69BC3661D1A355B0AE60907ADB741CC1911EFD0F3BE72D6A6E9&quot;
          } ]
        }
      },
      &quot;vci&quot; : {
        &quot;constraint&quot; : [ {
          &quot;name&quot; : {
            &quot;value&quot; : &quot;Is the signature policy known?&quot;,
            &quot;nameId&quot; : &quot;BBB_VCI_ISPK&quot;
          },
          &quot;status&quot; : &quot;OK&quot;,
          &quot;error&quot; : null,
          &quot;warning&quot; : null,
          &quot;info&quot; : null,
          &quot;additionalInfo&quot; : null,
          &quot;id&quot; : null
        } ],
        &quot;conclusion&quot; : {
          &quot;indication&quot; : &quot;PASSED&quot;,
          &quot;subIndication&quot; : null,
          &quot;errors&quot; : [ ],
          &quot;warnings&quot; : [ ],
          &quot;infos&quot; : [ ]
        }
      },
      &quot;cv&quot; : {
        &quot;constraint&quot; : [ {
          &quot;name&quot; : {
            &quot;value&quot; : &quot;Is the reference data object found?&quot;,
            &quot;nameId&quot; : &quot;BBB_CV_IRDOF&quot;
          },
          &quot;status&quot; : &quot;OK&quot;,
          &quot;error&quot; : null,
          &quot;warning&quot; : null,
          &quot;info&quot; : null,
          &quot;additionalInfo&quot; : &quot;Reference : r-id-1&quot;,
          &quot;id&quot; : null
        }, {
          &quot;name&quot; : {
            &quot;value&quot; : &quot;Is the reference data object intact?&quot;,
            &quot;nameId&quot; : &quot;BBB_CV_IRDOI&quot;
          },
          &quot;status&quot; : &quot;OK&quot;,
          &quot;error&quot; : null,
          &quot;warning&quot; : null,
          &quot;info&quot; : null,
          &quot;additionalInfo&quot; : &quot;Reference : r-id-1&quot;,
          &quot;id&quot; : null
        }, {
          &quot;name&quot; : {
            &quot;value&quot; : &quot;Is the reference data object found?&quot;,
            &quot;nameId&quot; : &quot;BBB_CV_IRDOF&quot;
          },
          &quot;status&quot; : &quot;OK&quot;,
          &quot;error&quot; : null,
          &quot;warning&quot; : null,
          &quot;info&quot; : null,
          &quot;additionalInfo&quot; : &quot;Reference : #xades-id-afde782436468dd74eeb181f7ce110e1&quot;,
          &quot;id&quot; : null
        }, {
          &quot;name&quot; : {
            &quot;value&quot; : &quot;Is the reference data object intact?&quot;,
            &quot;nameId&quot; : &quot;BBB_CV_IRDOI&quot;
          },
          &quot;status&quot; : &quot;OK&quot;,
          &quot;error&quot; : null,
          &quot;warning&quot; : null,
          &quot;info&quot; : null,
          &quot;additionalInfo&quot; : &quot;Reference : #xades-id-afde782436468dd74eeb181f7ce110e1&quot;,
          &quot;id&quot; : null
        }, {
          &quot;name&quot; : {
            &quot;value&quot; : &quot;Is the signature intact?&quot;,
            &quot;nameId&quot; : &quot;BBB_CV_ISI&quot;
          },
          &quot;status&quot; : &quot;OK&quot;,
          &quot;error&quot; : null,
          &quot;warning&quot; : null,
          &quot;info&quot; : null,
          &quot;additionalInfo&quot; : null,
          &quot;id&quot; : null
        } ],
        &quot;conclusion&quot; : {
          &quot;indication&quot; : &quot;PASSED&quot;,
          &quot;subIndication&quot; : null,
          &quot;errors&quot; : [ ],
          &quot;warnings&quot; : [ ],
          &quot;infos&quot; : [ ]
        }
      },
      &quot;sav&quot; : {
        &quot;constraint&quot; : [ {
          &quot;name&quot; : {
            &quot;value&quot; : &quot;Is signed qualifying property: 'signing-time' present?&quot;,
            &quot;nameId&quot; : &quot;BBB_SAV_ISQPSTP&quot;
          },
          &quot;status&quot; : &quot;OK&quot;,
          &quot;error&quot; : null,
          &quot;warning&quot; : null,
          &quot;info&quot; : null,
          &quot;additionalInfo&quot; : null,
          &quot;id&quot; : null
        }, {
          &quot;name&quot; : {
            &quot;value&quot; : &quot;Are signature cryptographic constraints met?&quot;,
            &quot;nameId&quot; : &quot;ASCCM&quot;
          },
          &quot;status&quot; : &quot;OK&quot;,
          &quot;error&quot; : null,
          &quot;warning&quot; : null,
          &quot;info&quot; : null,
          &quot;additionalInfo&quot; : &quot;Validation time : 2018-11-21 09:55&quot;,
          &quot;id&quot; : null
        } ],
        &quot;conclusion&quot; : {
          &quot;indication&quot; : &quot;PASSED&quot;,
          &quot;subIndication&quot; : null,
          &quot;errors&quot; : [ ],
          &quot;warnings&quot; : [ ],
          &quot;infos&quot; : [ ]
        }
      },
      &quot;xcv&quot; : {
        &quot;constraint&quot; : [ {
          &quot;name&quot; : {
            &quot;value&quot; : &quot;Can the certificate chain be built till the trust anchor?&quot;,
            &quot;nameId&quot; : &quot;BBB_XCV_CCCBB&quot;
          },
          &quot;status&quot; : &quot;NOT_OK&quot;,
          &quot;error&quot; : {
            &quot;value&quot; : &quot;The certificate chain for signature is not trusted, there is no trusted anchor.&quot;,
            &quot;nameId&quot; : &quot;BBB_XCV_CCCBB_SIG_ANS&quot;
          },
          &quot;warning&quot; : null,
          &quot;info&quot; : null,
          &quot;additionalInfo&quot; : null,
          &quot;id&quot; : null
        } ],
        &quot;conclusion&quot; : {
          &quot;indication&quot; : &quot;INDETERMINATE&quot;,
          &quot;subIndication&quot; : &quot;NO_CERTIFICATE_CHAIN_FOUND&quot;,
          &quot;errors&quot; : [ {
            &quot;value&quot; : &quot;The certificate chain for signature is not trusted, there is no trusted anchor.&quot;,
            &quot;nameId&quot; : &quot;BBB_XCV_CCCBB_SIG_ANS&quot;
          } ],
          &quot;warnings&quot; : [ ],
          &quot;infos&quot; : [ ]
        },
        &quot;subXCV&quot; : [ ]
      },
      &quot;psv&quot; : null,
      &quot;pcv&quot; : null,
      &quot;vts&quot; : null,
      &quot;certificateChain&quot; : {
        &quot;chainItem&quot; : [ {
          &quot;source&quot; : &quot;SIGNATURE&quot;,
          &quot;id&quot; : &quot;F0FF0B4514D316304F2817DBA0BFB05DEDB98527C0E47C73E8D8FDFE16DF267E&quot;
        }, {
          &quot;source&quot; : &quot;SIGNATURE&quot;,
          &quot;id&quot; : &quot;6F35DE3965B9A69BC3661D1A355B0AE60907ADB741CC1911EFD0F3BE72D6A6E9&quot;
        } ]
      },
      &quot;conclusion&quot; : {
        &quot;indication&quot; : &quot;INDETERMINATE&quot;,
        &quot;subIndication&quot; : &quot;NO_CERTIFICATE_CHAIN_FOUND&quot;,
        &quot;errors&quot; : [ {
          &quot;value&quot; : &quot;The certificate chain for signature is not trusted, there is no trusted anchor.&quot;,
          &quot;nameId&quot; : &quot;BBB_XCV_CCCBB_SIG_ANS&quot;
        } ],
        &quot;warnings&quot; : [ ],
        &quot;infos&quot; : [ ]
      },
      &quot;id&quot; : &quot;id-afde782436468dd74eeb181f7ce110e1&quot;,
      &quot;type&quot; : &quot;SIGNATURE&quot;
    } ],
    &quot;tlanalysis&quot; : [ ]
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_retrieve_original_documents"><a class="anchor" href="#_retrieve_original_documents"></a>Retrieve original document(s)</h4>
<div class="paragraph">
<p>This service returns the signed data for a given signature.</p>
</div>
<div class="listingblock">
<div class="title">Request</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="http">POST /services/rest/validation/getOriginalDocuments HTTP/1.1
Accept: application/json, application/javascript, text/javascript, text/json
Content-Type: application/json; charset=UTF-8
Host: localhost:8080
Content-Length: 9012

{
  &quot;signedDocument&quot; : {
    &quot;bytes&quot; : &quot;PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48ZHM6U2lnbmF0dXJlIHhtbG5zOmRzPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjIiBJZD0iaWQtZWExMGEwNTE3Y2JjN2Y1NDllYTNlNjg1ODY3YWM5NWUiPjxkczpTaWduZWRJbmZvPjxkczpDYW5vbmljYWxpemF0aW9uTWV0aG9kIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvVFIvMjAwMS9SRUMteG1sLWMxNG4tMjAwMTAzMTUiLz48ZHM6U2lnbmF0dXJlTWV0aG9kIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS8wNC94bWxkc2lnLW1vcmUjcnNhLXNoYTI1NiIvPjxkczpSZWZlcmVuY2UgSWQ9InItaWQtMSIgVHlwZT0iaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnI09iamVjdCIgVVJJPSIjby1pZC0xIj48ZHM6VHJhbnNmb3Jtcz48ZHM6VHJhbnNmb3JtIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnI2Jhc2U2NCIvPjwvZHM6VHJhbnNmb3Jtcz48ZHM6RGlnZXN0TWV0aG9kIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS8wNC94bWxlbmMjc2hhMjU2Ii8+PGRzOkRpZ2VzdFZhbHVlPkxQSk51bCt3b3c0bTZEc3F4Ym5pbmhzV0hsd2ZwMEplY3dRellwT0xtQ1E9PC9kczpEaWdlc3RWYWx1ZT48L2RzOlJlZmVyZW5jZT48ZHM6UmVmZXJlbmNlIFR5cGU9Imh0dHA6Ly91cmkuZXRzaS5vcmcvMDE5MDMjU2lnbmVkUHJvcGVydGllcyIgVVJJPSIjeGFkZXMtaWQtZWExMGEwNTE3Y2JjN2Y1NDllYTNlNjg1ODY3YWM5NWUiPjxkczpUcmFuc2Zvcm1zPjxkczpUcmFuc2Zvcm0gQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy9UUi8yMDAxL1JFQy14bWwtYzE0bi0yMDAxMDMxNSIvPjwvZHM6VHJhbnNmb3Jtcz48ZHM6RGlnZXN0TWV0aG9kIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS8wNC94bWxlbmMjc2hhMjU2Ii8+PGRzOkRpZ2VzdFZhbHVlPnpUZlc5bjFUOWwwTHg2TlhGNUFUM1Btb3FLOWFHbUpIZlBDaXl0Z1JNeVU9PC9kczpEaWdlc3RWYWx1ZT48L2RzOlJlZmVyZW5jZT48L2RzOlNpZ25lZEluZm8+PGRzOlNpZ25hdHVyZVZhbHVlIElkPSJ2YWx1ZS1pZC1lYTEwYTA1MTdjYmM3ZjU0OWVhM2U2ODU4NjdhYzk1ZSI+Qy9FZnJvWmdGTkJvak40ZnpJd2UzVTRibDQ5S2xBbmhKSmI3elc0T2MxNWsweWpPSkZDcm9jY2JGV0U1eU52R3cyVHpxYVo0SVFYRjBKRllGM2IrNW5saG1EcTJacHBJYnNlOWY5M005cGU4cTVHaFBjWkRDV1FmNnp2TnNvUHRPYktzL04vWjlzODVVcmY3UGd1SWtVZlI3eUJUaW5waGhJNVpuRHZuSnZsQ1RNRE5tYm4yMlBYSlYyc1IxWFpsa1BLWUsvVGhyOFdnSlcrUU9VREdTeGVSTmgyUWJPTllhR1FsUVJ6Vkhqb0c3emppVHM3UkdrR1ZVNGh3Q0pieW9TZThkd20zbkUxenVuQmp2TkRWenVqZVFyZkhTSjNrQUsxbS9odkt4TnhlNXR4bkNmd0ZkNldDanpDWXBBaE9sSmI3MDJvV3RYam56azBHbkFZQndnPT08L2RzOlNpZ25hdHVyZVZhbHVlPjxkczpLZXlJbmZvPjxkczpYNTA5RGF0YT48ZHM6WDUwOUNlcnRpZmljYXRlPk1JSUQxRENDQXJ5Z0F3SUJBZ0lCQ2pBTkJna3Foa2lHOXcwQkFRc0ZBREJOTVJBd0RnWURWUVFEREFkbmIyOWtMV05oTVJrd0Z3WURWUVFLREJCT2IzZHBibUVnVTI5c2RYUnBiMjV6TVJFd0R3WURWUVFMREFoUVMwa3RWRVZUVkRFTE1Ba0dBMVVFQmhNQ1RGVXdIaGNOTVRjeE1ERTVNRGN5TXpFd1doY05NVGt3T0RFNU1EY3lNekV3V2pCUE1SSXdFQVlEVlFRRERBbG5iMjlrTFhWelpYSXhHVEFYQmdOVkJBb01FRTV2ZDJsdVlTQlRiMngxZEdsdmJuTXhFVEFQQmdOVkJBc01DRkJMU1MxVVJWTlVNUXN3Q1FZRFZRUUdFd0pNVlRDQ0FTSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnRVBBRENDQVFvQ2dnRUJBSi9SVHV5WVRvR0RpbUZGR21STDhsN3lyRDZ1WDh1bkYzZkFmMGVTclpSRGZpS1R3RjlPT3RVclc1OU5EMnNyQyt5aXBWSllHRlNBcTJxS0NuRlBMcXZOV0ZTbCtnZnJtWnNuN2tjUUJWdlFqQjljS1pHMmc0VW55VUxCa3JQMFIvcW1pTmRuM0kzNHE2a0lBV3hXUnprUC9CaFAxdWVVNjBnUnhlV01HUGEyeVZabnhKbDFUOEplSGkvSmpoN2tQSTgwR3V4UXJDQkg0eGJRWngvU1FpV2pJdDdwcm1WZ0crR0hoNHFpb0JGWWp2OGdQM2ZMdExrM3ZGRHptRWFPeHRMMWRHQXdwcG83R0x1VXRVNkp4QXYwZm52eTZVT055QW4rK3V0OHFrOFU4WlM0Sk9nRnpKdlZLT2N0UXBUVGptbitMbG9uMWlncmtiSEptN2lxYWJrQ0F3RUFBYU9CdkRDQnVUQU9CZ05WSFE4QkFmOEVCQU1DQmtBd2dZY0dDQ3NHQVFVRkJ3RUJCSHN3ZVRBNUJnZ3JCZ0VGQlFjd0FZWXRhSFIwY0RvdkwyUnpjeTV1YjNkcGJtRXViSFV2Y0d0cExXWmhZM1J2Y25rdmIyTnpjQzluYjI5a0xXTmhNRHdHQ0NzR0FRVUZCekFDaGpCb2RIUndPaTh2WkhOekxtNXZkMmx1WVM1c2RTOXdhMmt0Wm1GamRHOXllUzlqY25RdloyOXZaQzFqWVM1amNuUXdIUVlEVlIwT0JCWUVGTy9QL2lxRW92UW4zYXByN1VTT0tTUzdSTUU5TUEwR0NTcUdTSWIzRFFFQkN3VUFBNElCQVFBRTJMSjdKa1RlQ2lRT1plSTBTalcySnAwTFA2S1lpNWNOYzR6SW4wTlkwQ05UUkZzejdrRlc2QW9FVGhoSjkzMmd5NmxSK0ZMR3BwS1NRNVZtUDBLd2JZV3g2MGFUSFJTbmtramRvZnlrYStoNitSbk1mRnl3NG9pZGVxdTBFWHBMNFhtVFNQN3hPNi9PN2EzZk9kM01DUy9Udm4wQllmNVlTOFJuZXd4MHFBZk5hb3czYUhDMTEyQkFTMUFNZVVTc2x5QVBYMUNGZ2dtK25aUEgwcnVUL0NQVko5WlR6VFcyMlhLa1liaytHTVFEOGxRR1RwYTBzVnU1K2Z3Zm1JZ28xZ1NqY20raXhKN04raDVtVXFZcE1Ydkp1TnJLUWwvSjA3RURWWmlrRWVnL2NQTkV2TE1XOXU5ckxqdU1rZWphQytETFUxRkpCZEpvd3FJS2NBakE8L2RzOlg1MDlDZXJ0aWZpY2F0ZT48ZHM6WDUwOUNlcnRpZmljYXRlPk1JSUQ2akNDQXRLZ0F3SUJBZ0lCQkRBTkJna3Foa2lHOXcwQkFRc0ZBREJOTVJBd0RnWURWUVFEREFkeWIyOTBMV05oTVJrd0Z3WURWUVFLREJCT2IzZHBibUVnVTI5c2RYUnBiMjV6TVJFd0R3WURWUVFMREFoUVMwa3RWRVZUVkRFTE1Ba0dBMVVFQmhNQ1RGVXdIaGNOTVRjeE1ERTVNRGN5TWpVeFdoY05NVGt3T0RFNU1EY3lNalV4V2pCTk1SQXdEZ1lEVlFRRERBZG5iMjlrTFdOaE1Sa3dGd1lEVlFRS0RCQk9iM2RwYm1FZ1UyOXNkWFJwYjI1ek1SRXdEd1lEVlFRTERBaFFTMGt0VkVWVFZERUxNQWtHQTFVRUJoTUNURlV3Z2dFaU1BMEdDU3FHU0liM0RRRUJBUVVBQTRJQkR3QXdnZ0VLQW9JQkFRQ2U4bjJoTDJrKzRRcklXUDJ6UmxMQkhBK1RGRDVtZlFrNWlna3plRzI4UDZSSXAxZlQwMHdDQzk3MVRndktlZ0xyTmx5REducEFzQ2k1UDZndXd3dDk3NFhKSGJoTitZc0xJa2g3djRYbVVQSFpDcEpLS1hScCs1bThpS002cGJGSS8rOE9KQ0JYaDMxY3pHTFlnRUFnQ0ZkVTg5WXY5YTl2Z1FJVkQ3bko3aUFRV0xoSHJ6S1lwSkQ0OEt2WklHMVJDNDhZNjhtNjFDZEdzenRVTHVHV1I1OGo5Zm5qanVRSTRITWNmY1ljK1pWRWR1dUp0bWp1M3h4UkE1aGhIYkczaHN1NHpjSVJLd1pBT0hGcGJNVnZWVDVSZk9GTE9rNkt6WlR0NzFUSzVMbk5WN1lvSHc3OXJXU29yRkxrRzRMVUxTR2d5bHllTVVUdHd5R25GeVpuQWdNQkFBR2pnZFF3Z2RFd0RnWURWUjBQQVFIL0JBUURBZ2VBTUVFR0ExVWRId1E2TURnd05xQTBvREtHTUdoMGRIQTZMeTlrYzNNdWJtOTNhVzVoTG14MUwzQnJhUzFtWVdOMGIzSjVMMk55YkM5eWIyOTBMV05oTG1OeWJEQk1CZ2dyQmdFRkJRY0JBUVJBTUQ0d1BBWUlLd1lCQlFVSE1BS0dNR2gwZEhBNkx5OWtjM011Ym05M2FXNWhMbXgxTDNCcmFTMW1ZV04wYjNKNUwyTnlkQzl5YjI5MExXTmhMbU55ZERBZEJnTlZIUTRFRmdRVUhGUXMweWRjUDFSUHlvWXJ2bExHUjFaYksxZ3dEd1lEVlIwVEFRSC9CQVV3QXdFQi96QU5CZ2txaGtpRzl3MEJBUXNGQUFPQ0FRRUFIM0hkZkpQYkhPQ3BjRXBteHZaRi9VMjcreTB3VFd6aUo0a3Z1Rnp5YmNMcjJyRWt3UkpldDBPaEZBMlBTSXFZZXc5S1lpb3BEd0VsOGQxSXA4L3k5Tk1kYU9VWUVpK2RTZzkwMWNnVnhxRlFFRHJadUpWdEljQnh3MzBiNWFPMUE1V0FRRzhCMVhaNjI1K0NielRNQllOK0xoRHFZRWJhK1FXWmdBR3BzWDFOS281TmxtK0wySmlVdng5QjlXcU95YkxZSWxWbmxuSGk3bFRJNDBjMjNTM2hTYVp6Z3lBdUFWR2NTKzZFSldSc0dYNXJtaUE1MUNlTUhoMEtCdXRlL0FkczVOb0RteW93bHlhYU5vZHBTc2NiVWxIK0hneGlMVWRYN0tJNDlabWRGSWtzUDB2Q1VvWFliWFlTekdmYmt2VGZ5SjQ5NXJzcktkaTcreWg0NlE9PTwvZHM6WDUwOUNlcnRpZmljYXRlPjxkczpYNTA5Q2VydGlmaWNhdGU+TUlJRFZ6Q0NBaitnQXdJQkFnSUJBVEFOQmdrcWhraUc5dzBCQVEwRkFEQk5NUkF3RGdZRFZRUUREQWR5YjI5MExXTmhNUmt3RndZRFZRUUtEQkJPYjNkcGJtRWdVMjlzZFhScGIyNXpNUkV3RHdZRFZRUUxEQWhRUzBrdFZFVlRWREVMTUFrR0ExVUVCaE1DVEZVd0hoY05NVGN3T1RFNU1EY3lNalF4V2hjTk1Ua3dPVEU1TURjeU1qUXhXakJOTVJBd0RnWURWUVFEREFkeWIyOTBMV05oTVJrd0Z3WURWUVFLREJCT2IzZHBibUVnVTI5c2RYUnBiMjV6TVJFd0R3WURWUVFMREFoUVMwa3RWRVZUVkRFTE1Ba0dBMVVFQmhNQ1RGVXdnZ0VpTUEwR0NTcUdTSWIzRFFFQkFRVUFBNElCRHdBd2dnRUtBb0lCQVFEUmc0SDRvbEhveDFlNzljVUprSTV1SitETGtYVnl2ZkExNWlWZGVJY3ZhS0xrUmdoYWlheTRsbmRJWTVGRjR0TVkwRWI2aW45Z1B2VzlnZytPMy9BMHFUcHc0OXA5Z0FSdXE0SzJmNGFUZC8zUmdVem8wNHRXblJkbUg3Tm5Nc3ZKcmhHcGRvclpnejd5SmlHUVVWRjQ4bFkzT0VLd3dCWUQzOGJER01UZG9jdGdrY2F6bThFVGF6M0hwQm9yRi9GM09nZ3JPNUc0SldtNGFuTlBvYUdZMWZaR3ZJQ0RTNCtlejNlaElkNytobS80Sjkyc2hwUkRuMjl4djdra3g5VVBCQWVSYjZ3YzVhTkxmdGx2aEF4S0U2bk5Dbk0wYXBvQmRCRGVuY3IzZk9SWlU0cmxxd1NsNkg2T3pseHFDdW9QQkp5R2tra3hvRzRabHVmWGhQV2JBZ01CQUFHalFqQkFNQTRHQTFVZER3RUIvd1FFQXdJQkJqQWRCZ05WSFE0RUZnUVVZVVB6YmV6NXNiY0pIcys5OE1HU2haaEw3UEF3RHdZRFZSMFRBUUgvQkFVd0F3RUIvekFOQmdrcWhraUc5dzBCQVEwRkFBT0NBUUVBVG1QYVpTb0dMNFg5UTFmOXhOa0NCYjZUQjlTUmEwZVVCKy9wUUVReXR5Rys5c3lFRkY4aGVmVjB6bGdGOUZqM1VwbWwyM0h1dnZRQXk1YmE4dGxxWStMdE52THBRb1pHcXZEUDN0NkFlRDNONTQwNFNzd2FpT2tPL1gySmVZZzl3RDN4RU9nakNSTVdyTU1FSWhxb1pOZXFIN2dLS1pKL3RHT01vSExjSHFXYVZmbGpqVmNUNnA0enI4bzB0MXl5T3AzNlNqVS9LOHBNdFg0YU1PU05uUlpTdnl2a3F5Ly9pNHlFbmFRNnMvVks1eUgzYStXcENiTnpLQ0xmbTEzMS8rVUdZV1FOVGIzWURYUUtGWmkwcnZoOGtodFFDeVEzYXVzQUZMdWsyc0FmSUszVGtIZml1ZnFZSXZsbEMzclZZQUo2TU9lWWlXWGpTd1RrK25pVWFBPT08L2RzOlg1MDlDZXJ0aWZpY2F0ZT48L2RzOlg1MDlEYXRhPjwvZHM6S2V5SW5mbz48ZHM6T2JqZWN0Pjx4YWRlczpRdWFsaWZ5aW5nUHJvcGVydGllcyB4bWxuczp4YWRlcz0iaHR0cDovL3VyaS5ldHNpLm9yZy8wMTkwMy92MS4zLjIjIiBUYXJnZXQ9IiNpZC1lYTEwYTA1MTdjYmM3ZjU0OWVhM2U2ODU4NjdhYzk1ZSI+PHhhZGVzOlNpZ25lZFByb3BlcnRpZXMgSWQ9InhhZGVzLWlkLWVhMTBhMDUxN2NiYzdmNTQ5ZWEzZTY4NTg2N2FjOTVlIj48eGFkZXM6U2lnbmVkU2lnbmF0dXJlUHJvcGVydGllcz48eGFkZXM6U2lnbmluZ1RpbWU+MjAxOC0wOS0yN1QxMTo1ODo0M1o8L3hhZGVzOlNpZ25pbmdUaW1lPjx4YWRlczpTaWduaW5nQ2VydGlmaWNhdGVWMj48eGFkZXM6Q2VydD48eGFkZXM6Q2VydERpZ2VzdD48ZHM6RGlnZXN0TWV0aG9kIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnI3NoYTEiLz48ZHM6RGlnZXN0VmFsdWU+aE5yb1k4cjFDQjU5NmpHQlBnUmdaRnZSRGJjPTwvZHM6RGlnZXN0VmFsdWU+PC94YWRlczpDZXJ0RGlnZXN0Pjx4YWRlczpJc3N1ZXJTZXJpYWxWMj5NRll3VWFSUE1FMHhFREFPQmdOVkJBTU1CMmR2YjJRdFkyRXhHVEFYQmdOVkJBb01FRTV2ZDJsdVlTQlRiMngxZEdsdmJuTXhFVEFQQmdOVkJBc01DRkJMU1MxVVJWTlVNUXN3Q1FZRFZRUUdFd0pNVlFJQkNnPT08L3hhZGVzOklzc3VlclNlcmlhbFYyPjwveGFkZXM6Q2VydD48L3hhZGVzOlNpZ25pbmdDZXJ0aWZpY2F0ZVYyPjwveGFkZXM6U2lnbmVkU2lnbmF0dXJlUHJvcGVydGllcz48eGFkZXM6U2lnbmVkRGF0YU9iamVjdFByb3BlcnRpZXM+PHhhZGVzOkRhdGFPYmplY3RGb3JtYXQgT2JqZWN0UmVmZXJlbmNlPSIjci1pZC0xIj48eGFkZXM6TWltZVR5cGU+dGV4dC9wbGFpbjwveGFkZXM6TWltZVR5cGU+PC94YWRlczpEYXRhT2JqZWN0Rm9ybWF0PjwveGFkZXM6U2lnbmVkRGF0YU9iamVjdFByb3BlcnRpZXM+PC94YWRlczpTaWduZWRQcm9wZXJ0aWVzPjwveGFkZXM6UXVhbGlmeWluZ1Byb3BlcnRpZXM+PC9kczpPYmplY3Q+PGRzOk9iamVjdCBJZD0iby1pZC0xIj5hR1ZzYkc4PTwvZHM6T2JqZWN0PjwvZHM6U2lnbmF0dXJlPg==&quot;,
    &quot;digestAlgorithm&quot; : null,
    &quot;name&quot; : &quot;hello-signed-xades.xml&quot;,
    &quot;mimeType&quot; : {
      &quot;mimeTypeString&quot; : &quot;text/xml&quot;
    }
  },
  &quot;originalDocuments&quot; : null,
  &quot;policy&quot; : null,
  &quot;signatureId&quot; : &quot;id-ea10a0517cbc7f549ea3e685867ac95e&quot;
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Response</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="http">HTTP/1.1 200 OK
Date: Wed, 21 Nov 2018 09:55:06 GMT
Content-Type: application/json
Transfer-Encoding: chunked
Content-Length: 101

[ {
  &quot;bytes&quot; : &quot;aGVsbG8=&quot;,
  &quot;digestAlgorithm&quot; : null,
  &quot;name&quot; : null,
  &quot;mimeType&quot; : null
} ]</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2018-12-17 10:32:47 CET
</div>
</div>
</body>
</html>